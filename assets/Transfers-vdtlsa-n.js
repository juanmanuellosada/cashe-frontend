import{g as D,r as a,Z as T,n as j,j as o,E as A,U as k,_ as h,$ as C}from"./index-D9qufTSl.js";import{M as I}from"./MovementsList-VhJ3tYap.js";import{P as N}from"./PullToRefresh-CnRhSKvA.js";import"./DateRangePicker-Ccj3mfCC.js";import"./subMonths-HUaFNWsq.js";import"./SortDropdown-BUbC5gkP.js";function U(){const{showError:i}=D(),[v,l]=a.useState([]),[f,x]=a.useState([]),[u,d]=a.useState(!0),[m,n]=a.useState(null),[M,g]=a.useState(!1),[y,p]=a.useState(!1),r=a.useCallback(async(s=!1,e=!0)=>{try{e&&d(!0);const[t,c]=await Promise.all([T(s),j()]);l(t.transfers||[]),x(c.accounts||[])}catch(t){console.error("Error fetching data:",t)}finally{e&&d(!1)}},[]);a.useEffect(()=>{r()},[r]);const E=async s=>{try{g(!0),await C(s),n(null),await r(!0,!1)}catch(e){console.error("Error updating:",e),i("No se pudo guardar la transferencia",e.message)}finally{g(!1)}},w=async s=>{n(null),l(e=>e.filter(t=>t.rowIndex!==s.rowIndex));try{await h(s)}catch(e){console.error("Error deleting:",e),i("No se pudo eliminar la transferencia",e.message),r()}},S=async s=>{const e=new Set(s.map(t=>t.rowIndex));l(t=>t.filter(c=>!e.has(c.rowIndex)));for(const t of s)await h(t);await r()};return o.jsxs(N,{onRefresh:r,disabled:u,children:[o.jsx(I,{title:"Transferencias",movements:v,accounts:f,categories:[],loading:u,onMovementClick:n,onMovementDelete:w,onBulkDelete:S,onAddClick:()=>p(!0),type:"transferencia"}),m&&o.jsx(A,{movement:m,accounts:f,categories:{ingresos:[],gastos:[]},onSave:E,onDelete:w,onClose:()=>n(null),loading:M}),o.jsx(k,{isOpen:y,onClose:()=>{p(!1),r()},defaultType:"transfer"})]})}export{U as default};
