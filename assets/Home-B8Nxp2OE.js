import{t as U,j as e,f as D,r as h,u as ee,i as Q,a as Y,s as G,e as z,b as V,c as ne,d as ce,g as ie,h as de,k as me,l as xe,m as ue,n as pe,L as Z,E as he,o as ge,p as ve,q as ye,D as B,v as O,w as fe}from"./index-k7BheE9E.js";import{D as se}from"./DateRangePicker-B1Gin6QR.js";import{P as be}from"./PullToRefresh-UYnO5keD.js";import"./subMonths-iIdC1yWY.js";function je(u,b,r){const p=+U(u,r==null?void 0:r.in),[i,j]=[+U(b.start,r==null?void 0:r.in),+U(b.end,r==null?void 0:r.in)].sort((m,o)=>m-o);return p>=i&&p<=j}function we({totalPesos:u,totalDolares:b,totalGeneralPesos:r,totalGeneralDolares:p,tipoCambio:i,currency:j="ARS",ingresosMes:m=0,gastosMes:o=0,ingresosMesDolares:w=0,gastosMesDolares:N=0}){const n=j==="ARS"?r:p,d=j==="ARS"?m:w,v=j==="ARS"?o:N,k=d-Math.abs(v);return e.jsxs("div",{className:"p-3 sm:p-4 rounded-xl",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[e.jsx("span",{className:"text-[11px] sm:text-xs",style:{color:"var(--text-muted)"},children:"Balance total"}),e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 rounded text-[9px] sm:text-[10px] font-medium",style:{backgroundColor:j==="ARS"?"var(--accent-primary-dim)":"var(--accent-green-dim)",color:j==="ARS"?"var(--accent-primary)":"var(--accent-green)"},children:j})]}),e.jsx("h2",{className:"text-xl sm:text-2xl font-medium tracking-tight mb-3 sm:mb-4",style:{color:"var(--text-primary)"},children:D(n,j)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3 mb-2 sm:mb-3",children:[e.jsxs("div",{className:"p-2 sm:p-3 rounded-lg",style:{backgroundColor:"var(--accent-green-dim)"},children:[e.jsx("p",{className:"text-[9px] sm:text-[10px] uppercase tracking-wide mb-0.5 sm:mb-1",style:{color:"var(--text-muted)"},children:"Ingresos"}),e.jsxs("p",{className:"text-xs sm:text-sm font-medium truncate",style:{color:"var(--accent-green)"},children:["+",D(Math.abs(d),j)]})]}),e.jsxs("div",{className:"p-2 sm:p-3 rounded-lg",style:{backgroundColor:"var(--accent-red-dim)"},children:[e.jsx("p",{className:"text-[9px] sm:text-[10px] uppercase tracking-wide mb-0.5 sm:mb-1",style:{color:"var(--text-muted)"},children:"Gastos"}),e.jsxs("p",{className:"text-xs sm:text-sm font-medium truncate",style:{color:"var(--accent-red)"},children:["-",D(Math.abs(v),j)]})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-1.5 sm:py-2",children:[e.jsx("span",{className:"text-[11px] sm:text-xs",style:{color:"var(--text-muted)"},children:"Flujo neto"}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium",style:{color:k>=0?"var(--accent-green)":"var(--accent-red)"},children:[k>=0?"+":"",D(k,j)]})]}),i&&e.jsxs("div",{className:"flex items-center justify-between pt-1.5 sm:pt-2 mt-1.5 sm:mt-2",style:{borderTop:"1px solid var(--border-subtle)"},children:[e.jsx("span",{className:"text-[11px] sm:text-xs",style:{color:"var(--text-muted)"},children:"Tipo de cambio"}),e.jsxs("span",{className:"text-[11px] sm:text-xs font-medium",style:{color:"var(--text-secondary)"},children:[D(i)," / USD"]})]})]})}function Ne({accounts:u,loading:b,onAccountClick:r}){const[p,i]=h.useState(!0),j=ee();if(b)return e.jsx("div",{className:"card-glass overflow-hidden",children:e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsx("div",{className:"h-4 w-24 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-4 w-16 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}})]})});if(!u||u.length===0)return null;const m=o=>{r&&r(o)};return e.jsxs("div",{className:"card-glass overflow-hidden transition-all duration-300",children:[e.jsxs("button",{onClick:()=>i(!p),className:"w-full px-3 py-3 sm:p-4 flex items-center justify-between text-left transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.99]",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-9 sm:h-9 rounded-lg sm:rounded-xl flex items-center justify-center",style:{backgroundColor:"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-4 h-4 sm:w-4.5 sm:h-4.5",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm sm:text-[15px]",style:{color:"var(--text-primary)"},children:"Cuentas"}),e.jsx("span",{className:"ml-1.5 sm:ml-2 text-[9px] sm:text-[10px] px-1.5 sm:px-2 py-0.5 rounded-full font-medium",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:u.length})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("span",{className:"text-[11px] sm:text-xs font-medium hidden sm:inline",style:{color:"var(--text-secondary)"},children:p?"Ocultar":"Ver todas"}),e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-md sm:rounded-lg flex items-center justify-center transition-colors",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("svg",{className:`w-3.5 h-3.5 sm:w-4 sm:h-4 transition-transform duration-300 ${p?"rotate-180":""}`,style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),p&&e.jsxs("div",{className:"animate-scale-in",style:{borderTop:"1px solid var(--border-subtle)"},children:[e.jsx("div",{className:"hidden lg:grid lg:grid-cols-2 xl:grid-cols-3 gap-px",style:{backgroundColor:"var(--border-subtle)"},children:u.map((o,w)=>{const N=o.moneda==="Peso",n=N?"#75AADB":"#3CB371",d=!!o.icon,v=d&&Q(o.icon);return e.jsxs("button",{onClick:()=>m(o),className:"p-4 flex items-center gap-3 text-left transition-all duration-200 hover:bg-[var(--bg-tertiary)] group",style:{backgroundColor:"var(--bg-secondary)",animationDelay:`${w*50}ms`},children:[e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center flex-shrink-0 transition-transform duration-200 group-hover:scale-110 overflow-hidden",style:{backgroundColor:d&&!v?"transparent":`${n}15`,boxShadow:`0 0 20px ${n}10`},children:d?v?e.jsx("span",{className:"text-xl",children:o.icon}):e.jsx("img",{src:Y(o.icon),alt:o.nombre,className:"w-full h-full object-cover rounded-xl"}):e.jsx("span",{className:"text-sm font-bold",style:{color:n},children:N?"$":"US$"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold truncate text-[15px]",style:{color:"var(--text-primary)"},children:o.nombre}),e.jsxs("p",{className:"text-[11px] mt-0.5",style:{color:"var(--text-secondary)"},children:[N?"Pesos":"DÃ³lares",o.tipo&&` Â· ${o.tipo}`]})]}),e.jsx("div",{className:"text-right flex-shrink-0",children:e.jsx("p",{className:"font-bold text-[15px]",style:{color:n},children:D(o.balanceActual,N?"ARS":"USD")})})]},o.nombre)})}),e.jsx("div",{className:"lg:hidden overflow-hidden",children:u.map((o,w)=>{const N=o.moneda==="Peso",n=N?"#75AADB":"#3CB371",d=!!o.icon,v=d&&Q(o.icon);return e.jsxs("button",{onClick:()=>m(o),className:"w-full px-3 py-2.5 flex items-start gap-2 text-left transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.99] group",style:{borderBottom:w<u.length-1?"1px solid var(--border-subtle)":"none"},children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5 overflow-hidden",style:{backgroundColor:d&&!v?"transparent":`${n}15`},children:d?v?e.jsx("span",{className:"text-lg",children:o.icon}):e.jsx("img",{src:Y(o.icon),alt:o.nombre,className:"w-full h-full object-cover rounded-lg"}):e.jsx("span",{className:"text-[11px] font-bold",style:{color:n},children:N?"$":"US$"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-[13px] leading-tight break-words",style:{color:"var(--text-primary)",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:o.nombre}),e.jsxs("p",{className:"text-[10px] mt-0.5",style:{color:"var(--text-secondary)"},children:[N?"Pesos":"DÃ³lares",o.tipo&&` Â· ${o.tipo}`]})]}),e.jsx("div",{className:"text-right flex-shrink-0",children:e.jsx("p",{className:"font-bold text-[13px]",style:{color:n},children:D(o.balanceActual,N?"ARS":"USD")})})]},o.nombre)})}),e.jsx("button",{onClick:()=>j("/cuentas"),className:"w-full py-2.5 sm:p-3.5 text-center text-xs sm:text-sm font-semibold transition-all duration-200 hover:bg-[var(--accent-primary-dim)] active:scale-[0.99]",style:{color:"var(--accent-primary)",borderTop:"1px solid var(--border-subtle)"},children:"Ver detalles de cuentas â†’"})]})]})}function ke({movements:u,loading:b}){var m,o,w,N;const[r,p]=h.useState("ARS"),i=h.useMemo(()=>{if(!u||u.length===0)return null;const n=new Date,d=G(n,{weekStartsOn:1}),v=z(n,{weekStartsOn:1}),k=u.filter(y=>{if(y.tipo!=="gasto")return!1;const f=new Date(y.fecha);return je(f,{start:d,end:v})});if(k.length===0)return{avgDaily:0,avgDailyDolares:0,maxDay:null,topCategory:null,totalWeek:0,totalWeekDolares:0,daysWithExpenses:0};const C=k.reduce((y,f)=>y+(f.montoPesos||f.monto||0),0),E=k.reduce((y,f)=>y+(f.montoDolares||0),0),l=new Set(k.map(y=>V(new Date(y.fecha),"yyyy-MM-dd"))).size,c=C/7,t=E/7,x={};k.forEach(y=>{const f=V(new Date(y.fecha),"yyyy-MM-dd"),T=V(new Date(y.fecha),"EEEE",{locale:ne});x[f]||(x[f]={name:T,amount:0,amountDolares:0,date:f}),x[f].amount+=y.montoPesos||y.monto||0,x[f].amountDolares+=y.montoDolares||0});const A=Object.values(x).sort((y,f)=>f.amount-y.amount)[0]||null,L={};k.forEach(y=>{const f=y.categoria||"Sin categorÃ­a";L[f]||(L[f]={name:f,amount:0,amountDolares:0}),L[f].amount+=y.montoPesos||y.monto||0,L[f].amountDolares+=y.montoDolares||0});const I=Object.values(L).sort((y,f)=>f.amount-y.amount)[0]||null;return{avgDaily:c,avgDailyDolares:t,maxDay:A,topCategory:I,totalWeek:C,totalWeekDolares:E,daysWithExpenses:l}},[u]);if(b)return e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-md sm:rounded-lg skeleton-shimmer",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-4 w-24 sm:w-28 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}})]}),e.jsx("div",{className:"card-glass p-3 sm:p-4",children:e.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:[1,2,3].map(n=>e.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-12 sm:w-16 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-4 sm:h-5 w-16 sm:w-20 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}})]},n))})})]});if(!i||i.totalWeek===0)return e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-md sm:rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h3",{className:"text-sm sm:text-[15px] font-semibold",style:{color:"var(--text-primary)"},children:"Esta semana"})]}),e.jsxs("div",{className:"card-glass p-4 sm:p-6 text-center",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-2 sm:mb-3 rounded-lg sm:rounded-xl flex items-center justify-center",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("p",{className:"text-xs sm:text-sm font-medium",style:{color:"var(--text-secondary)"},children:"Sin gastos esta semana"})]})]});const j=n=>{const d=n==null?void 0:n.match(/^[\p{Emoji}\u200d]+/u);return d?d[0]:"ðŸ“Š"};return e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-md sm:rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h3",{className:"text-sm sm:text-[15px] font-semibold",style:{color:"var(--text-primary)"},children:"Esta semana"})]}),e.jsxs("div",{className:"inline-flex rounded-lg sm:rounded-xl p-0.5 sm:p-1",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsxs("button",{onClick:()=>p("ARS"),className:"px-2 sm:px-3.5 py-1 sm:py-1.5 rounded-md sm:rounded-lg text-[11px] sm:text-xs font-semibold transition-all duration-300 active:scale-95 flex items-center gap-1 sm:gap-1.5",style:{backgroundColor:r==="ARS"?"var(--accent-primary)":"transparent",color:r==="ARS"?"white":"var(--text-secondary)",boxShadow:r==="ARS"?"0 4px 12px var(--accent-primary-glow)":"none"},children:[e.jsx("img",{src:"/icons/catalog/ARS.svg",alt:"ARS",className:"w-3.5 h-3.5 sm:w-4 sm:h-4 rounded-sm"}),"ARS"]}),e.jsxs("button",{onClick:()=>p("USD"),className:"px-2 sm:px-3.5 py-1 sm:py-1.5 rounded-md sm:rounded-lg text-[11px] sm:text-xs font-semibold transition-all duration-300 active:scale-95 flex items-center gap-1 sm:gap-1.5",style:{backgroundColor:r==="USD"?"var(--accent-green)":"transparent",color:r==="USD"?"white":"var(--text-secondary)",boxShadow:r==="USD"?"0 4px 12px rgba(0, 217, 154, 0.3)":"none"},children:[e.jsx("img",{src:"/icons/catalog/USD.svg",alt:"USD",className:"w-3.5 h-3.5 sm:w-4 sm:h-4 rounded-sm"}),"USD"]})]})]}),e.jsx("div",{className:"card-glass p-3 sm:p-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:[e.jsxs("div",{className:"group p-2 sm:p-3 rounded-xl transition-all duration-200 hover:bg-[var(--bg-tertiary)]",children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 mb-1.5 sm:mb-2",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-md sm:rounded-lg flex items-center justify-center",style:{backgroundColor:"rgba(59, 130, 246, 0.15)"},children:e.jsx("svg",{className:"w-2.5 h-2.5 sm:w-3 sm:h-3",style:{color:"var(--accent-blue)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("span",{className:"text-[9px] sm:text-[10px] uppercase tracking-wider font-medium",style:{color:"var(--text-secondary)"},children:"Prom/dÃ­a"})]}),e.jsx("p",{className:"text-xs sm:text-base font-bold truncate",style:{color:"var(--accent-blue)"},children:D(r==="ARS"?i.avgDaily:i.avgDailyDolares,r)})]}),e.jsxs("div",{className:"group p-2 sm:p-3 rounded-xl transition-all duration-200 hover:bg-[var(--bg-tertiary)]",children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 mb-1.5 sm:mb-2",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-md sm:rounded-lg flex items-center justify-center",style:{backgroundColor:"rgba(255, 92, 114, 0.15)"},children:e.jsx("svg",{className:"w-2.5 h-2.5 sm:w-3 sm:h-3",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("span",{className:"text-[9px] sm:text-[10px] uppercase tracking-wider font-medium",style:{color:"var(--text-secondary)"},children:"DÃ­a pico"})]}),e.jsx("p",{className:"text-xs sm:text-sm font-bold capitalize truncate",style:{color:"var(--accent-red)"},children:((m=i.maxDay)==null?void 0:m.name)||"-"}),e.jsx("p",{className:"text-[10px] sm:text-[11px] mt-0.5 truncate",style:{color:"var(--text-secondary)"},children:i.maxDay?D(r==="ARS"?i.maxDay.amount:i.maxDay.amountDolares,r):"-"})]}),e.jsxs("div",{className:"group p-2 sm:p-3 rounded-xl transition-all duration-200 hover:bg-[var(--bg-tertiary)]",children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 mb-1.5 sm:mb-2",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-md sm:rounded-lg flex items-center justify-center text-[10px] sm:text-xs",style:{backgroundColor:"rgba(20, 184, 166, 0.15)"},children:j((o=i.topCategory)==null?void 0:o.name)}),e.jsx("span",{className:"text-[9px] sm:text-[10px] uppercase tracking-wider font-medium",style:{color:"var(--text-secondary)"},children:"Top"})]}),e.jsx("p",{className:"text-xs sm:text-sm font-bold truncate",style:{color:"var(--accent-primary)"},children:((N=(w=i.topCategory)==null?void 0:w.name)==null?void 0:N.replace(/^[\p{Emoji}\u200d]+\s*/u,"").trim())||"-"}),e.jsx("p",{className:"text-[10px] sm:text-[11px] mt-0.5 truncate",style:{color:"var(--text-secondary)"},children:i.topCategory?D(r==="ARS"?i.topCategory.amount:i.topCategory.amountDolares,r):"-"})]})]})})]})}function Ce({accounts:u=[],categories:b={ingresos:[],gastos:[]},filters:r,onFilterChange:p}){var n,d,v,k,C,E;const[i,j]=h.useState(!1);[...b.ingresos||[],...b.gastos||[]];const m=(l,c)=>{const t=r[l]||[];let x;t.includes(c)?x=t.filter(S=>S!==c):x=[...t,c],p==null||p({...r,[l]:x})},o=(l,c)=>(r[l]||[]).includes(c),w=[((n=r.tipos)==null?void 0:n.length)>0&&((d=r.tipos)==null?void 0:d.length)<3,((v=r.cuentas)==null?void 0:v.length)>0,((k=r.categorias)==null?void 0:k.length)>0].filter(Boolean).length,N=()=>{p==null||p({tipos:[],cuentas:[],categorias:[]})};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>j(!i),className:"flex items-center gap-2 px-3.5 py-2.5 rounded-xl text-sm transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.98]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),e.jsx("span",{className:"font-medium",children:"Filtros"}),w>0&&e.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold",style:{backgroundColor:"var(--accent-primary)",color:"white",boxShadow:"0 2px 8px var(--accent-primary-glow)"},children:w}),e.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&e.jsxs("div",{className:"p-4 rounded-2xl space-y-4 animate-scale-in card-glass",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[11px] font-semibold uppercase tracking-wider mb-2.5",style:{color:"var(--text-secondary)"},children:"Tipo de movimiento"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"ingreso",label:"Ingresos",color:"var(--accent-green)",glow:"rgba(0, 217, 154, 0.3)"},{value:"gasto",label:"Gastos",color:"var(--accent-red)",glow:"rgba(255, 92, 114, 0.3)"},{value:"transferencia",label:"Transferencias",color:"var(--accent-blue)",glow:"rgba(59, 130, 246, 0.3)"}].map(l=>{const c=o("tipos",l.value);return e.jsx("button",{onClick:()=>m("tipos",l.value),className:"px-3.5 py-2 rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:c?l.color:"var(--bg-secondary)",color:c?"white":"var(--text-secondary)",boxShadow:c?`0 4px 16px ${l.glow}`:"none"},children:l.label},l.value)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"Cuentas"}),e.jsx("button",{onClick:()=>{const l=u.map(t=>t.nombre),c=l.every(t=>{var x;return(x=r.cuentas)==null?void 0:x.includes(t)});p==null||p({...r,cuentas:c?[]:l})},className:"text-[10px] font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:u.length>0&&u.every(l=>{var c;return(c=r.cuentas)==null?void 0:c.includes(l.nombre)})?"Deseleccionar todos":"Seleccionar todos"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-28 overflow-y-auto custom-scrollbar",children:u.map(l=>{const c=o("cuentas",l.nombre);return e.jsx("button",{onClick:()=>m("cuentas",l.nombre),className:"px-3.5 py-2 rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:c?"var(--accent-primary)":"var(--bg-secondary)",color:c?"white":"var(--text-secondary)",boxShadow:c?"0 4px 16px var(--accent-primary-glow)":"none"},children:l.nombre},l.nombre)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"CategorÃ­as"}),(()=>{const l=[...(b.ingresos||[]).map(t=>typeof t=="string"?t:t.value),...(b.gastos||[]).map(t=>typeof t=="string"?t:t.value)],c=l.length>0&&l.every(t=>{var x;return(x=r.categorias)==null?void 0:x.includes(t)});return e.jsx("button",{onClick:()=>{p==null||p({...r,categorias:c?[]:l})},className:"text-[10px] font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:c?"Deseleccionar todos":"Seleccionar todos"})})()]}),e.jsxs("div",{className:"flex flex-wrap gap-2 max-h-36 overflow-y-auto custom-scrollbar",children:[((C=b.ingresos)==null?void 0:C.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-full text-[10px] font-semibold uppercase tracking-wider",style:{color:"var(--accent-green)"},children:"Ingresos:"}),b.ingresos.map(l=>{const c=typeof l=="string"?l:l.value,t=typeof l=="string"?l:l.label,x=o("categorias",c);return e.jsx("button",{onClick:()=>m("categorias",c),className:"px-3.5 py-2 rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:x?"var(--accent-green)":"var(--bg-secondary)",color:x?"white":"var(--text-secondary)",boxShadow:x?"0 4px 16px rgba(0, 217, 154, 0.3)":"none"},children:t},c)})]}),((E=b.gastos)==null?void 0:E.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-full text-[10px] font-semibold uppercase tracking-wider mt-2",style:{color:"var(--accent-red)"},children:"Gastos:"}),b.gastos.map(l=>{const c=typeof l=="string"?l:l.value,t=typeof l=="string"?l:l.label,x=o("categorias",c);return e.jsx("button",{onClick:()=>m("categorias",c),className:"px-3.5 py-2 rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:x?"var(--accent-red)":"var(--bg-secondary)",color:x?"white":"var(--text-secondary)",boxShadow:x?"0 4px 16px rgba(255, 92, 114, 0.3)":"none"},children:t},c)})]})]})]}),w>0&&e.jsx("div",{className:"pt-3",style:{borderTop:"1px solid var(--border-subtle)"},children:e.jsxs("button",{onClick:N,className:"text-xs font-semibold flex items-center gap-1.5 transition-all duration-200 hover:opacity-80 active:scale-95",style:{color:"var(--accent-primary)"},children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Limpiar filtros"]})})]})]})}function Se({movements:u,dateRange:b,onDateRangeChange:r,filters:p,onFilterChange:i,accounts:j,categories:m,onMovementClick:o,onMovementDelete:w,loading:N=!1,currency:n="ARS"}){const[d,v]=h.useState(null),k=t=>{switch(t){case"ingreso":return{color:"var(--accent-green)",bgColor:"rgba(0, 217, 154, 0.12)",glowColor:"rgba(0, 217, 154, 0.3)",prefix:"+",icon:"up"};case"gasto":return{color:"var(--accent-red)",bgColor:"rgba(255, 92, 114, 0.12)",glowColor:"rgba(255, 92, 114, 0.3)",prefix:"-",icon:"down"};case"transferencia":return{color:"var(--accent-blue)",bgColor:"rgba(59, 130, 246, 0.12)",glowColor:"rgba(59, 130, 246, 0.3)",prefix:"",icon:"transfer"};default:return{color:"var(--accent-blue)",bgColor:"rgba(59, 130, 246, 0.12)",glowColor:"rgba(59, 130, 246, 0.3)",prefix:"",icon:"down"}}},C=(t,x)=>{t.stopPropagation(),v(x)},E=()=>{d&&(w==null||w(d),v(null))},l=(t,x)=>{const S="w-4 h-4 sm:w-5 sm:h-5";return t==="transferencia"?e.jsx("svg",{className:S,style:{color:x},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}):t==="ingreso"?e.jsx("svg",{className:S,style:{color:x},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})}):e.jsx("svg",{className:S,style:{color:x},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})},c=()=>e.jsx("div",{className:"card-glass overflow-hidden",children:[1,2,3].map(t=>e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 px-3 py-2.5 sm:p-4",style:{borderBottom:t<3?"1px solid var(--border-subtle)":"none"},children:[e.jsx("div",{className:"w-9 h-9 sm:w-11 sm:h-11 rounded-lg sm:rounded-xl skeleton-shimmer",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsxs("div",{className:"flex-1 space-y-2 sm:space-y-2.5",children:[e.jsx("div",{className:"h-3.5 sm:h-4 w-20 sm:w-28 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-2.5 sm:h-3 w-24 sm:w-36 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}})]}),e.jsxs("div",{className:"text-right space-y-2 sm:space-y-2.5",children:[e.jsx("div",{className:"h-4 sm:h-5 w-16 sm:w-24 skeleton-shimmer rounded-lg ml-auto",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-2.5 sm:h-3 w-12 sm:w-16 skeleton-shimmer rounded-lg ml-auto",style:{backgroundColor:"var(--bg-tertiary)"}})]})]},t))});return e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 sm:gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-md sm:rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsx("h3",{className:"text-sm sm:text-[15px] font-semibold",style:{color:"var(--text-primary)"},children:"Movimientos"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{value:b,onChange:r,defaultPreset:"Esta semana"}),(b.from||b.to)&&e.jsx("button",{onClick:()=>r({from:null,to:null}),className:"p-1.5 rounded-lg transition-colors hover:opacity-80",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-muted)"},title:"Limpiar fechas",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsx(Ce,{accounts:j,categories:m,filters:p,onFilterChange:i}),N?c():!u||u.length===0?e.jsxs("div",{className:"card-glass p-6 sm:p-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 rounded-xl sm:rounded-2xl flex items-center justify-center",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8",style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsx("p",{className:"font-semibold text-sm sm:text-base mb-0.5 sm:mb-1",style:{color:"var(--text-primary)"},children:"Sin movimientos"}),e.jsx("p",{className:"text-xs sm:text-sm",style:{color:"var(--text-secondary)"},children:"No hay movimientos en este periodo"})]}):e.jsx("div",{className:"card-glass overflow-hidden",children:u.map((t,x)=>{const S=k(t.tipo);return e.jsxs("div",{className:`group flex items-center gap-2 sm:gap-3 px-3 py-2.5 sm:p-4 transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.995] ${x!==u.length-1?"border-b":""}`,style:{borderColor:"var(--border-subtle)"},children:[e.jsxs("button",{onClick:()=>o==null?void 0:o(t),className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0 text-left transition-transform duration-200",style:{backgroundColor:"transparent"},children:[e.jsx("div",{className:"w-9 h-9 sm:w-11 sm:h-11 rounded-lg sm:rounded-xl flex items-center justify-center flex-shrink-0 transition-all duration-200 group-hover:scale-110",style:{backgroundColor:S.bgColor,boxShadow:`0 0 0 ${S.glowColor}`},onMouseEnter:A=>A.currentTarget.style.boxShadow=`0 0 20px ${S.glowColor}`,onMouseLeave:A=>A.currentTarget.style.boxShadow=`0 0 0 ${S.glowColor}`,children:l(t.tipo,S.color)}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("p",{className:"font-semibold truncate text-sm sm:text-[15px]",style:{color:"var(--text-primary)"},children:t.tipo==="transferencia"?"Transferencia":t.categoria||""}),t.cuota&&e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 rounded-md sm:rounded-lg text-[9px] sm:text-[10px] font-semibold flex-shrink-0",style:{backgroundColor:"rgba(20, 184, 166, 0.12)",color:"var(--accent-primary)"},children:t.cuota})]}),e.jsx("p",{className:"text-[11px] sm:text-xs truncate mt-0.5",style:{color:"var(--text-secondary)"},children:t.tipo==="transferencia"?`${t.cuentaSaliente} â†’ ${t.cuentaEntrante}`:t.cuenta})]}),e.jsxs("div",{className:"text-right flex-shrink-0 pl-1",children:[e.jsx("p",{className:"font-bold text-sm sm:text-lg",style:{color:S.color},children:t.tipo==="transferencia"?D(n==="ARS"?t.montoSaliente:t.montoSalienteDolares||0,n):`${S.prefix}${D(n==="ARS"?t.montoPesos||t.monto:t.montoDolares||0,n)}`}),e.jsx("p",{className:"text-[10px] sm:text-[11px] mt-0.5",style:{color:"var(--text-secondary)"},children:ce(t.fecha,"short")})]})]}),e.jsx("button",{onClick:A=>C(A,t),className:"p-2 sm:p-2.5 rounded-lg sm:rounded-xl flex-shrink-0 transition-all duration-200 hover:bg-red-500/15 active:scale-95",style:{color:"var(--text-muted)"},title:"Eliminar",children:e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-colors hover:text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},t.rowIndex||x)})}),u&&u.length>0&&e.jsxs("p",{className:"text-[10px] sm:text-[11px] text-center font-medium",style:{color:"var(--text-secondary)"},children:["Mostrando ",u.length," movimiento",u.length!==1?"s":""]}),d&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-md animate-fade-in",onClick:()=>v(null)}),e.jsx("div",{className:"relative w-full max-w-sm rounded-2xl p-6 animate-scale-in card-elevated",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center",style:{backgroundColor:"rgba(255, 92, 114, 0.12)",boxShadow:"0 0 30px rgba(255, 92, 114, 0.2)"},children:e.jsx("svg",{className:"w-8 h-8",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("h3",{className:"text-lg font-bold font-display mb-2",style:{color:"var(--text-primary)"},children:"Eliminar movimiento"}),e.jsxs("p",{className:"text-sm mb-5",style:{color:"var(--text-secondary)"},children:["Â¿EstÃ¡s seguro de que quieres eliminar ",d.tipo==="transferencia"?"esta":"este"," ",d.tipo,"?",e.jsx("br",{}),e.jsx("span",{className:"font-bold text-base mt-1 inline-block",style:{color:k(d.tipo).color},children:d.tipo==="transferencia"?D(d.montoSaliente):D(d.montoPesos||d.monto)})," - ",d.tipo==="transferencia"?`${d.cuentaSaliente} â†’ ${d.cuentaEntrante}`:d.categoria]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>v(null),className:"flex-1 py-3.5 rounded-xl font-semibold transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.98]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},children:"Cancelar"}),e.jsx("button",{onClick:E,className:"flex-1 py-3.5 rounded-xl font-semibold text-white transition-all duration-200 hover:opacity-90 active:scale-[0.98]",style:{backgroundColor:"var(--accent-red)",boxShadow:"0 4px 20px rgba(255, 92, 114, 0.3)"},children:"Eliminar"})]})]})})]})]})}function Le(){const u=ee(),{showError:b}=ie(),[r,p]=h.useState("ARS"),[i,j]=h.useState({from:me(new Date),to:de(new Date)}),[m,o]=h.useState(()=>{try{const s=localStorage.getItem("cashe_home_balance_accounts");if(s)return JSON.parse(s)}catch(s){console.warn("Error loading balance account filters:",s)}return[]});h.useEffect(()=>{try{localStorage.setItem("cashe_home_balance_accounts",JSON.stringify(m))}catch(s){console.warn("Error saving balance account filters:",s)}},[m]);const[w,N]=h.useState(!1),[n,d]=h.useState(()=>{try{const s=localStorage.getItem("cashe_home_movement_dates");if(s){const a=JSON.parse(s);return{from:a.from?new Date(a.from):G(new Date,{weekStartsOn:1}),to:a.to?new Date(a.to):z(new Date,{weekStartsOn:1})}}}catch(s){console.warn("Error loading saved date range:",s)}return{from:G(new Date,{weekStartsOn:1}),to:z(new Date,{weekStartsOn:1})}});h.useEffect(()=>{var s,a;try{localStorage.setItem("cashe_home_movement_dates",JSON.stringify({from:((s=n.from)==null?void 0:s.toISOString())||null,to:((a=n.to)==null?void 0:a.toISOString())||null}))}catch(M){console.warn("Error saving date range:",M)}},[n]);const[v,k]=h.useState(()=>{try{const s=localStorage.getItem("cashe_home_filters");if(s){const a=JSON.parse(s);return{tipos:a.tipos||[],cuentas:a.cuentas||[],categorias:a.categorias||[]}}}catch(s){console.warn("Error loading saved filters:",s)}return{tipos:[],cuentas:[],categorias:[]}});h.useEffect(()=>{try{localStorage.setItem("cashe_home_filters",JSON.stringify(v))}catch(s){console.warn("Error saving filters:",s)}},[v]);const[C,E]=h.useState(null),[l,c]=h.useState([]),[t,x]=h.useState([]),[S,A]=h.useState({ingresos:[],gastos:[]}),[L,_]=h.useState(!0),[I,y]=h.useState(!0),[f,T]=h.useState(!0),[J,q]=h.useState(null),[F,$]=h.useState(null),[te,X]=h.useState(!1);h.useEffect(()=>{async function s(){try{const[a,M]=await Promise.all([ge(),ve()]);x(a.accounts||[]),A(M.categorias||{ingresos:[],gastos:[]})}catch(a){console.error("Error fetching initial data:",a)}finally{T(!1)}}s()},[]);const W=h.useCallback(async()=>{try{_(!0);const s=await xe({fromDate:i.from?V(i.from,"yyyy-MM-dd"):null,toDate:i.to?V(i.to,"yyyy-MM-dd"):null});E(s.dashboard),q(null)}catch(s){q(s.message),console.error("Error fetching dashboard:",s)}finally{_(!1)}},[i]);h.useEffect(()=>{W()},[W]);const P=h.useCallback(async()=>{try{y(!0);const s=await ue({fromDate:n.from?V(n.from,"yyyy-MM-dd"):null,toDate:n.to?V(n.to,"yyyy-MM-dd"):null,tipos:v.tipos,cuentas:v.cuentas,categorias:v.categorias});c(s.movements||[])}catch(s){console.error("Error fetching movements:",s)}finally{y(!1)}},[n,v]);h.useEffect(()=>{P()},[P]);const H=h.useCallback(async()=>{await Promise.all([W(),P()])},[W,P]);pe(B.ALL_DATA_CHANGED,H);const ae=async s=>{try{X(!0),await fe(s),$(null);const a=s.tipo==="ingreso"?B.INCOMES_CHANGED:s.tipo==="gasto"?B.EXPENSES_CHANGED:B.TRANSFERS_CHANGED;O(a),O(B.ACCOUNTS_CHANGED),await Promise.all([W(),P()])}catch(a){console.error("Error updating movement:",a),b("No se pudo guardar el movimiento",a.message)}finally{X(!1)}},K=async s=>{$(null),c(a=>a.filter(M=>!(M.tipo===s.tipo&&M.rowIndex===s.rowIndex)));try{await ye(s);const a=s.tipo==="ingreso"?B.INCOMES_CHANGED:s.tipo==="gasto"?B.EXPENSES_CHANGED:B.TRANSFERS_CHANGED;O(a),O(B.ACCOUNTS_CHANGED),await Promise.all([W(),P()])}catch(a){console.error("Error deleting movement:",a),b("No se pudo eliminar el movimiento",a.message),await P()}},re=s=>{$(null),u("/nuevo",{state:{prefill:s}})},R=m.length>0?t.filter(s=>m.includes(s.nombre)):t,oe={totalPesos:R.filter(s=>s.moneda==="Peso").reduce((s,a)=>s+(a.balanceActual||0),0),totalDolares:R.filter(s=>s.moneda==="DÃ³lar").reduce((s,a)=>s+(a.balanceActual||0),0),totalGeneralPesos:R.filter(s=>s.moneda==="Peso").reduce((s,a)=>s+(a.balanceActual||0),0)+R.filter(s=>s.moneda==="DÃ³lar").reduce((s,a)=>s+(a.balanceActual||0),0)*((C==null?void 0:C.tipoCambio)||1e3),totalGeneralDolares:R.filter(s=>s.moneda==="DÃ³lar").reduce((s,a)=>s+(a.balanceActual||0),0)+R.filter(s=>s.moneda==="Peso").reduce((s,a)=>s+(a.balanceActual||0),0)/((C==null?void 0:C.tipoCambio)||1e3),ingresosMes:R.reduce((s,a)=>s+(a.totalIngresos||0),0),gastosMes:R.reduce((s,a)=>s+(a.totalGastos||0),0)},g=m.length>0?{...C,...oe}:C;return f&&L?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(Z,{size:"lg"})}):J&&!C?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] gap-4",children:[e.jsxs("p",{style:{color:"var(--accent-red)"},children:["Error: ",J]}),e.jsx("button",{onClick:W,className:"px-4 py-2 rounded-lg font-medium",style:{backgroundColor:"var(--accent-primary)",color:"white"},children:"Reintentar"})]}):e.jsx(be,{onRefresh:H,disabled:L&&I,children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2 sm:gap-3",children:[e.jsx("h1",{className:"text-base sm:text-lg font-medium",style:{color:"var(--text-primary)"},children:"Dashboard"}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsxs("div",{className:"inline-flex p-0.5 sm:p-1 rounded-md sm:rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsxs("button",{onClick:()=>p("ARS"),className:"px-2 sm:px-3 py-1 sm:py-1.5 rounded-md text-[11px] sm:text-xs font-medium transition-colors duration-150 flex items-center gap-1 sm:gap-1.5",style:{backgroundColor:r==="ARS"?"var(--bg-elevated)":"transparent",color:r==="ARS"?"var(--text-primary)":"var(--text-muted)"},children:[e.jsx("img",{src:"/icons/catalog/ARS.svg",alt:"ARS",className:"w-3.5 h-3.5 sm:w-4 sm:h-4 rounded-sm"}),"ARS"]}),e.jsxs("button",{onClick:()=>p("USD"),className:"px-2 sm:px-3 py-1 sm:py-1.5 rounded-md text-[11px] sm:text-xs font-medium transition-colors duration-150 flex items-center gap-1 sm:gap-1.5",style:{backgroundColor:r==="USD"?"var(--bg-elevated)":"transparent",color:r==="USD"?"var(--text-primary)":"var(--text-muted)"},children:[e.jsx("img",{src:"/icons/catalog/USD.svg",alt:"USD",className:"w-3.5 h-3.5 sm:w-4 sm:h-4 rounded-sm"}),"USD"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{value:i,onChange:j,defaultPreset:"Este mes"}),(i.from||i.to)&&e.jsx("button",{onClick:()=>j({from:null,to:null}),className:"p-1.5 rounded-lg transition-colors hover:opacity-80",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-muted)"},title:"Limpiar fechas",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),L?e.jsx("div",{className:"rounded-xl p-12 flex items-center justify-center",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-subtle)"},children:e.jsx(Z,{})}):e.jsxs("div",{className:"space-y-3",children:[e.jsx(we,{totalPesos:g==null?void 0:g.totalPesos,totalDolares:g==null?void 0:g.totalDolares,totalGeneralPesos:g==null?void 0:g.totalGeneralPesos,totalGeneralDolares:g==null?void 0:g.totalGeneralDolares,tipoCambio:g==null?void 0:g.tipoCambio,currency:r,ingresosMes:g==null?void 0:g.ingresosMes,gastosMes:g==null?void 0:g.gastosMes,ingresosMesDolares:g==null?void 0:g.ingresosMesDolares,gastosMesDolares:g==null?void 0:g.gastosMesDolares}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>N(!w),className:"flex items-center gap-2 px-3.5 py-2.5 rounded-xl text-sm transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.98]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),e.jsx("span",{className:"font-medium",children:"Filtrar cuentas"}),m.length>0&&e.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold",style:{backgroundColor:"var(--accent-primary)",color:"white",boxShadow:"0 2px 8px var(--accent-primary-glow)"},children:m.length}),e.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${w?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),w&&e.jsxs("div",{className:"p-4 rounded-2xl space-y-3 animate-scale-in card-glass",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"Cuentas incluidas en el balance"}),e.jsx("button",{onClick:()=>{const s=t.map(M=>M.nombre),a=s.length>0&&s.every(M=>m.includes(M));o(a?[]:s)},className:"text-[10px] font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:t.length>0&&t.every(s=>m.includes(s.nombre))?"Deseleccionar todos":"Seleccionar todos"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-32 overflow-y-auto custom-scrollbar",children:t.map(s=>{const a=m.length===0||m.includes(s.nombre);return e.jsx("button",{onClick:()=>{if(m.length===0)o([s.nombre]);else if(m.includes(s.nombre)){const M=m.filter(le=>le!==s.nombre);o(M.length===0?[]:M)}else o([...m,s.nombre])},className:"px-3.5 py-2 rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:a?"var(--accent-primary)":"var(--bg-secondary)",color:a?"white":"var(--text-secondary)",boxShadow:a?"0 4px 16px var(--accent-primary-glow)":"none",opacity:m.length===0?.7:1},children:s.nombre},s.nombre)})}),m.length>0&&e.jsx("div",{className:"pt-2",style:{borderTop:"1px solid var(--border-subtle)"},children:e.jsxs("button",{onClick:()=>o([]),className:"text-xs font-semibold flex items-center gap-1.5 transition-all duration-200 hover:opacity-80 active:scale-95",style:{color:"var(--accent-primary)"},children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Mostrar todas las cuentas"]})})]})]})]}),e.jsx(Ne,{accounts:R,loading:f,onAccountClick:s=>{k(a=>({...a,cuentas:[s.nombre]}))}}),e.jsx(ke,{movements:l,loading:I}),e.jsx(Se,{movements:l,dateRange:n,onDateRangeChange:d,filters:v,onFilterChange:k,accounts:t,categories:S,onMovementClick:$,onMovementDelete:K,loading:I,currency:r}),F&&e.jsx(he,{movement:F,accounts:t,categories:S,onSave:ae,onDelete:K,onDuplicate:re,onClose:()=>$(null),onConvertedToRecurring:H,loading:te})]})})}export{Le as default};
