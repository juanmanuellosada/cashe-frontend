import{r as c,j as e,i as k,a as E}from"./index-C9vMEE65.js";import{I as P}from"./IconPicker-BaYPnUxS.js";function w(a){if(!a)return"";const i=parseInt(a);if(!i||i<1||i>31)return"";const l=new Date,m=new Date(l.getFullYear(),l.getMonth()+1,0).getDate(),x=Math.min(i,m),d=new Date(l.getFullYear(),l.getMonth(),x);if(d>=l)return d.toISOString().split("T")[0];const r=new Date(l.getFullYear(),l.getMonth()+2,0).getDate(),o=Math.min(i,r);return new Date(l.getFullYear(),l.getMonth()+1,o).toISOString().split("T")[0]}function Y({account:a,onSave:i,onDelete:l,onClose:m,loading:x}){var N;const d=!!a,[r,o]=c.useState({id:a==null?void 0:a.id,rowIndex:a==null?void 0:a.rowIndex,nombre:(a==null?void 0:a.nombre)||"",balanceInicial:((N=a==null?void 0:a.balanceInicial)==null?void 0:N.toString())||"0",moneda:(a==null?void 0:a.moneda)||"Peso",numeroCuenta:(a==null?void 0:a.numeroCuenta)||"",tipo:(a==null?void 0:a.tipo)||"",esTarjetaCredito:(a==null?void 0:a.esTarjetaCredito)||!1,fechaCierre:(a==null?void 0:a.fechaCierre)||w(a==null?void 0:a.diaCierre)||"",fechaVencimiento:(a==null?void 0:a.fechaVencimiento)||w(a==null?void 0:a.diaVencimiento)||"",icon:(a==null?void 0:a.icon)||null,ocultaDelBalance:(a==null?void 0:a.ocultaDelBalance)||!1}),[b,p]=c.useState(""),[D,y]=c.useState(!1),[h,g]=c.useState(0),[f,j]=c.useState(!1),C=c.useRef(0),T=t=>{t.target.closest("[data-drag-handle]")&&(C.current=t.touches[0].clientY,j(!0))},S=t=>{if(!f)return;const s=t.touches[0].clientY-C.current;s>0&&g(s)},M=()=>{f&&(h>100&&m(),g(0),j(!1))},u=t=>{const{name:s,value:n}=t.target;o(v=>({...v,[s]:n}))},B=t=>{if(t.preventDefault(),r.esTarjetaCredito){if(!r.fechaCierre){p("Seleccion谩 la fecha de cierre");return}const s=new Date(r.fechaCierre+"T12:00:00").getDate(),n=r.fechaVencimiento?new Date(r.fechaVencimiento+"T12:00:00").getDate():null;if(n&&s===n){p("El d铆a de cierre y vencimiento no pueden ser iguales");return}}p(""),i({...r,balanceInicial:parseFloat(r.balanceInicial)||0,diaCierre:r.esTarjetaCredito&&r.fechaCierre?new Date(r.fechaCierre+"T12:00:00").getDate():null,diaVencimiento:r.esTarjetaCredito&&r.fechaVencimiento?new Date(r.fechaVencimiento+"T12:00:00").getDate():null,fechaCierre:r.esTarjetaCredito&&r.fechaCierre||null,fechaVencimiento:r.esTarjetaCredito&&r.fechaVencimiento||null,icon:r.icon,ocultaDelBalance:r.ocultaDelBalance})},I=t=>{o(s=>({...s,icon:t}))},V=h>100;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-start justify-center overflow-y-auto pt-4 sm:pt-6 pb-4",children:[e.jsx("div",{className:"absolute inset-0 backdrop-blur-sm transition-opacity",style:{backgroundColor:`rgba(0, 0, 0, ${Math.max(.6-h/300,0)})`},onClick:m}),e.jsxs("div",{className:"relative w-full sm:max-w-lg mx-2 sm:mx-4 rounded-2xl flex flex-col animate-slide-down max-h-[calc(100dvh-32px)] sm:max-h-[calc(100vh-48px)]",style:{backgroundColor:"var(--bg-secondary)",transform:`translateY(${h}px)`,transition:f?"none":"transform 0.3s ease-out",opacity:V?.5:1},onTouchStart:T,onTouchMove:S,onTouchEnd:M,children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 flex-shrink-0 border-b",style:{borderColor:"var(--border-subtle)"},children:[e.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:d?"Editar Cuenta":"Nueva Cuenta"}),e.jsx("button",{onClick:m,className:"p-1.5 rounded-lg transition-colors hover:bg-[var(--bg-tertiary)]",style:{color:"var(--text-secondary)"},children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:B,className:"flex flex-col flex-1 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"space-y-3 overflow-y-auto px-4 py-3 flex-1",children:[e.jsxs("button",{type:"button",onClick:()=>y(!0),className:"w-full px-3 py-2.5 rounded-lg transition-all duration-200 border border-dashed hover:border-solid flex items-center gap-3",style:{backgroundColor:"var(--bg-tertiary)",borderColor:r.icon?"var(--accent-primary)":"var(--border-medium)"},children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center overflow-hidden flex-shrink-0",style:{backgroundColor:r.icon?k(r.icon)?"var(--bg-secondary)":"transparent":"var(--bg-secondary)"},children:r.icon?k(r.icon)?e.jsx("span",{className:"text-xl",children:r.icon}):e.jsx("img",{src:E(r.icon),alt:"cono",className:"w-full h-full object-cover rounded-lg"}):e.jsx("svg",{className:"w-5 h-5",style:{color:"var(--text-muted)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("p",{className:"text-xs font-medium",style:{color:"var(--text-primary)"},children:r.icon?"Cambiar 铆cono":"Seleccionar 铆cono"})}),e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",style:{color:"var(--text-muted)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Nombre"}),e.jsx("input",{type:"text",name:"nombre",value:r.nombre,onChange:u,className:"w-full px-3 py-2 rounded-lg text-sm border border-transparent focus:border-[var(--accent-primary)]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Balance Inicial"}),e.jsx("input",{type:"number",name:"balanceInicial",value:r.balanceInicial,onChange:u,step:"0.01",className:"w-full px-3 py-2 rounded-lg text-sm border border-transparent focus:border-[var(--accent-primary)]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Moneda"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("button",{type:"button",onClick:()=>o(t=>({...t,moneda:"Peso"})),className:"flex-1 flex items-center justify-center gap-1.5 py-2 rounded-lg text-xs font-medium transition-all",style:{backgroundColor:r.moneda==="Peso"?"rgba(117, 170, 219, 0.2)":"var(--bg-tertiary)",color:r.moneda==="Peso"?"#75AADB":"var(--text-secondary)",border:r.moneda==="Peso"?"1px solid #75AADB":"1px solid transparent"},children:[e.jsx("img",{src:"/icons/catalog/ARS.svg",alt:"ARS",className:"w-4 h-4 rounded-sm"}),"ARS"]}),!r.esTarjetaCredito&&e.jsxs("button",{type:"button",onClick:()=>o(t=>({...t,moneda:"D贸lar"})),className:"flex-1 flex items-center justify-center gap-1.5 py-2 rounded-lg text-xs font-medium transition-all",style:{backgroundColor:r.moneda==="D贸lar"?"rgba(60, 179, 113, 0.2)":"var(--bg-tertiary)",color:r.moneda==="D贸lar"?"#3CB371":"var(--text-secondary)",border:r.moneda==="D贸lar"?"1px solid #3CB371":"1px solid transparent"},children:[e.jsx("img",{src:"/icons/catalog/USD.svg",alt:"USD",className:"w-4 h-4 rounded-sm"}),"USD"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Nro. Cuenta (opcional)"}),e.jsx("input",{type:"text",name:"numeroCuenta",value:r.numeroCuenta,onChange:u,className:"w-full px-3 py-2 rounded-lg text-sm border border-transparent focus:border-[var(--accent-primary)]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Tipo de cuenta"}),e.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:[{value:"Caja de ahorro",icon:"",label:"Ahorro"},{value:"Cuenta corriente",icon:"",label:"Corriente"},{value:"Tarjeta de cr茅dito",icon:"",label:"Cr茅dito"},{value:"Billetera virtual",icon:"",label:"Billetera"},{value:"Efectivo",icon:"",label:"Efectivo"},{value:"Inversi贸n",icon:"",label:"Inversi贸n"}].map(t=>{const s=r.tipo===t.value,n=t.value==="Tarjeta de cr茅dito";return e.jsxs("button",{type:"button",onClick:()=>o(v=>({...v,tipo:t.value,esTarjetaCredito:n,...n?{moneda:"Peso"}:{}})),className:"flex flex-col items-center gap-0.5 p-2 rounded-lg text-xs font-medium transition-all",style:{backgroundColor:s?n?"var(--accent-purple)":"var(--accent-primary)":"var(--bg-tertiary)",color:s?"white":"var(--text-secondary)"},children:[e.jsx("span",{className:"text-base",children:t.icon}),e.jsx("span",{className:"text-xs leading-tight",children:t.label})]},t.value)})})]}),r.esTarjetaCredito&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2 p-3 rounded-lg",style:{backgroundColor:"var(--accent-purple-dim)"},children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Pr贸ximo cierre"}),e.jsx("input",{type:"date",name:"fechaCierre",value:r.fechaCierre,onChange:u,className:"w-full px-3 py-2 rounded-md text-sm font-semibold border border-transparent focus:border-[var(--accent-purple)]",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)"},required:!0}),r.fechaCierre&&e.jsxs("p",{className:"text-[11px] mt-1",style:{color:"var(--text-muted)"},children:["Se usar谩 el d铆a ",new Date(r.fechaCierre+"T12:00:00").getDate()," como cierre mensual recurrente"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Pr贸ximo vencimiento (opcional)"}),e.jsx("input",{type:"date",name:"fechaVencimiento",value:r.fechaVencimiento,onChange:u,className:"w-full px-3 py-2 rounded-md text-sm font-semibold border border-transparent focus:border-[var(--accent-purple)]",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)"}}),r.fechaVencimiento&&e.jsxs("p",{className:"text-[11px] mt-1",style:{color:"var(--text-muted)"},children:["Se usar谩 el d铆a ",new Date(r.fechaVencimiento+"T12:00:00").getDate()," como vencimiento mensual recurrente"]})]})]}),b&&e.jsx("p",{className:"text-xs px-1",style:{color:"var(--accent-red)"},children:b})]}),e.jsxs("button",{type:"button",onClick:()=>o(t=>({...t,ocultaDelBalance:!t.ocultaDelBalance})),className:"w-full flex items-center justify-between p-3 rounded-lg transition-all duration-200",style:{backgroundColor:r.ocultaDelBalance?"var(--accent-primary-dim)":"var(--bg-tertiary)",border:r.ocultaDelBalance?"1px solid var(--accent-primary)":"1px solid transparent"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:r.ocultaDelBalance?"var(--accent-primary)":"var(--bg-secondary)"},children:e.jsx("svg",{className:"w-4 h-4",style:{color:r.ocultaDelBalance?"white":"var(--text-muted)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:"Ocultar del balance"}),e.jsx("p",{className:"text-[11px]",style:{color:"var(--text-secondary)"},children:"No sumar al saldo general"})]})]}),e.jsx("div",{className:"w-11 h-6 rounded-full transition-all duration-200 relative",style:{backgroundColor:r.ocultaDelBalance?"var(--accent-primary)":"var(--bg-secondary)"},children:e.jsx("div",{className:`absolute top-1 w-4 h-4 rounded-full bg-white shadow transition-all duration-200 ${r.ocultaDelBalance?"left-6":"left-1"}`})})]})]}),e.jsxs("div",{className:"flex gap-2 p-3 flex-shrink-0 border-t",style:{borderColor:"var(--border-subtle)",backgroundColor:"var(--bg-secondary)"},children:[d&&l&&e.jsx("button",{type:"button",onClick:l,disabled:x,className:"px-3 py-2.5 rounded-lg text-sm font-medium disabled:opacity-50 transition-all hover:opacity-80",style:{backgroundColor:"rgba(239, 68, 68, 0.15)",color:"var(--accent-red)"},children:"Eliminar"}),e.jsx("button",{type:"submit",disabled:x||!r.nombre,className:"flex-1 py-2.5 rounded-lg text-sm font-semibold text-white disabled:opacity-50 transition-all hover:opacity-90 flex items-center justify-center gap-2",style:{backgroundColor:"var(--accent-primary)"},children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Guardando..."]}):d?"Guardar":"Crear cuenta"})]})]}),e.jsx(P,{isOpen:D,onClose:()=>y(!1),onSelect:I,currentValue:r.icon,showPredefined:!0,title:"cono de cuenta"})]})]})}export{Y as A};
