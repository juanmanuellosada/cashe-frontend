import{am as m,g as $,r as i,j as e,H as G}from"./index-BGEaSxlK.js";const R="15551632329",A=async()=>{const{data:{user:s},error:r}=await m.auth.getUser();if(r)throw console.error("Error getting user:",r),new Error("Error getting authenticated user");if(!s)throw new Error("No authenticated user");return s.id},J=async()=>{const s=await A(),{data:r,error:t}=await m.from("profiles").select("whatsapp_enabled, email, full_name").eq("id",s).single();return t?(console.error("Error checking WhatsApp access:",t),{enabled:!1,email:null,name:null}):{enabled:(r==null?void 0:r.whatsapp_enabled)===!0,email:r==null?void 0:r.email,name:r==null?void 0:r.full_name}},K=async()=>{const s=await A(),{data:r,error:t}=await m.from("whatsapp_users").select("*").eq("user_id",s).maybeSingle();if(t)throw console.error("Error getting WhatsApp status:",t),t;if(!r)return{status:"not_linked",phone:null,verificationCode:null,linkedAt:null};if(r.verified)return{status:"linked",phone:r.phone_number,verificationCode:null,linkedAt:r.updated_at};const a=r.verification_expires_at&&new Date(r.verification_expires_at)<new Date;return{status:a?"code_expired":"pending_verification",phone:null,verificationCode:a?null:r.verification_code,expiresAt:r.verification_expires_at,linkedAt:null}},Q=async()=>{const s=await A(),r=Math.floor(1e5+Math.random()*9e5).toString(),t=new Date(Date.now()+600*1e3).toISOString(),{data:a,error:n}=await m.from("whatsapp_users").upsert({user_id:s,phone_number:`pending_${s}`,verification_code:r,verification_expires_at:t,verified:!1,updated_at:new Date().toISOString()},{onConflict:"user_id",ignoreDuplicates:!1}).select().single();if(n)throw console.error("Error generating verification code:",n),n;return{code:r,expiresAt:t,expiresIn:600}},X=async()=>{const s=await A(),{data:r,error:t}=await m.from("whatsapp_users").select("verified, phone_number, updated_at").eq("user_id",s).maybeSingle();return t?(console.error("Error checking verification:",t),{verified:!1,phone:null}):r?{verified:r.verified===!0,phone:r.verified?r.phone_number:null,linkedAt:r.verified?r.updated_at:null}:{verified:!1,phone:null}},Z=async()=>{const s=await A(),{error:r}=await m.from("whatsapp_users").delete().eq("user_id",s);if(r)throw console.error("Error unlinking WhatsApp:",r),r;return{success:!0}},ee=s=>{if(!s||s.startsWith("pending_"))return null;if(s.startsWith("+54")){const r=s.slice(3);if(r.length>=10){const t=r.slice(0,1)==="9"?r.slice(1,3):r.slice(0,2),a=r.slice(-8);return`+54 9 ${t} ${a.slice(0,4)}-${a.slice(4)}`}}return s},re=async()=>{const s=await A(),{data:r}=await m.from("profiles").select("email, full_name").eq("id",s).single();if(!r)throw new Error("No se pudo obtener informaci√≥n del usuario");const{data:t,error:a}=await m.functions.invoke("send-access-request",{body:{userId:s,email:r.email,name:r.full_name}});if(a)throw console.error("Error requesting access:",a),a;return{success:!0}};function se(){const{showError:s}=$(),[r,t]=i.useState("loading"),[a,n]=i.useState("not_linked"),[l,x]=i.useState({email:null,name:null}),[f,h]=i.useState(null),[g,v]=i.useState(null),[j,y]=i.useState(null),[d,b]=i.useState(null),[w,N]=i.useState(!1),[T,k]=i.useState(!1),[S,C]=i.useState(!1),[_,I]=i.useState(!1);i.useEffect(()=>{o()},[]),i.useEffect(()=>{if(a==="code_generated"){const c=setInterval(async()=>{const u=await X();u.verified&&(n("linked"),v(u.phone),y(u.linkedAt),h(null))},3e3);return()=>clearInterval(c)}},[a]),i.useEffect(()=>{if(!d||a!=="code_generated")return;const u=setInterval(()=>{new Date>new Date(d)&&(n("not_linked"),h(null),b(null))},1e3);return()=>clearInterval(u)},[d,a]);const o=async()=>{try{const c=await J();if(x({email:c.email,name:c.name}),!c.enabled){t("restricted");return}t("enabled");const u=await K();u.status==="linked"?(n("linked"),v(u.phone),y(u.linkedAt)):u.status==="pending_verification"&&u.verificationCode?(n("code_generated"),h(u.verificationCode),b(u.expiresAt)):n("not_linked")}catch(c){console.error("Error checking status:",c),t("restricted")}},p=async()=>{N(!0);try{const c=await Q();h(c.code),b(c.expiresAt),n("code_generated")}catch(c){console.error("Error generating code:",c),s("Error al generar el c√≥digo. Por favor intent√° de nuevo.")}finally{N(!1)}},W=async()=>{N(!0);try{await Z(),n("not_linked"),v(null),y(null),k(!1)}catch(c){console.error("Error unlinking WhatsApp:",c),s("Error al desvincular WhatsApp. Por favor intent√° de nuevo.")}finally{N(!1)}},z=async()=>{I(!0);try{await re(),C(!0),t("requested")}catch(c){console.error("Error requesting access:",c),s("No se pudo enviar la solicitud. Por favor intent√° de nuevo.")}finally{I(!1)}},L=i.useCallback(()=>{if(!d)return null;const c=new Date(d).getTime()-Date.now();if(c<=0)return null;const u=Math.floor(c/6e4),Y=Math.floor(c%6e4/1e3);return`${u}:${Y.toString().padStart(2,"0")}`},[d]),[U,q]=i.useState(null);i.useEffect(()=>{if(a!=="code_generated"){q(null);return}const c=()=>q(L());c();const u=setInterval(c,1e3);return()=>clearInterval(u)},[a,L]);const M=()=>e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-8 h-8",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),H=()=>e.jsxs("div",{className:"space-y-4 mb-4",children:[e.jsx("div",{className:"p-4 rounded-xl border",style:{backgroundColor:"rgba(37, 211, 102, 0.08)",borderColor:"rgba(37, 211, 102, 0.2)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:"rgba(37, 211, 102, 0.15)"},children:e.jsx("span",{className:"text-xl",children:"ü§ñ"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm mb-1",style:{color:"#25D366"},children:"Con Inteligencia Artificial"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Chate√° naturalmente como si hablaras con una persona. El bot entiende lenguaje natural en espa√±ol argentino."})]})]})}),e.jsxs("div",{className:"p-4 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("h4",{className:"font-medium text-sm mb-3",style:{color:"var(--text-primary)"},children:"Ejemplos de lo que pod√©s decir:"}),e.jsxs("div",{className:"space-y-2 text-sm",style:{color:"var(--text-secondary)"},children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("span",{children:"üí¨"}),e.jsx("code",{className:"text-xs",style:{color:"#25D366"},children:'"Gast√© 500 en comida con galicia"'})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("span",{children:"üí¨"}),e.jsx("code",{className:"text-xs",style:{color:"#25D366"},children:'"Cobr√© 50000 de sueldo en santander"'})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("span",{children:"üí¨"}),e.jsx("code",{className:"text-xs",style:{color:"#25D366"},children:'"Transfer√≠ 10k de mp a brubank"'})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("span",{children:"üí¨"}),e.jsx("code",{className:"text-xs",style:{color:"#25D366"},children:'"Cu√°nto gast√© en comida este mes?"'})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("span",{children:"üí¨"}),e.jsx("code",{className:"text-xs",style:{color:"#25D366"},children:'"Saldo mercadopago"'})]})]})]}),e.jsxs("div",{className:"p-4 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("h4",{className:"font-medium text-sm mb-3",style:{color:"var(--text-primary)"},children:"Funcionalidades"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",style:{color:"var(--text-secondary)"},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{color:"#25D366"},children:"üí∏"}),e.jsx("span",{children:"Gastos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{color:"#25D366"},children:"üí∞"}),e.jsx("span",{children:"Ingresos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{color:"#25D366"},children:"üîÑ"}),e.jsx("span",{children:"Transferencias"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{color:"#25D366"},children:"üìä"}),e.jsx("span",{children:"Saldos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{color:"#25D366"},children:"üìà"}),e.jsx("span",{children:"Resumen mensual"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{color:"#25D366"},children:"üïê"}),e.jsx("span",{children:"√öltimos movimientos"})]})]}),e.jsx("p",{className:"text-xs mt-3",style:{color:"var(--text-muted)"},children:"Tambi√©n pod√©s usar los botones del men√∫ si prefer√≠s"})]})]});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-2xl p-6 border transition-all",style:{backgroundColor:"var(--bg-secondary)",borderColor:a==="linked"?"rgba(37, 211, 102, 0.3)":"var(--border-color)"},children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center",style:{backgroundColor:a==="linked"?"rgba(37, 211, 102, 0.15)":"rgba(37, 211, 102, 0.1)",color:"#25D366"},children:e.jsx(M,{})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",style:{color:"var(--text-primary)"},children:"Bot de WhatsApp"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:a==="linked"?"Vinculado - Registr√° movimientos por mensaje":"Registr√° gastos e ingresos por mensaje"})]}),a==="linked"&&e.jsx("div",{className:"px-3 py-1 rounded-full text-sm font-medium",style:{backgroundColor:"rgba(37, 211, 102, 0.15)",color:"#25D366"},children:"Conectado"})]}),e.jsx(H,{}),r==="loading"&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"w-6 h-6 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:"var(--accent-primary)",borderTopColor:"transparent"}})}),r==="restricted"&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"p-4 rounded-xl mb-4 flex items-start gap-3",style:{backgroundColor:"rgba(251, 191, 36, 0.1)"},children:[e.jsx("span",{className:"text-xl",children:"üîí"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",style:{color:"var(--text-primary)"},children:"Acceso restringido"}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-secondary)"},children:"El bot de WhatsApp est√° en fase beta. Solicit√° acceso para probarlo."})]})]}),e.jsx("button",{onClick:z,disabled:_,className:"w-full py-3 px-4 rounded-xl font-medium transition-all flex items-center justify-center gap-2",style:{backgroundColor:"var(--accent-primary)",color:"white",opacity:_?.7:1},children:_?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Enviando solicitud..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Solicitar acceso"}),e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})]})})]}),r==="requested"&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"p-4 rounded-xl flex items-start gap-3",style:{backgroundColor:"rgba(34, 197, 94, 0.1)"},children:[e.jsx("span",{className:"text-xl",children:"‚úÖ"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",style:{color:"var(--text-primary)"},children:"Solicitud enviada"}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-secondary)"},children:"Te notificaremos cuando tu acceso est√© habilitado."})]})]})}),r==="enabled"&&a==="not_linked"&&e.jsx("div",{className:"mt-2",children:e.jsx("button",{onClick:p,disabled:w,className:"w-full py-3 px-4 rounded-xl font-medium transition-all flex items-center justify-center gap-2",style:{backgroundColor:"#25D366",color:"white",opacity:w?.7:1},children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Generando c√≥digo..."})]}):e.jsx("span",{children:"Vincular WhatsApp"})})}),r==="enabled"&&a==="code_generated"&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm mb-3",style:{color:"var(--text-secondary)"},children:"Envi√° este c√≥digo al bot de WhatsApp de Cash√©:"}),e.jsx("div",{className:"flex justify-center gap-2 mb-4",children:f==null?void 0:f.split("").map((c,u)=>e.jsx("span",{className:"w-12 h-14 rounded-xl flex items-center justify-center text-2xl font-bold",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--accent-primary)"},children:c},u))}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm mb-4",style:{color:"var(--text-secondary)"},children:[e.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:"#25D366",borderTopColor:"transparent"}}),e.jsx("span",{children:"Esperando verificaci√≥n..."})]}),U&&e.jsxs("p",{className:"text-xs text-center mb-4",style:{color:"var(--text-muted)"},children:["El c√≥digo expira en ",U]}),e.jsxs("a",{href:`https://wa.me/${R}?text=${encodeURIComponent(f||"")}`,target:"_blank",rel:"noopener noreferrer",className:"w-full py-3 px-4 rounded-xl font-medium transition-all flex items-center justify-center gap-2 mb-3",style:{backgroundColor:"#25D366",color:"white"},children:[e.jsx(M,{}),e.jsx("span",{children:"Abrir WhatsApp"})]}),e.jsx("button",{onClick:()=>{n("not_linked"),h(null),b(null)},className:"w-full py-2 px-4 rounded-xl text-sm transition-all",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"Cancelar"})]}),r==="enabled"&&a==="linked"&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"p-4 rounded-xl mb-4",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"N√∫mero vinculado"}),e.jsx("p",{className:"font-medium",style:{color:"var(--text-primary)"},children:ee(g)||g})]}),j&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Vinculado"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:new Date(j).toLocaleDateString("es-AR",{day:"numeric",month:"short",year:"numeric"})})]})]})}),e.jsxs("a",{href:`https://wa.me/${R}`,target:"_blank",rel:"noopener noreferrer",className:"w-full py-3 px-4 rounded-xl font-medium transition-all flex items-center justify-center gap-2 mb-3",style:{backgroundColor:"#25D366",color:"white"},children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),e.jsx("span",{children:"Abrir chat con el bot"})]}),e.jsx("button",{onClick:()=>k(!0),className:"w-full py-2 px-4 rounded-xl text-sm transition-all",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"Desvincular WhatsApp"})]})]}),e.jsx(G,{isOpen:T,onClose:()=>k(!1),onConfirm:W,title:"Desvincular WhatsApp",message:"¬øEst√°s seguro de que quer√©s desvincular tu WhatsApp? Ya no podr√°s registrar movimientos por mensaje.",confirmText:"Desvincular",variant:"warning",loading:w}),S&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>C(!1)}),e.jsxs("div",{className:"relative w-full max-w-sm rounded-2xl p-6 text-center animate-scale-in",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{backgroundColor:"rgba(34, 197, 94, 0.15)"},children:e.jsx("svg",{className:"w-8 h-8",style:{color:"#22c55e"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Solicitud enviada"}),e.jsx("p",{className:"text-sm mb-6",style:{color:"var(--text-secondary)"},children:"Tu solicitud de acceso al bot de WhatsApp fue enviada correctamente. Te notificaremos cuando est√© habilitado."}),e.jsx("button",{onClick:()=>C(!1),className:"w-full py-3 px-4 rounded-xl font-medium transition-all",style:{backgroundColor:"var(--accent-primary)",color:"white"},children:"Entendido"})]})]})]})}const B="CasheAppBot",D=async()=>{const{data:{user:s},error:r}=await m.auth.getUser();if(r)throw console.error("Error getting user:",r),new Error("Error getting authenticated user");if(!s)throw new Error("No authenticated user");return s.id},te=async()=>{const s=await D(),{data:r,error:t}=await m.from("telegram_users").select("*").eq("user_id",s).maybeSingle();if(t)throw console.error("Error getting Telegram status:",t),t;if(!r)return{status:"not_linked",telegramId:null,telegramUsername:null,telegramFirstName:null,verificationCode:null,linkedAt:null};if(r.verified)return{status:"linked",telegramId:r.telegram_id,telegramUsername:r.telegram_username,telegramFirstName:r.telegram_first_name,verificationCode:null,linkedAt:r.updated_at};const a=r.verification_expires_at&&new Date(r.verification_expires_at)<new Date;return{status:a?"code_expired":"pending_verification",telegramId:null,telegramUsername:null,telegramFirstName:null,verificationCode:a?null:r.verification_code,expiresAt:r.verification_expires_at,linkedAt:null}},ae=async()=>{const s=await D(),r=Math.floor(1e5+Math.random()*9e5).toString(),t=new Date(Date.now()+600*1e3).toISOString(),{data:a,error:n}=await m.from("telegram_users").upsert({user_id:s,telegram_id:null,verification_code:r,verification_expires_at:t,verified:!1,updated_at:new Date().toISOString()},{onConflict:"user_id",ignoreDuplicates:!1}).select().single();if(n)throw console.error("Error generating verification code:",n),n;return{code:r,expiresAt:t,expiresIn:600}},ne=async()=>{const s=await D(),{data:r,error:t}=await m.from("telegram_users").select("verified, telegram_id, telegram_username, telegram_first_name, updated_at").eq("user_id",s).maybeSingle();return t?(console.error("Error checking verification:",t),{verified:!1,telegramUsername:null}):r?{verified:r.verified===!0,telegramId:r.verified?r.telegram_id:null,telegramUsername:r.verified?r.telegram_username:null,telegramFirstName:r.verified?r.telegram_first_name:null,linkedAt:r.verified?r.updated_at:null}:{verified:!1,telegramUsername:null}},oe=async()=>{const s=await D(),{error:r}=await m.from("telegram_users").delete().eq("user_id",s);if(r)throw console.error("Error unlinking Telegram:",r),r;return{success:!0}},ie=s=>s?s.startsWith("@")?s:`@${s}`:null;function le(){const{showError:s}=$(),[r,t]=i.useState("loading"),[a,n]=i.useState(null),[l,x]=i.useState({telegramId:null,telegramUsername:null,telegramFirstName:null}),[f,h]=i.useState(null),[g,v]=i.useState(null),[j,y]=i.useState(!1),[d,b]=i.useState(!1);i.useEffect(()=>{w()},[]),i.useEffect(()=>{if(r==="code_generated"){const o=setInterval(async()=>{const p=await ne();p.verified&&(t("linked"),x({telegramId:p.telegramId,telegramUsername:p.telegramUsername,telegramFirstName:p.telegramFirstName}),h(p.linkedAt),n(null))},3e3);return()=>clearInterval(o)}},[r]),i.useEffect(()=>{if(!g||r!=="code_generated")return;const p=setInterval(()=>{new Date>new Date(g)&&(t("not_linked"),n(null),v(null))},1e3);return()=>clearInterval(p)},[g,r]);const w=async()=>{try{const o=await te();o.status==="linked"?(t("linked"),x({telegramId:o.telegramId,telegramUsername:o.telegramUsername,telegramFirstName:o.telegramFirstName}),h(o.linkedAt)):o.status==="pending_verification"&&o.verificationCode?(t("code_generated"),n(o.verificationCode),v(o.expiresAt)):t("not_linked")}catch(o){console.error("Error checking status:",o),t("not_linked")}},N=async()=>{y(!0);try{const o=await ae();n(o.code),v(o.expiresAt),t("code_generated")}catch(o){console.error("Error generating code:",o),s("Error al generar el c√≥digo. Por favor intent√° de nuevo.")}finally{y(!1)}},T=async()=>{y(!0);try{await oe(),t("not_linked"),x({telegramId:null,telegramUsername:null,telegramFirstName:null}),h(null),b(!1)}catch(o){console.error("Error unlinking Telegram:",o),s("Error al desvincular Telegram. Por favor intent√° de nuevo.")}finally{y(!1)}},k=i.useCallback(()=>{if(!g)return null;const o=new Date(g).getTime()-Date.now();if(o<=0)return null;const p=Math.floor(o/6e4),W=Math.floor(o%6e4/1e3);return`${p}:${W.toString().padStart(2,"0")}`},[g]),[S,C]=i.useState(null);i.useEffect(()=>{if(r!=="code_generated"){C(null);return}const o=()=>C(k());o();const p=setInterval(o,1e3);return()=>clearInterval(p)},[r,k]);const _=()=>e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-8 h-8",children:e.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})}),I=()=>e.jsxs("div",{className:"space-y-4 mb-4",children:[e.jsx("div",{className:"p-4 rounded-xl border",style:{backgroundColor:"rgba(0, 136, 204, 0.08)",borderColor:"rgba(0, 136, 204, 0.2)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:"rgba(0, 136, 204, 0.15)"},children:e.jsx("span",{className:"text-xl",children:"ü§ñ"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm mb-1",style:{color:"#0088cc"},children:"Con Inteligencia Artificial"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"Chate√° naturalmente como si hablaras con una persona. El bot entiende lenguaje natural en espa√±ol argentino."})]})]})}),e.jsxs("div",{className:"p-4 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("h4",{className:"font-medium text-sm mb-3",style:{color:"var(--text-primary)"},children:"Ejemplos de lo que pod√©s decir:"}),e.jsxs("div",{className:"space-y-2 text-sm",style:{color:"var(--text-secondary)"},children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("span",{children:"üí¨"}),e.jsx("code",{className:"text-xs",style:{color:"#0088cc"},children:'"Gast√© 500 en comida con galicia"'})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("span",{children:"üí¨"}),e.jsx("code",{className:"text-xs",style:{color:"#0088cc"},children:'"Cobr√© 50000 de sueldo en santander"'})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("span",{children:"üí¨"}),e.jsx("code",{className:"text-xs",style:{color:"#0088cc"},children:'"Transfer√≠ 10k de mp a brubank"'})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("span",{children:"üí¨"}),e.jsx("code",{className:"text-xs",style:{color:"#0088cc"},children:'"Cu√°nto gast√© en comida este mes?"'})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("span",{children:"üí¨"}),e.jsx("code",{className:"text-xs",style:{color:"#0088cc"},children:'"Saldo mercadopago"'})]})]})]}),e.jsxs("div",{className:"p-4 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("h4",{className:"font-medium text-sm mb-3",style:{color:"var(--text-primary)"},children:"Funcionalidades"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",style:{color:"var(--text-secondary)"},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{color:"#0088cc"},children:"üí∏"}),e.jsx("span",{children:"Gastos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{color:"#0088cc"},children:"üí∞"}),e.jsx("span",{children:"Ingresos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{color:"#0088cc"},children:"üîÑ"}),e.jsx("span",{children:"Transferencias"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{color:"#0088cc"},children:"üìä"}),e.jsx("span",{children:"Saldos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{color:"#0088cc"},children:"üìà"}),e.jsx("span",{children:"Resumen mensual"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{style:{color:"#0088cc"},children:"üïê"}),e.jsx("span",{children:"√öltimos movimientos"})]})]}),e.jsx("p",{className:"text-xs mt-3",style:{color:"var(--text-muted)"},children:"Tambi√©n pod√©s usar los botones del men√∫ si prefer√≠s"})]})]});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-2xl p-6 border transition-all",style:{backgroundColor:"var(--bg-secondary)",borderColor:r==="linked"?"rgba(0, 136, 204, 0.3)":"var(--border-color)"},children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center",style:{backgroundColor:r==="linked"?"rgba(0, 136, 204, 0.15)":"rgba(0, 136, 204, 0.1)",color:"#0088cc"},children:e.jsx(_,{})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",style:{color:"var(--text-primary)"},children:"Bot de Telegram"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:r==="linked"?"Vinculado - Registr√° movimientos por mensaje":"Registr√° gastos e ingresos por mensaje"})]}),r==="linked"&&e.jsx("div",{className:"px-3 py-1 rounded-full text-sm font-medium",style:{backgroundColor:"rgba(0, 136, 204, 0.15)",color:"#0088cc"},children:"Conectado"})]}),e.jsx(I,{}),r==="loading"&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"w-6 h-6 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:"var(--accent-primary)",borderTopColor:"transparent"}})}),r==="not_linked"&&e.jsx("div",{className:"mt-2",children:e.jsx("button",{onClick:N,disabled:j,className:"w-full py-3 px-4 rounded-xl font-medium transition-all flex items-center justify-center gap-2",style:{backgroundColor:"#0088cc",color:"white",opacity:j?.7:1},children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Generando c√≥digo..."})]}):e.jsx("span",{children:"Vincular Telegram"})})}),r==="code_generated"&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm mb-3 text-center",style:{color:"var(--text-secondary)"},children:"Copi√° el comando y pegalo en el chat del bot"}),e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl mb-4",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsxs("code",{className:"text-lg font-mono font-semibold",style:{color:"#0088cc"},children:["/start ",a]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`/start ${a}`);const o=document.getElementById("copy-btn-telegram");o&&(o.textContent="¬°Copiado!",setTimeout(()=>{o.textContent="Copiar"},2e3))},id:"copy-btn-telegram",className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-all",style:{backgroundColor:"#0088cc",color:"white"},children:"Copiar"})]}),e.jsxs("a",{href:`https://t.me/${B}`,target:"_blank",rel:"noopener noreferrer",className:"w-full py-3 px-4 rounded-xl font-medium transition-all flex items-center justify-center gap-2 mb-4",style:{backgroundColor:"#0088cc",color:"white"},children:[e.jsx(_,{}),e.jsx("span",{children:"Abrir chat en Telegram"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm mb-3",style:{color:"var(--text-secondary)"},children:[e.jsx("div",{className:"w-4 h-4 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:"#0088cc",borderTopColor:"transparent"}}),e.jsx("span",{children:"Esperando vinculaci√≥n..."})]}),S&&e.jsxs("p",{className:"text-xs text-center mb-4",style:{color:"var(--text-muted)"},children:["El c√≥digo expira en ",S]}),e.jsx("button",{onClick:()=>{t("not_linked"),n(null),v(null)},className:"w-full py-2 px-4 rounded-xl text-sm transition-all",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"Cancelar"})]}),r==="linked"&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"p-4 rounded-xl mb-4",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Cuenta vinculada"}),e.jsxs("p",{className:"font-medium",style:{color:"var(--text-primary)"},children:[l.telegramFirstName||"Usuario",l.telegramUsername&&e.jsxs("span",{style:{color:"var(--text-secondary)"},children:[" ","(",ie(l.telegramUsername),")"]})]})]}),f&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Vinculado"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:new Date(f).toLocaleDateString("es-AR",{day:"numeric",month:"short",year:"numeric"})})]})]})}),e.jsxs("a",{href:`https://t.me/${B}`,target:"_blank",rel:"noopener noreferrer",className:"w-full py-3 px-4 rounded-xl font-medium transition-all flex items-center justify-center gap-2 mb-3",style:{backgroundColor:"#0088cc",color:"white"},children:[e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-5 h-5",children:e.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})}),e.jsx("span",{children:"Abrir chat con el bot"})]}),e.jsx("button",{onClick:()=>b(!0),className:"w-full py-2 px-4 rounded-xl text-sm transition-all",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"Desvincular Telegram"})]})]}),e.jsx(G,{isOpen:d,onClose:()=>b(!1),onConfirm:T,title:"Desvincular Telegram",message:"¬øEst√°s seguro de que quer√©s desvincular tu Telegram? Ya no podr√°s registrar movimientos por mensaje.",confirmText:"Desvincular",variant:"warning",loading:j})]})}const P=()=>"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window,O=()=>"Notification"in window?Notification.permission:"unsupported",ce=async()=>{if(!("Notification"in window))throw new Error("Notifications not supported");return await Notification.requestPermission()},E=(s,r,t)=>Promise.race([s,new Promise((a,n)=>setTimeout(()=>n(new Error(t)),r))]),F=()=>window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",de=async s=>{if(!P())throw new Error("Push notifications not supported");if((await navigator.serviceWorker.getRegistrations()).length===0)throw F()?new Error("Las notificaciones push no funcionan en modo desarrollo. Prob√° con el build de producci√≥n (npm run build && npm run preview)."):new Error("Service Worker no est√° registrado. Recarg√° la p√°gina e intent√° de nuevo.");if(await E(ce(),3e4,"El navegador no respondi√≥ a la solicitud de permisos")!=="granted")throw new Error("Permiso de notificaciones denegado");let a;try{a=await E(navigator.serviceWorker.ready,1e4,"Service Worker no est√° disponible"),await new Promise(l=>setTimeout(l,500))}catch(l){throw console.error("SW registration error:",l),F()?new Error("Las notificaciones push solo funcionan en producci√≥n"):new Error("No se pudo conectar con el Service Worker. Recarg√° la p√°gina.")}let n;try{n=await E(a.pushManager.getSubscription(),5e3,"No se pudo verificar la suscripci√≥n existente")}catch(l){console.warn("Error checking existing subscription:",l),n=null}if(!n){const l=he(s);try{n=await E(a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:l}),15e3,"El navegador no pudo completar la suscripci√≥n. Esto puede ocurrir en navegadores con bloqueo de rastreadores activo (como Brave). Prob√° desactivar Shields o us√° Chrome/Firefox.")}catch(x){throw console.error("Push subscription error:",x),x.message.includes("push service")||x.message.includes("Registration failed")?navigator.brave&&navigator.brave.isBrave||navigator.userAgent.includes("Brave")?new Error('Brave bloquea las push notifications por privacidad. And√° a brave://settings/privacy y activ√° "Use Google services for push messaging", o us√° Chrome/Firefox.'):new Error("Tu navegador bloque√≥ las notificaciones push. Verific√° la configuraci√≥n de privacidad del navegador."):x}}try{await E(me(n),1e4,"No se pudo guardar la suscripci√≥n en el servidor")}catch(l){console.error("Error saving subscription:",l);try{await n.unsubscribe()}catch{}throw l}return n},ue=async()=>{if(!P())return;const r=await(await navigator.serviceWorker.ready).pushManager.getSubscription();r&&(await xe(r.endpoint),await r.unsubscribe())},me=async s=>{const{data:{user:r}}=await m.auth.getUser();if(!r)throw new Error("Not authenticated");const t=s.toJSON(),{error:a}=await m.from("push_subscriptions").upsert({user_id:r.id,endpoint:t.endpoint,p256dh:t.keys.p256dh,auth:t.keys.auth},{onConflict:"user_id,endpoint"});if(a)throw a},xe=async s=>{const{data:{user:r}}=await m.auth.getUser();r&&await m.from("push_subscriptions").delete().eq("user_id",r.id).eq("endpoint",s)},pe=async()=>{if(!P())return{supported:!1,subscribed:!1};const s=O();if(s==="denied")return{supported:!0,subscribed:!1,permission:"denied"};try{return(await navigator.serviceWorker.getRegistrations()).length===0?{supported:!0,subscribed:!1,permission:s,noSW:!0}:{supported:!0,subscribed:!!await(await Promise.race([navigator.serviceWorker.ready,new Promise((n,l)=>setTimeout(()=>l(new Error("SW timeout")),1e4))])).pushManager.getSubscription(),permission:s}}catch(r){return console.warn("Service worker not ready:",r),{supported:!0,subscribed:!1,permission:s}}};function he(s){const r="=".repeat((4-s.length%4)%4),t=(s+r).replace(/-/g,"+").replace(/_/g,"/"),a=window.atob(t),n=new Uint8Array(a.length);for(let l=0;l<a.length;++l)n[l]=a.charCodeAt(l);return n}const V=async(s,r={})=>{if(O()!=="granted")throw new Error("Notification permission not granted");await(await navigator.serviceWorker.ready).showNotification(s,{icon:"/icons/icon-192.png",badge:"/icons/icon-96.png",...r})},ge="BGAtLxt4YDMsBi4kHWTDoGusF-x1-qGY3YF6TqYzr_JOMbcVUJ2sh9cjOMHty3v6_B5F5QabzpMmFqPDjSGQRCU";function fe(){const[s,r]=i.useState({supported:!1,subscribed:!1,permission:"default",loading:!0}),[t,a]=i.useState(null),[n,l]=i.useState(!1);i.useEffect(()=>{x()},[]);const x=async()=>{try{const d=await pe();r({...d,loading:!1})}catch(d){console.error("Error checking push status:",d),r(b=>({...b,loading:!1}))}},f=async()=>{l(!0),a(null);try{await de(ge),await x(),await V("Notificaciones activadas",{body:"Recibir√°s alertas de transacciones programadas",tag:"subscription-success"})}catch(d){console.error("Error subscribing:",d),a(d.message||"No se pudieron activar las notificaciones")}finally{l(!1)}},h=async()=>{l(!0),a(null);try{await ue(),await x()}catch(d){console.error("Error unsubscribing:",d),a(d.message||"No se pudieron desactivar las notificaciones")}finally{l(!1)}},g=async()=>{try{await V("Notificaci√≥n de prueba",{body:"Las notificaciones funcionan correctamente",tag:"test-notification"})}catch{a("No se pudo enviar la notificaci√≥n de prueba")}},v=/iPad|iPhone|iPod/.test(navigator.userAgent),j=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0,y=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";return!s.supported&&!s.loading?e.jsx("div",{className:"rounded-2xl p-6",style:{backgroundColor:"var(--bg-secondary)"},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center flex-shrink-0",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",style:{color:"var(--text-muted)"},children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",style:{color:"var(--text-primary)"},children:"Notificaciones Push"}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-muted)"},children:v&&!j?"Para activar notificaciones en iOS, instal√° la app: Compartir ‚Üí Agregar a pantalla de inicio":"Tu navegador no soporta notificaciones push"})]})]})}):s.permission==="denied"?e.jsx("div",{className:"rounded-2xl p-6",style:{backgroundColor:"var(--bg-secondary)"},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center flex-shrink-0",style:{backgroundColor:"var(--accent-red-dim)"},children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",style:{color:"var(--accent-red)"},children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",style:{color:"var(--text-primary)"},children:"Notificaciones Push"}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-secondary)"},children:"Las notificaciones est√°n bloqueadas. Para activarlas, debes cambiar los permisos en la configuraci√≥n de tu navegador."})]})]})}):e.jsx("div",{className:"rounded-2xl p-6",style:{backgroundColor:"var(--bg-secondary)"},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center flex-shrink-0",style:{backgroundColor:s.subscribed?"var(--accent-green-dim)":"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",style:{color:s.subscribed?"var(--accent-green)":"var(--accent-primary)"},children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold",style:{color:"var(--text-primary)"},children:"Notificaciones Push"}),s.subscribed&&e.jsx("span",{className:"px-2 py-1 rounded-lg text-xs font-medium",style:{backgroundColor:"var(--accent-green-dim)",color:"var(--accent-green)"},children:"Activadas"})]}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-secondary)"},children:s.subscribed?"Recibir√°s notificaciones cuando tengas transacciones programadas pendientes de aprobaci√≥n.":"Activa las notificaciones para recibir alertas de transacciones programadas."}),t&&e.jsx("p",{className:"text-sm mt-2",style:{color:"var(--accent-red)"},children:t}),e.jsx("div",{className:"flex gap-2 mt-4",children:s.subscribed?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:g,className:"px-4 py-2 rounded-xl text-sm font-medium transition-colors",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"Probar"}),e.jsx("button",{onClick:h,disabled:n,className:"px-4 py-2 rounded-xl text-sm font-medium transition-colors disabled:opacity-50",style:{backgroundColor:"var(--accent-red-dim)",color:"var(--accent-red)"},children:n?"Desactivando...":"Desactivar"})]}):e.jsx("button",{onClick:f,disabled:n||s.loading,className:"px-4 py-2 rounded-xl text-sm font-medium transition-colors disabled:opacity-50",style:{backgroundColor:"var(--accent-primary)",color:"white"},children:n?"Activando...":"Activar notificaciones"})}),!s.subscribed&&e.jsx("p",{className:"text-xs mt-3",style:{color:"var(--text-muted)"},children:y?'Nota: Las notificaciones push solo funcionan en producci√≥n. Us√° "npm run build && npm run preview" para probar.':"Se te pedir√° permiso para enviar notificaciones. Puedes desactivarlas en cualquier momento."})]})]})})}function ye(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-medium",style:{color:"var(--text-primary)"},children:"Integraciones"}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-secondary)"},children:"Conect√° servicios externos para gestionar tus finanzas"})]}),e.jsx("div",{className:"rounded-2xl p-5 border",style:{background:"linear-gradient(135deg, rgba(20, 184, 166, 0.1) 0%, rgba(59, 130, 246, 0.1) 100%)",borderColor:"rgba(20, 184, 166, 0.2)"},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0",style:{backgroundColor:"rgba(20, 184, 166, 0.2)"},children:e.jsx("span",{className:"text-2xl",children:"ü§ñ"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-1",style:{color:"var(--text-primary)"},children:"Bots con Inteligencia Artificial"}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:["Nuestros bots de Telegram y WhatsApp entienden ",e.jsx("strong",{children:"lenguaje natural"}),". Escrib√≠ como si chatearas con un amigo: ",e.jsx("em",{children:'"gast√© 500 en el super con mp"'})," y el bot lo entiende autom√°ticamente."]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs",style:{backgroundColor:"rgba(20, 184, 166, 0.15)",color:"var(--accent-primary)"},children:[e.jsx("span",{children:"‚ú®"})," Espa√±ol argentino"]}),e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs",style:{backgroundColor:"rgba(20, 184, 166, 0.15)",color:"var(--accent-primary)"},children:[e.jsx("span",{children:"üéØ"})," Entiende aliases (mp, gal, bru)"]}),e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs",style:{backgroundColor:"rgba(20, 184, 166, 0.15)",color:"var(--accent-primary)"},children:[e.jsx("span",{children:"‚úÖ"})," Confirmaci√≥n antes de guardar"]})]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(fe,{}),e.jsx(le,{}),e.jsx(se,{}),e.jsx("div",{className:"rounded-2xl p-6 border border-dashed",style:{backgroundColor:"var(--bg-secondary)",borderColor:"var(--border-color)",opacity:.6},children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl flex items-center justify-center",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",style:{color:"var(--text-muted)"},children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",style:{color:"var(--text-muted)"},children:"M√°s integraciones pr√≥ximamente"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Importaci√≥n de extractos bancarios y m√°s"})]})]})})]})]})}export{ye as default};
