import{r as i,j as e,f as L,u as ie,i as pe,a as he,b as Y,e as ge,c as ke,d as q,g as ve,h as Ce,k as Se,l as De,m as Me,n as Ee,o as de,s as me,p as Ae,q as fe,t as Le,v as Re,w as Be,L as xe,E as Ie,x as ye,y as Pe,z as $e,D as G,A as ae,B as Te,C as We}from"./index-Bs2UX6zf.js";import{D as je}from"./DateRangePicker-CtSqGaQp.js";import{A as Ve}from"./AccountModal-DwAZtxQt.js";import{P as Oe}from"./PullToRefresh-CcARqsTM.js";import"./IconPicker-C--J0SDq.js";const Ue={oficial:"Oficial",blue:"Blue",bolsa:"MEP",contadoconliqui:"CCL"};function _e({accounts:v=[],dashboard:h,currency:m="ARS",onCurrencyChange:u,accountFilters:o=[],onAccountFiltersChange:f}){const[d,M]=i.useState(!1),s=i.useMemo(()=>{const r=v.filter(t=>!t.ocultaDelBalance),n=o.length>0?r.filter(t=>o.includes(t.nombre)):r,l=(h==null?void 0:h.tipoCambio)||1e3,S=n.filter(t=>t.moneda==="Peso").reduce((t,a)=>t+(a.balanceActual||0),0),B=n.filter(t=>t.moneda==="D√≥lar").reduce((t,a)=>t+(a.balanceActual||0),0),U=S+B*l,x=B+S/l;return{totalPesos:S,totalDolares:B,totalGeneralPesos:U,totalGeneralDolares:x,tipoCambio:l,filteredAccounts:n}},[v,o,h]),j=m==="ARS"?s.totalGeneralPesos:s.totalGeneralDolares,y=o.length>0?o.length:0,g=r=>{if(f)if(o.length===0)f([r]);else if(o.includes(r)){const n=o.filter(l=>l!==r);f(n)}else f([...o,r])},C=r=>o.length===0||o.includes(r),b=v.filter(r=>!r.ocultaDelBalance),E=()=>{if(!f)return;const r=b.map(l=>l.nombre),n=r.length>0&&r.every(l=>o.includes(l));f(n?[]:r)},R=()=>{f&&f([])};return e.jsxs("div",{className:"p-3 sm:p-4 rounded-lg min-[400px]:rounded-xl overflow-hidden",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex flex-col min-[400px]:flex-row min-[400px]:items-center min-[400px]:justify-between gap-2 mb-2 sm:mb-3 min-w-0",children:[e.jsx("span",{className:"text-xs flex-shrink-0",style:{color:"var(--text-muted)"},children:"Saldo actual"}),e.jsxs("div",{className:"inline-flex p-0.5 rounded-lg self-start min-[400px]:self-auto flex-shrink-0",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsxs("button",{onClick:()=>u==null?void 0:u("ARS"),className:"px-2 sm:px-2.5 py-1.5 rounded-md text-xs font-medium transition-colors duration-150 flex items-center gap-1",style:{backgroundColor:m==="ARS"?"var(--bg-elevated)":"transparent",color:m==="ARS"?"var(--text-primary)":"var(--text-muted)"},children:[e.jsx("img",{src:"/icons/catalog/ARS.svg",alt:"ARS",className:"w-4 h-4 rounded-sm"}),"ARS"]}),e.jsxs("button",{onClick:()=>u==null?void 0:u("USD"),className:"px-2 sm:px-2.5 py-1.5 rounded-md text-xs font-medium transition-colors duration-150 flex items-center gap-1",style:{backgroundColor:m==="USD"?"var(--bg-elevated)":"transparent",color:m==="USD"?"var(--text-primary)":"var(--text-muted)"},children:[e.jsx("img",{src:"/icons/catalog/USD.svg",alt:"USD",className:"w-4 h-4 rounded-sm"}),"USD"]})]})]}),e.jsx("h2",{className:"text-2xl sm:text-3xl font-semibold tracking-tight mb-3 sm:mb-4 truncate",style:{color:"var(--text-primary)"},children:L(j,m)}),e.jsxs("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 gap-2 sm:gap-3 mb-3",children:[e.jsxs("div",{className:"p-2.5 sm:p-3 rounded-md min-[400px]:rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("p",{className:"text-[10px] sm:text-[11px] uppercase tracking-wide mb-1",style:{color:"var(--text-muted)"},children:"En pesos"}),e.jsx("p",{className:"text-sm sm:text-base font-medium truncate",style:{color:"var(--text-primary)"},children:L(s.totalPesos,"ARS")})]}),e.jsxs("div",{className:"p-2.5 sm:p-3 rounded-md min-[400px]:rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("p",{className:"text-[10px] sm:text-[11px] uppercase tracking-wide mb-1",style:{color:"var(--text-muted)"},children:"En d√≥lares"}),e.jsx("p",{className:"text-sm sm:text-base font-medium truncate",style:{color:"var(--text-primary)"},children:L(s.totalDolares,"USD")})]})]}),s.tipoCambio&&e.jsxs("div",{className:"flex flex-col min-[400px]:flex-row min-[400px]:items-center min-[400px]:justify-between gap-1 min-[400px]:gap-2 py-2 min-w-0",style:{borderTop:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink min-w-0",children:[e.jsx("span",{className:"text-xs whitespace-nowrap",style:{color:"var(--text-muted)"},children:"Tipo de cambio"}),(h==null?void 0:h.tipoUsado)&&e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium flex-shrink-0",style:{backgroundColor:"var(--accent-primary-dim)",color:"var(--accent-primary)"},children:Ue[h.tipoUsado]||h.tipoUsado})]}),e.jsxs("span",{className:"text-sm min-[400px]:text-xs font-medium whitespace-nowrap flex-shrink-0",style:{color:"var(--text-secondary)"},children:[L(s.tipoCambio)," / USD"]})]}),e.jsxs("div",{className:"mt-3 pt-3",style:{borderTop:"1px solid var(--border-subtle)"},children:[e.jsxs("button",{onClick:()=>M(!d),className:"w-full flex items-center justify-between gap-2 px-3 py-2.5 rounded-md min-[400px]:rounded-lg text-sm transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.99]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),e.jsx("span",{className:"font-medium",children:"Filtrar cuentas"}),y>0&&e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-bold",style:{backgroundColor:"var(--accent-primary)",color:"white"},children:y})]}),e.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${d?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),d&&e.jsxs("div",{className:"mt-2 p-3 rounded-md min-[400px]:rounded-lg space-y-2 animate-scale-in",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-xs font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"Cuentas incluidas"}),e.jsx("button",{onClick:E,className:"text-xs font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:b.length>0&&b.every(r=>o.includes(r.nombre))?"Deseleccionar":"Seleccionar todos"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-28 overflow-y-auto custom-scrollbar",children:b.map(r=>{const n=C(r.nombre);return e.jsx("button",{onClick:()=>g(r.nombre),className:"px-3 py-2 rounded-md min-[400px]:rounded-lg text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:n?"var(--accent-primary)":"var(--bg-secondary)",color:n?"white":"var(--text-secondary)",boxShadow:n?"0 2px 8px var(--accent-primary-glow)":"none",opacity:o.length===0?.7:1},children:r.nombre},r.nombre)})}),y>0&&e.jsxs("button",{onClick:R,className:"text-xs font-semibold flex items-center gap-1 transition-all duration-200 hover:opacity-80 mt-2",style:{color:"var(--accent-primary)"},children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Mostrar todas"]})]})]})]})}function He({accounts:v=[],dashboard:h,currency:m="ARS",dateRange:u,onDateRangeChange:o,accountFilters:f=[]}){const d=i.useMemo(()=>{const C=v.filter(r=>!r.ocultaDelBalance),b=f.length>0?C.filter(r=>f.includes(r.nombre)):C,E=b.reduce((r,n)=>r+(n.totalIngresos||0),0),R=b.reduce((r,n)=>r+(n.totalGastos||0),0);return{ingresos:E,gastos:R,flujoNeto:E-Math.abs(R)}},[v,f]),{ingresos:M,gastos:s,flujoNeto:j}=d,y=Math.abs(M)+Math.abs(s),g=y>0?Math.abs(M)/y*100:50;return e.jsxs("div",{className:"p-3 sm:p-4 rounded-lg min-[400px]:rounded-xl overflow-hidden",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex flex-col min-[400px]:flex-row min-[400px]:items-center min-[400px]:justify-between gap-2 mb-2 sm:mb-3",children:[e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Flujo del per√≠odo"}),e.jsx("div",{className:"self-start min-[400px]:self-auto",children:e.jsx(je,{value:u,onChange:o,defaultPreset:"Este mes"})})]}),e.jsx("div",{className:"mb-3 sm:mb-4",children:e.jsxs("div",{className:"h-2 rounded-full overflow-hidden flex",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${g}%`,backgroundColor:"var(--accent-green)"}}),e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${100-g}%`,backgroundColor:"var(--accent-red)"}})]})}),e.jsxs("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 gap-2 sm:gap-3 mb-3",children:[e.jsxs("div",{className:"p-2.5 sm:p-3 rounded-md min-[400px]:rounded-lg",style:{backgroundColor:"var(--accent-green-dim)"},children:[e.jsx("p",{className:"text-[10px] sm:text-[11px] uppercase tracking-wide mb-1",style:{color:"var(--text-muted)"},children:"Ingresos"}),e.jsxs("p",{className:"text-sm sm:text-base font-semibold truncate",style:{color:"var(--accent-green)"},children:["+",L(Math.abs(M),m)]})]}),e.jsxs("div",{className:"p-2.5 sm:p-3 rounded-md min-[400px]:rounded-lg",style:{backgroundColor:"var(--accent-red-dim)"},children:[e.jsx("p",{className:"text-[10px] sm:text-[11px] uppercase tracking-wide mb-1",style:{color:"var(--text-muted)"},children:"Gastos"}),e.jsxs("p",{className:"text-sm sm:text-base font-semibold truncate",style:{color:"var(--accent-red)"},children:["-",L(Math.abs(s),m)]})]})]}),e.jsxs("div",{className:"p-2.5 sm:p-3 rounded-md min-[400px]:rounded-lg",style:{backgroundColor:j>=0?"var(--accent-green-dim)":"var(--accent-red-dim)",border:`1px solid ${j>=0?"var(--accent-green)":"var(--accent-red)"}20`},children:[e.jsx("p",{className:"text-[10px] sm:text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Flujo neto"}),e.jsxs("p",{className:"text-base sm:text-lg font-bold truncate",style:{color:j>=0?"var(--accent-green)":"var(--accent-red)"},children:[j>=0?"+":"",L(j,m)]})]}),f.length>0&&e.jsxs("p",{className:"text-[10px] mt-2 text-center",style:{color:"var(--text-muted)"},children:["Mostrando flujo de ",f.length," cuenta",f.length!==1?"s":""," seleccionada",f.length!==1?"s":""]})]})}function ze({accounts:v,loading:h,onAccountClick:m}){const[u,o]=i.useState(!0),f=ie(),d=(v||[]).filter(s=>!s.ocultaDelBalance);if(h)return e.jsx("div",{className:"card-glass overflow-hidden",children:e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsx("div",{className:"h-4 w-24 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-4 w-16 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}})]})});if(!d||d.length===0)return null;const M=s=>{m&&m(s)};return e.jsxs("div",{className:"card-glass overflow-hidden transition-all duration-300 rounded-lg min-[400px]:rounded-xl",children:[e.jsxs("button",{onClick:()=>o(!u),className:"w-full px-3 py-3 sm:p-4 flex flex-col min-[400px]:flex-row min-[400px]:items-center min-[400px]:justify-between gap-2 text-left transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.99]",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-9 sm:h-9 rounded-lg sm:rounded-xl flex items-center justify-center",style:{backgroundColor:"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm sm:text-[15px]",style:{color:"var(--text-primary)"},children:"Cuentas"}),e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full font-medium",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:d.length})]})]}),e.jsxs("div",{className:"flex items-center gap-2 self-end min-[400px]:self-auto",children:[e.jsx("span",{className:"text-xs font-medium",style:{color:"var(--text-secondary)"},children:u?"Ocultar":"Ver todas"}),e.jsx("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center transition-colors",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${u?"rotate-180":""}`,style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),u&&e.jsxs("div",{className:"animate-scale-in",style:{borderTop:"1px solid var(--border-subtle)"},children:[e.jsx("div",{className:"hidden lg:grid lg:grid-cols-2 xl:grid-cols-3 gap-px",style:{backgroundColor:"var(--border-subtle)"},children:d.map((s,j)=>{const y=s.moneda==="Peso",g=s.esTarjetaCredito,C=g?"#a855f7":y?"#75AADB":"#3CB371",b=!!s.icon,E=b&&pe(s.icon);return e.jsxs("button",{onClick:()=>M(s),className:"p-4 flex items-center gap-3 text-left transition-all duration-200 hover:bg-[var(--bg-tertiary)] group",style:{backgroundColor:"var(--bg-secondary)",animationDelay:`${j*50}ms`},children:[e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center flex-shrink-0 transition-transform duration-200 group-hover:scale-110 overflow-hidden",style:{backgroundColor:b&&!E?"transparent":`${C}15`,boxShadow:`0 0 20px ${C}10`},children:b?E?e.jsx("span",{className:"text-xl",children:s.icon}):e.jsx("img",{src:he(s.icon),alt:s.nombre,className:"w-full h-full object-cover rounded-xl"}):e.jsx("span",{className:"text-sm font-bold",style:{color:C},children:g?"üí≥":y?"$":"US$"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold truncate text-[15px]",style:{color:"var(--text-primary)"},children:s.nombre}),e.jsx("p",{className:"text-[11px] mt-0.5",style:{color:"var(--text-secondary)"},children:g?"Pr√≥ximo resumen":e.jsxs(e.Fragment,{children:[y?"Pesos":"D√≥lares",s.tipo&&` ¬∑ ${s.tipo}`]})})]}),e.jsx("div",{className:"text-right flex-shrink-0",children:g?e.jsxs("div",{className:"flex flex-col items-end gap-0.5",children:[s.proximoResumenPesos>0&&e.jsxs("p",{className:"font-bold text-[14px]",style:{color:"var(--accent-red)"},children:["-",L(s.proximoResumenPesos,"ARS")]}),s.proximoResumenDolares>0&&e.jsxs("p",{className:"font-bold text-[14px]",style:{color:"#3CB371"},children:["-",L(s.proximoResumenDolares,"USD")]}),s.proximoResumenPesos===0&&s.proximoResumenDolares===0&&e.jsx("p",{className:"font-bold text-[14px]",style:{color:"var(--text-muted)"},children:"$0"})]}):e.jsx("p",{className:"font-bold text-[15px]",style:{color:C},children:L(s.balanceActual,y?"ARS":"USD")})})]},s.nombre)})}),e.jsx("div",{className:"lg:hidden overflow-hidden",children:d.map((s,j)=>{const y=s.moneda==="Peso",g=s.esTarjetaCredito,C=g?"#a855f7":y?"#75AADB":"#3CB371",b=!!s.icon,E=b&&pe(s.icon);return e.jsxs("button",{onClick:()=>M(s),className:"w-full px-3 py-2.5 flex flex-col min-[400px]:flex-row min-[400px]:items-center gap-2 text-left transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.99] group",style:{borderBottom:j<d.length-1?"1px solid var(--border-subtle)":"none"},children:[e.jsxs("div",{className:"flex items-center gap-2.5 min-w-0 flex-1",children:[e.jsx("div",{className:"w-8 h-8 rounded-md min-[400px]:rounded-lg flex items-center justify-center flex-shrink-0 overflow-hidden",style:{backgroundColor:b&&!E?"transparent":`${C}15`},children:b?E?e.jsx("span",{className:"text-lg",children:s.icon}):e.jsx("img",{src:he(s.icon),alt:s.nombre,className:"w-full h-full object-cover rounded-md min-[400px]:rounded-lg"}):e.jsx("span",{className:"text-[11px] font-bold",style:{color:C},children:g?"üí≥":y?"$":"US$"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm leading-tight",style:{color:"var(--text-primary)",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:s.nombre}),e.jsx("p",{className:"text-[11px] mt-0.5",style:{color:"var(--text-secondary)"},children:g?"Pr√≥ximo resumen":y?"Pesos":"D√≥lares"})]})]}),e.jsx("div",{className:"text-left min-[400px]:text-right flex-shrink-0 pl-10 min-[400px]:pl-0",children:g?e.jsxs("div",{className:"flex flex-col min-[400px]:items-end gap-0.5",children:[s.proximoResumenPesos>0&&e.jsxs("p",{className:"font-bold text-sm",style:{color:"var(--accent-red)"},children:["-",L(s.proximoResumenPesos,"ARS")]}),s.proximoResumenDolares>0&&e.jsxs("p",{className:"font-bold text-sm",style:{color:"#3CB371"},children:["-",L(s.proximoResumenDolares,"USD")]}),s.proximoResumenPesos===0&&s.proximoResumenDolares===0&&e.jsx("p",{className:"font-bold text-sm",style:{color:"var(--text-muted)"},children:"$0"})]}):e.jsx("p",{className:"font-bold text-sm",style:{color:C},children:L(s.balanceActual,y?"ARS":"USD")})})]},s.nombre)})}),e.jsx("button",{onClick:()=>f("/cuentas"),className:"w-full py-3 sm:p-3.5 text-center text-sm font-semibold transition-all duration-200 hover:bg-[var(--accent-primary-dim)] active:scale-[0.99]",style:{color:"var(--accent-primary)",borderTop:"1px solid var(--border-subtle)"},children:"Ver detalles de cuentas ‚Üí"})]})]})}function Ge({movements:v,accounts:h=[],categories:m={ingresos:[],gastos:[]},loading:u}){var n,l,S,B,U;const[o,f]=i.useState("ARS"),[d,M]=i.useState(!1),[s,j]=i.useState(()=>{try{const x=localStorage.getItem("cashe_weekly_filters");if(x)return JSON.parse(x)}catch(x){console.warn("Error loading weekly filters:",x)}return{cuentas:[],categorias:[]}});i.useEffect(()=>{try{localStorage.setItem("cashe_weekly_filters",JSON.stringify(s))}catch(x){console.warn("Error saving weekly filters:",x)}},[s]);const y=m.gastos||[],g=(h||[]).filter(x=>!x.ocultaDelBalance),C=[((n=s.cuentas)==null?void 0:n.length)>0,((l=s.categorias)==null?void 0:l.length)>0].filter(Boolean).length,b=i.useMemo(()=>{var O,z;if(!v||v.length===0)return null;const x=g.map(p=>p.nombre),t=v.filter(p=>x.includes(p.cuenta));let a=t.filter(p=>p.tipo==="gasto"),k=t.filter(p=>p.tipo==="ingreso");((O=s.cuentas)==null?void 0:O.length)>0&&(a=a.filter(p=>s.cuentas.includes(p.cuenta)),k=k.filter(p=>s.cuentas.includes(p.cuenta))),((z=s.categorias)==null?void 0:z.length)>0&&(a=a.filter(p=>s.categorias.includes(p.categoria)));const $=a.reduce((p,D)=>p+(D.montoPesos||D.monto||0),0),V=a.reduce((p,D)=>p+(D.montoDolares||0),0),_=k.reduce((p,D)=>p+(D.montoPesos||D.monto||0),0),F=k.reduce((p,D)=>p+(D.montoDolares||0),0),K=$/7,X=V/7,Q=_/7,H=F/7,N=new Set(a.map(p=>p.fecha)).size,A=p=>{if(/^\d{4}-\d{2}-\d{2}$/.test(p)){const[D,te,ce]=p.split("-").map(Number),oe=new Date(D,te-1,ce);return Y(oe,"EEEE",{locale:ge})}return Y(new Date(p),"EEEE",{locale:ge})},I={};a.forEach(p=>{const D=p.fecha,te=A(p.fecha);I[D]||(I[D]={name:te,amount:0,amountDolares:0,date:D}),I[D].amount+=p.montoPesos||p.monto||0,I[D].amountDolares+=p.montoDolares||0});const J=Object.values(I).sort((p,D)=>D.amount-p.amount)[0]||null,W={};a.forEach(p=>{const D=p.categoria||"Sin categor√≠a";W[D]||(W[D]={name:D,amount:0,amountDolares:0}),W[D].amount+=p.montoPesos||p.monto||0,W[D].amountDolares+=p.montoDolares||0});const ee=Object.values(W).sort((p,D)=>D.amount-p.amount)[0]||null;return{avgDailyExpense:K,avgDailyExpenseDolares:X,avgDailyIncome:Q,avgDailyIncomeDolares:H,maxDay:J,topCategory:ee,totalExpenses:$,totalExpensesDolares:V,totalIncome:_,totalIncomeDolares:F,daysWithExpenses:N}},[v,s,g]),E=(x,t)=>{const a=s[x]||[];let k;a.includes(t)?k=a.filter($=>$!==t):k=[...a,t],j($=>({...$,[x]:k}))},R=(x,t)=>(s[x]||[]).includes(t),r=()=>{j({cuentas:[],categorias:[]})};return u?e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-md min-[400px]:rounded-lg skeleton-shimmer",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-4 w-28 skeleton-shimmer rounded-md min-[400px]:rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}})]}),e.jsx("div",{className:"card-glass p-3 sm:p-4 rounded-lg min-[400px]:rounded-xl",children:e.jsx("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3",children:[1,2,3].map(x=>e.jsxs("div",{className:"space-y-2 p-2.5",children:[e.jsx("div",{className:"h-3 w-20 skeleton-shimmer rounded-md",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-5 w-24 skeleton-shimmer rounded-md",style:{backgroundColor:"var(--bg-tertiary)"}})]},x))})})]}):e.jsxs("div",{className:"space-y-2 sm:space-y-3 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col min-[400px]:flex-row min-[400px]:items-center min-[400px]:justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h3",{className:"text-sm sm:text-[15px] font-semibold",style:{color:"var(--text-primary)"},children:"Resumen semanal"})]}),e.jsxs("div",{className:"inline-flex rounded-lg p-0.5 self-start min-[400px]:self-auto",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsxs("button",{onClick:()=>f("ARS"),className:"px-2.5 py-1.5 rounded-md text-xs font-medium transition-colors duration-150 flex items-center gap-1.5",style:{backgroundColor:o==="ARS"?"var(--bg-elevated)":"transparent",color:o==="ARS"?"var(--text-primary)":"var(--text-muted)"},children:[e.jsx("img",{src:"/icons/catalog/ARS.svg",alt:"ARS",className:"w-4 h-4 rounded-sm"}),"ARS"]}),e.jsxs("button",{onClick:()=>f("USD"),className:"px-2.5 py-1.5 rounded-md text-xs font-medium transition-colors duration-150 flex items-center gap-1.5",style:{backgroundColor:o==="USD"?"var(--bg-elevated)":"transparent",color:o==="USD"?"var(--text-primary)":"var(--text-muted)"},children:[e.jsx("img",{src:"/icons/catalog/USD.svg",alt:"USD",className:"w-4 h-4 rounded-sm"}),"USD"]})]})]}),e.jsxs("button",{onClick:()=>M(!d),className:"flex items-center gap-2 px-3.5 py-2.5 rounded-lg min-[400px]:rounded-xl text-sm transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.98]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),e.jsx("span",{className:"font-medium",children:"Filtros"}),C>0&&e.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold",style:{backgroundColor:"var(--accent-primary)",color:"white",boxShadow:"0 2px 8px var(--accent-primary-glow)"},children:C}),e.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${d?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),d&&e.jsxs("div",{className:"p-4 rounded-lg min-[400px]:rounded-xl space-y-4 animate-scale-in card-glass",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"Cuentas"}),e.jsx("button",{onClick:()=>{const x=h.map(a=>a.nombre),t=x.length>0&&x.every(a=>{var k;return(k=s.cuentas)==null?void 0:k.includes(a)});j(a=>({...a,cuentas:t?[]:x}))},className:"text-[10px] font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:h.length>0&&h.every(x=>{var t;return(t=s.cuentas)==null?void 0:t.includes(x.nombre)})?"Deseleccionar todos":"Seleccionar todos"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-28 overflow-y-auto custom-scrollbar",children:h.map(x=>{const t=R("cuentas",x.nombre),a=x.ocultaDelBalance;return e.jsxs("button",{onClick:()=>E("cuentas",x.nombre),className:"px-3 py-2 min-h-[40px] rounded-md min-[400px]:rounded-lg text-xs font-semibold transition-all duration-200 active:scale-95 flex items-center gap-1",style:{backgroundColor:t?"var(--accent-primary)":"var(--bg-secondary)",color:t?"white":"var(--text-secondary)",boxShadow:t?"0 4px 16px var(--accent-primary-glow)":"none",opacity:a&&!t?.6:1},title:a?"Cuenta oculta del balance":"",children:[x.nombre,a&&e.jsx("svg",{className:"w-3 h-3",style:{color:t?"white":"var(--text-muted)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.542 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})]},x.nombre)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"Categor√≠as"}),(()=>{const x=y.map(a=>typeof a=="string"?a:a.value),t=x.length>0&&x.every(a=>{var k;return(k=s.categorias)==null?void 0:k.includes(a)});return e.jsx("button",{onClick:()=>{j(a=>({...a,categorias:t?[]:x}))},className:"text-[10px] font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:t?"Deseleccionar todos":"Seleccionar todos"})})()]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-28 overflow-y-auto custom-scrollbar",children:y.map(x=>{const t=typeof x=="string"?x:x.value,a=typeof x=="string"?x:x.label,k=R("categorias",t);return e.jsx("button",{onClick:()=>E("categorias",t),className:"px-3 py-2 min-h-[40px] rounded-md min-[400px]:rounded-lg text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:k?"var(--accent-red)":"var(--bg-secondary)",color:k?"white":"var(--text-secondary)",boxShadow:k?"0 4px 16px rgba(255, 92, 114, 0.3)":"none"},children:a},t)})})]}),C>0&&e.jsx("div",{className:"pt-3",style:{borderTop:"1px solid var(--border-subtle)"},children:e.jsxs("button",{onClick:r,className:"text-xs font-semibold flex items-center gap-1.5 transition-all duration-200 hover:opacity-80 active:scale-95",style:{color:"var(--accent-primary)"},children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Limpiar filtros"]})})]}),!b||b.totalExpenses===0&&b.totalIncome===0?e.jsxs("div",{className:"card-glass p-4 sm:p-6 text-center rounded-lg min-[400px]:rounded-xl",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-2 sm:mb-3 rounded-md min-[400px]:rounded-lg sm:rounded-xl flex items-center justify-center",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("p",{className:"text-xs sm:text-sm font-medium",style:{color:"var(--text-secondary)"},children:C>0?"Sin movimientos con filtros":"Sin movimientos esta semana"})]}):e.jsx("div",{className:"card-glass p-3 sm:p-4 rounded-lg min-[400px]:rounded-xl",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3",children:[e.jsxs("div",{className:"group p-2.5 sm:p-3 rounded-md min-[400px]:rounded-lg transition-all duration-200 hover:bg-[var(--bg-tertiary)]",children:[e.jsx("p",{className:"text-[10px] sm:text-[11px] uppercase tracking-wider font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Prom. Ing."}),e.jsxs("p",{className:"text-sm sm:text-base font-bold truncate",style:{color:"var(--accent-green)"},children:["+",L(o==="ARS"?b.avgDailyIncome:b.avgDailyIncomeDolares,o)]})]}),e.jsxs("div",{className:"group p-2.5 sm:p-3 rounded-md min-[400px]:rounded-lg transition-all duration-200 hover:bg-[var(--bg-tertiary)]",children:[e.jsx("p",{className:"text-[10px] sm:text-[11px] uppercase tracking-wider font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Prom. Gasto"}),e.jsxs("p",{className:"text-sm sm:text-base font-bold truncate",style:{color:"var(--accent-red)"},children:["-",L(o==="ARS"?b.avgDailyExpense:b.avgDailyExpenseDolares,o)]})]}),e.jsxs("div",{className:"group p-2.5 sm:p-3 rounded-md min-[400px]:rounded-lg transition-all duration-200 hover:bg-[var(--bg-tertiary)]",children:[e.jsx("p",{className:"text-[10px] sm:text-[11px] uppercase tracking-wider font-medium mb-1",style:{color:"var(--text-secondary)"},children:"D√≠a pico"}),e.jsx("p",{className:"text-sm sm:text-base font-bold capitalize truncate",style:{color:"var(--accent-red)"},children:((S=b.maxDay)==null?void 0:S.name)||"-"}),e.jsx("p",{className:"text-[11px] sm:text-xs truncate",style:{color:"var(--text-secondary)"},children:b.maxDay?L(o==="ARS"?b.maxDay.amount:b.maxDay.amountDolares,o):"-"})]}),e.jsxs("div",{className:"group p-2.5 sm:p-3 rounded-md min-[400px]:rounded-lg transition-all duration-200 hover:bg-[var(--bg-tertiary)]",children:[e.jsx("p",{className:"text-[10px] sm:text-[11px] uppercase tracking-wider font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Top categor√≠a"}),e.jsx("p",{className:"text-sm sm:text-base font-bold truncate",style:{color:"var(--accent-primary)"},children:((U=(B=b.topCategory)==null?void 0:B.name)==null?void 0:U.replace(/^[\p{Emoji}\u200d]+\s*/u,"").trim())||"-"}),e.jsx("p",{className:"text-[11px] sm:text-xs truncate",style:{color:"var(--text-secondary)"},children:b.topCategory?L(o==="ARS"?b.topCategory.amount:b.topCategory.amountDolares,o):"-"})]})]})})]})}function Je({accounts:v=[],categories:h={ingresos:[],gastos:[]},filters:m,onFilterChange:u}){var y,g,C,b,E,R;const[o,f]=i.useState(!1);[...h.ingresos||[],...h.gastos||[]];const d=(r,n)=>{const l=m[r]||[];let S;l.includes(n)?S=l.filter(B=>B!==n):S=[...l,n],u==null||u({...m,[r]:S})},M=(r,n)=>(m[r]||[]).includes(n),s=[((y=m.tipos)==null?void 0:y.length)>0&&((g=m.tipos)==null?void 0:g.length)<3,((C=m.cuentas)==null?void 0:C.length)>0,((b=m.categorias)==null?void 0:b.length)>0].filter(Boolean).length,j=()=>{u==null||u({tipos:[],cuentas:[],categorias:[]})};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>f(!o),className:"flex items-center gap-2 px-3.5 py-2.5 rounded-lg min-[400px]:rounded-xl text-sm transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.98]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),e.jsx("span",{className:"font-medium",children:"Filtros"}),s>0&&e.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold",style:{backgroundColor:"var(--accent-primary)",color:"white",boxShadow:"0 2px 8px var(--accent-primary-glow)"},children:s}),e.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${o?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),o&&e.jsxs("div",{className:"p-4 rounded-lg min-[400px]:rounded-xl space-y-4 animate-scale-in card-glass",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[11px] font-semibold uppercase tracking-wider mb-2.5",style:{color:"var(--text-secondary)"},children:"Tipo de movimiento"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"ingreso",label:"Ingresos",color:"var(--accent-green)",glow:"rgba(0, 217, 154, 0.3)"},{value:"gasto",label:"Gastos",color:"var(--accent-red)",glow:"rgba(255, 92, 114, 0.3)"},{value:"transferencia",label:"Transferencias",color:"var(--accent-blue)",glow:"rgba(59, 130, 246, 0.3)"}].map(r=>{const n=M("tipos",r.value);return e.jsx("button",{onClick:()=>d("tipos",r.value),className:"px-3.5 py-2.5 min-h-[44px] rounded-lg min-[400px]:rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:n?r.color:"var(--bg-secondary)",color:n?"white":"var(--text-secondary)",boxShadow:n?`0 4px 16px ${r.glow}`:"none"},children:r.label},r.value)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"Cuentas"}),e.jsx("button",{onClick:()=>{const r=v.map(l=>l.nombre),n=r.every(l=>{var S;return(S=m.cuentas)==null?void 0:S.includes(l)});u==null||u({...m,cuentas:n?[]:r})},className:"text-[10px] font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:v.length>0&&v.every(r=>{var n;return(n=m.cuentas)==null?void 0:n.includes(r.nombre)})?"Deseleccionar todos":"Seleccionar todos"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-28 overflow-y-auto custom-scrollbar",children:v.map(r=>{const n=M("cuentas",r.nombre),l=r.ocultaDelBalance;return e.jsxs("button",{onClick:()=>d("cuentas",r.nombre),className:"px-3.5 py-2.5 min-h-[44px] rounded-lg min-[400px]:rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95 flex items-center gap-1.5",style:{backgroundColor:n?"var(--accent-primary)":"var(--bg-secondary)",color:n?"white":"var(--text-secondary)",boxShadow:n?"0 4px 16px var(--accent-primary-glow)":"none",opacity:l&&!n?.6:1},title:l?"Cuenta oculta del balance":"",children:[r.nombre,l&&e.jsx("svg",{className:"w-3 h-3",style:{color:n?"white":"var(--text-muted)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.542 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})]},r.nombre)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"Categor√≠as"}),(()=>{const r=[...(h.ingresos||[]).map(l=>typeof l=="string"?l:l.value),...(h.gastos||[]).map(l=>typeof l=="string"?l:l.value)],n=r.length>0&&r.every(l=>{var S;return(S=m.categorias)==null?void 0:S.includes(l)});return e.jsx("button",{onClick:()=>{u==null||u({...m,categorias:n?[]:r})},className:"text-[10px] font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:n?"Deseleccionar todos":"Seleccionar todos"})})()]}),e.jsxs("div",{className:"flex flex-wrap gap-2 max-h-36 overflow-y-auto custom-scrollbar",children:[((E=h.ingresos)==null?void 0:E.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-full text-[10px] font-semibold uppercase tracking-wider",style:{color:"var(--accent-green)"},children:"Ingresos:"}),h.ingresos.map(r=>{const n=typeof r=="string"?r:r.value,l=typeof r=="string"?r:r.label,S=M("categorias",n);return e.jsx("button",{onClick:()=>d("categorias",n),className:"px-3.5 py-2.5 min-h-[44px] rounded-lg min-[400px]:rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:S?"var(--accent-green)":"var(--bg-secondary)",color:S?"white":"var(--text-secondary)",boxShadow:S?"0 4px 16px rgba(0, 217, 154, 0.3)":"none"},children:l},n)})]}),((R=h.gastos)==null?void 0:R.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-full text-[10px] font-semibold uppercase tracking-wider mt-2",style:{color:"var(--accent-red)"},children:"Gastos:"}),h.gastos.map(r=>{const n=typeof r=="string"?r:r.value,l=typeof r=="string"?r:r.label,S=M("categorias",n);return e.jsx("button",{onClick:()=>d("categorias",n),className:"px-3.5 py-2.5 min-h-[44px] rounded-lg min-[400px]:rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:S?"var(--accent-red)":"var(--bg-secondary)",color:S?"white":"var(--text-secondary)",boxShadow:S?"0 4px 16px rgba(255, 92, 114, 0.3)":"none"},children:l},n)})]})]})]}),s>0&&e.jsx("div",{className:"pt-3",style:{borderTop:"1px solid var(--border-subtle)"},children:e.jsxs("button",{onClick:j,className:"text-xs font-semibold flex items-center gap-1.5 transition-all duration-200 hover:opacity-80 active:scale-95",style:{color:"var(--accent-primary)"},children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Limpiar filtros"]})})]})]})}function Ye({movements:v,dateRange:h,onDateRangeChange:m,filters:u,onFilterChange:o,accounts:f,categories:d,onMovementClick:M,onMovementDelete:s,loading:j=!1,currency:y="ARS"}){const[g,C]=i.useState(null),b=t=>f==null?void 0:f.find(a=>a.nombre===t),E=t=>{const a=b(t);return(a==null?void 0:a.moneda)==="D√≥lar"},R=t=>{const a=b(t);return a!=null&&a.icon?a.icon:null},r=t=>{const a=R(t);return a?pe(a)?e.jsx("span",{className:"text-[10px] sm:text-xs",children:a}):e.jsx("img",{src:he(a),alt:"",className:"w-3.5 h-3.5 sm:w-4 sm:h-4 rounded object-cover"}):null},n=t=>{const a=t.tipo==="transferencia"?t.cuentaSaliente:t.cuenta;return E(a)},l=t=>{switch(t){case"ingreso":return{color:"var(--accent-green)",bgColor:"rgba(0, 217, 154, 0.12)",glowColor:"rgba(0, 217, 154, 0.3)",prefix:"+",icon:"up"};case"gasto":return{color:"var(--accent-red)",bgColor:"rgba(255, 92, 114, 0.12)",glowColor:"rgba(255, 92, 114, 0.3)",prefix:"-",icon:"down"};case"transferencia":return{color:"var(--accent-blue)",bgColor:"rgba(59, 130, 246, 0.12)",glowColor:"rgba(59, 130, 246, 0.3)",prefix:"",icon:"transfer"};default:return{color:"var(--accent-blue)",bgColor:"rgba(59, 130, 246, 0.12)",glowColor:"rgba(59, 130, 246, 0.3)",prefix:"",icon:"down"}}},S=(t,a)=>{t.stopPropagation(),C(a)},B=()=>{g&&(s==null||s(g),C(null))},U=(t,a)=>{const k="w-4 h-4 sm:w-5 sm:h-5";return t==="transferencia"?e.jsx("svg",{className:k,style:{color:a},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}):t==="ingreso"?e.jsx("svg",{className:k,style:{color:a},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})}):e.jsx("svg",{className:k,style:{color:a},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})},x=()=>e.jsx("div",{className:"card-glass overflow-hidden rounded-lg min-[400px]:rounded-xl",children:[1,2,3].map(t=>e.jsxs("div",{className:"flex items-center gap-2.5 sm:gap-3 px-3 py-2.5 sm:p-4",style:{borderBottom:t<3?"1px solid var(--border-subtle)":"none"},children:[e.jsx("div",{className:"w-9 h-9 sm:w-11 sm:h-11 rounded-md min-[400px]:rounded-lg sm:rounded-xl skeleton-shimmer",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-24 sm:w-28 skeleton-shimmer rounded-md min-[400px]:rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-3 w-32 sm:w-36 skeleton-shimmer rounded-md min-[400px]:rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}})]}),e.jsxs("div",{className:"text-right space-y-2",children:[e.jsx("div",{className:"h-4 sm:h-5 w-20 sm:w-24 skeleton-shimmer rounded-md min-[400px]:rounded-lg ml-auto",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-3 w-14 sm:w-16 skeleton-shimmer rounded-md min-[400px]:rounded-lg ml-auto",style:{backgroundColor:"var(--bg-tertiary)"}})]})]},t))});return e.jsxs("div",{className:"space-y-2 sm:space-y-4 overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col min-[400px]:flex-row min-[400px]:items-center min-[400px]:justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsx("h3",{className:"text-sm sm:text-[15px] font-semibold",style:{color:"var(--text-primary)"},children:"Movimientos"})]}),e.jsx("div",{className:"self-start min-[400px]:self-auto",children:e.jsx(je,{value:h,onChange:m,defaultPreset:"Este mes"})})]}),e.jsx(Je,{accounts:f,categories:d,filters:u,onFilterChange:o}),j?x():!v||v.length===0?e.jsxs("div",{className:"card-glass p-6 sm:p-8 text-center rounded-lg min-[400px]:rounded-xl",children:[e.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 rounded-lg min-[400px]:rounded-xl sm:rounded-2xl flex items-center justify-center",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("svg",{className:"w-7 h-7 sm:w-8 sm:h-8",style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsx("p",{className:"font-semibold text-base mb-1",style:{color:"var(--text-primary)"},children:"Sin movimientos"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"No hay movimientos en este periodo"})]}):e.jsx("div",{className:"card-glass overflow-hidden rounded-lg min-[400px]:rounded-xl",children:v.map((t,a)=>{const k=l(t.tipo);return e.jsxs("div",{className:`group flex items-start min-[400px]:items-center gap-2 px-3 py-2.5 sm:p-4 transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.995] ${a!==v.length-1?"border-b":""}`,style:{borderColor:"var(--border-subtle)"},children:[e.jsxs("button",{onClick:()=>M==null?void 0:M(t),className:"flex flex-col min-[400px]:flex-row min-[400px]:items-center gap-2 sm:gap-3 flex-1 min-w-0 text-left transition-transform duration-200",style:{backgroundColor:"transparent"},children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"w-9 h-9 sm:w-11 sm:h-11 rounded-md min-[400px]:rounded-lg sm:rounded-xl flex items-center justify-center flex-shrink-0 transition-all duration-200 group-hover:scale-110",style:{backgroundColor:k.bgColor},children:U(t.tipo,k.color)}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[e.jsx("p",{className:"font-semibold text-sm sm:text-[15px]",style:{color:"var(--text-primary)",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.tipo==="transferencia"?"Transfer":t.categoria||""}),e.jsx("p",{className:"text-[11px] sm:text-xs truncate flex items-center gap-1",style:{color:"var(--text-secondary)"},children:t.tipo==="transferencia"?e.jsxs(e.Fragment,{children:[r(t.cuentaSaliente),e.jsx("span",{children:t.cuentaSaliente}),e.jsx("span",{children:"‚Üí"}),r(t.cuentaEntrante),e.jsx("span",{children:t.cuentaEntrante})]}):e.jsxs(e.Fragment,{children:[r(t.cuenta),e.jsx("span",{children:t.cuenta})]})})]})]}),e.jsxs("div",{className:"text-left min-[400px]:text-right flex-shrink-0 pl-11 min-[400px]:pl-0",children:[(()=>{const V=n(t)?"USD":"ARS",_=t.monto||t.montoSaliente;return e.jsxs("div",{className:"flex items-center gap-1.5 min-[400px]:justify-end",children:[e.jsx("img",{src:`/icons/catalog/${V}.svg`,alt:V,className:"w-4 h-4 rounded-sm"}),e.jsxs("p",{className:"font-bold text-sm sm:text-lg",style:{color:k.color},children:[k.prefix,L(_,V)]})]})})(),e.jsx("p",{className:"text-[11px] sm:text-xs",style:{color:"var(--text-secondary)"},children:ke(t.fecha,"short")})]})]}),e.jsx("button",{onClick:$=>S($,t),className:"p-2 sm:p-2.5 rounded-md min-[400px]:rounded-lg sm:rounded-xl flex-shrink-0 transition-all duration-200 hover:bg-red-500/15 active:scale-95 self-start min-[400px]:self-center",style:{color:"var(--text-muted)"},title:"Eliminar",children:e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-colors hover:text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},t.rowIndex||a)})}),v&&v.length>0&&e.jsxs("p",{className:"text-xs text-center font-medium",style:{color:"var(--text-secondary)"},children:["Mostrando ",v.length," movimiento",v.length!==1?"s":""]}),g&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-md animate-fade-in",onClick:()=>C(null)}),e.jsx("div",{className:"relative w-full max-w-sm rounded-2xl p-6 animate-scale-in card-elevated",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center",style:{backgroundColor:"rgba(255, 92, 114, 0.12)",boxShadow:"0 0 30px rgba(255, 92, 114, 0.2)"},children:e.jsx("svg",{className:"w-8 h-8",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("h3",{className:"text-lg font-bold font-display mb-2",style:{color:"var(--text-primary)"},children:"Eliminar movimiento"}),e.jsxs("p",{className:"text-sm mb-5",style:{color:"var(--text-secondary)"},children:["¬øEst√°s seguro de que quieres eliminar ",g.tipo==="transferencia"?"esta":"este"," ",g.tipo,"?",e.jsx("br",{}),e.jsx("span",{className:"font-bold text-base mt-1 inline-block",style:{color:l(g.tipo).color},children:g.tipo==="transferencia"?L(g.montoSaliente):L(g.montoPesos||g.monto)})," - ",g.tipo==="transferencia"?`${g.cuentaSaliente} ‚Üí ${g.cuentaEntrante}`:g.categoria]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>C(null),className:"flex-1 py-3.5 rounded-xl font-semibold transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.98]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},children:"Cancelar"}),e.jsx("button",{onClick:B,className:"flex-1 py-3.5 rounded-xl font-semibold text-white transition-all duration-200 hover:opacity-90 active:scale-[0.98]",style:{backgroundColor:"var(--accent-red)",boxShadow:"0 4px 20px rgba(255, 92, 114, 0.3)"},children:"Eliminar"})]})]})})]})]})}function qe({accounts:v}){const h=ie(),m=i.useMemo(()=>{if(!v||v.length===0)return[];const u=new Date,o=u.getDate(),f=u.getMonth(),d=u.getFullYear(),M=new Date(d,f+1,0).getDate(),s=o+1>M?1:o+1;return v.filter(j=>{if(!j.esTarjetaCredito||!j.diaVencimiento)return!1;const y=Math.min(j.diaVencimiento,M);return y===o||y===s}).map(j=>{const g=Math.min(j.diaVencimiento,M)===o;return{...j,isDueToday:g,isDueTomorrow:!g}}).sort((j,y)=>j.isDueToday&&!y.isDueToday?-1:!j.isDueToday&&y.isDueToday?1:0)},[v]);return m.length===0?null:e.jsx("div",{className:"space-y-2",children:m.map(u=>{const o=u.resumenVencePesos||0,f=u.resumenVenceDolares||0,d=u.resumenVencePagado,M=o>0||f>0,j=d?{bg:"var(--accent-green-dim)",border:"var(--accent-green)",iconBg:"rgba(34, 197, 94, 0.2)",textColor:"var(--accent-green)",icon:"‚úÖ"}:u.isDueToday?{bg:"var(--accent-red-dim)",border:"var(--accent-red)",iconBg:"rgba(239, 68, 68, 0.2)",textColor:"var(--accent-red)",icon:"‚ö†Ô∏è"}:{bg:"var(--accent-yellow-dim)",border:"var(--accent-yellow)",iconBg:"rgba(234, 179, 8, 0.2)",textColor:"var(--accent-yellow)",icon:"üí≥"};return e.jsx("button",{onClick:()=>h("/tarjetas"),className:"w-full rounded-lg min-[400px]:rounded-xl p-2.5 min-[400px]:p-3 sm:p-4 transition-all hover:opacity-90 overflow-hidden",style:{backgroundColor:j.bg,border:`1px solid ${j.border}`},children:e.jsxs("div",{className:"flex items-start min-[400px]:items-center gap-2 min-[400px]:gap-3 min-w-0",children:[e.jsx("div",{className:"w-7 h-7 min-[400px]:w-8 min-[400px]:h-8 sm:w-10 sm:h-10 rounded-md min-[400px]:rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:j.iconBg},children:e.jsx("span",{className:"text-sm min-[400px]:text-base sm:text-xl",children:j.icon})}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsxs("div",{className:"flex flex-col min-[400px]:flex-row min-[400px]:items-center gap-0 min-[400px]:gap-1 sm:gap-2",children:[e.jsx("p",{className:"text-[11px] min-[400px]:text-xs sm:text-sm font-semibold",style:{color:j.textColor},children:d?u.isDueToday?"Vence HOY ¬∑ Pagado":"Vence ma√±ana ¬∑ Pagado":u.isDueToday?"Vence HOY":"Vence ma√±ana"}),e.jsxs("span",{className:"text-[11px] min-[400px]:text-xs sm:text-sm font-medium truncate",style:{color:"var(--text-secondary)"},children:[e.jsx("span",{className:"hidden min-[400px]:inline",children:"¬∑ "}),u.nombre]})]}),e.jsx("div",{className:"flex items-center gap-1.5 min-[400px]:gap-2 sm:gap-3 mt-0.5",children:M?e.jsxs(e.Fragment,{children:[o>0&&e.jsxs("span",{className:"text-xs min-[400px]:text-sm sm:text-base font-semibold",style:{color:d?"var(--text-secondary)":"var(--text-primary)",textDecoration:d?"line-through":"none"},children:["$",q(o)]}),f>0&&e.jsxs("span",{className:"text-[11px] min-[400px]:text-xs sm:text-sm font-semibold",style:{color:d?"var(--text-secondary)":"var(--accent-green)",textDecoration:d?"line-through":"none"},children:["USD $",q(f)]})]}):e.jsx("span",{className:"text-[11px] min-[400px]:text-xs sm:text-sm",style:{color:"var(--text-secondary)"},children:"Sin gastos"})})]}),e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0 self-center",style:{color:"var(--text-muted)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})},u.id)})})}const ne={oficial:{nombre:"Oficial",descripcion:"Banco Naci√≥n"},blue:{nombre:"Blue",descripcion:"Informal"},bolsa:{nombre:"MEP",descripcion:"Bolsa/MEP"},contadoconliqui:{nombre:"CCL",descripcion:"Contado con liquidaci√≥n"}},ue="cashe_economic_indicators",Fe=1800*1e3,Ne=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],be=v=>{if(!v)return"";const h=new Date(v);return`${Ne[h.getMonth()]} ${h.getFullYear()}`},Ke=v=>{if(!v)return"";const h=new Date(v);return`${h.getDate()} de ${Ne[h.getMonth()]} ${h.getFullYear()}`};function le({children:v,title:h,description:m,details:u}){const[o,f]=i.useState(!1);return e.jsxs("div",{className:"relative group",onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),onTouchStart:()=>f(!o),children:[v,o&&e.jsxs("div",{className:"absolute left-0 bottom-full mb-2 w-56 p-3 rounded-xl shadow-lg z-20 animate-scale-in",style:{backgroundColor:"var(--bg-elevated)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-xs font-semibold mb-1",style:{color:"var(--text-primary)"},children:h}),e.jsx("p",{className:"text-[11px] leading-relaxed mb-2",style:{color:"var(--text-secondary)"},children:m}),u&&e.jsx("p",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:u}),e.jsx("div",{className:"absolute left-4 -bottom-1.5 w-3 h-3 rotate-45",style:{backgroundColor:"var(--bg-elevated)",borderRight:"1px solid var(--border-subtle)",borderBottom:"1px solid var(--border-subtle)"}})]})]})}function Xe({onExchangeRateChange:v}){var k,$,V,_,F,K,X,Q,H;const h=ie(),[m,u]=i.useState(null),[o,f]=i.useState(null),[d,M]=i.useState(null),[s,j]=i.useState("oficial"),[y,g]=i.useState(null),[C,b]=i.useState(!0),[E,R]=i.useState(null),[r,n]=i.useState(!1),[l,S]=i.useState(!1);i.useEffect(()=>{B()},[]);const B=async()=>{b(!0),R(null);try{const N=sessionStorage.getItem(ue);if(N){const{data:W,timestamp:se}=JSON.parse(N);if(Date.now()-se<Fe){u(W.dollarRates),f(W.inflation),M(W.riesgoPais);const ee=await ve();j(ee.tipoUsado||"oficial"),g(ee.tipoCambio),b(!1);return}}const[A,I,T,J]=await Promise.all([Ce(),Se(),De(),ve()]);u(A),f(I),M(T),j(J.tipoUsado||"oficial"),g(J.tipoCambio),sessionStorage.setItem(ue,JSON.stringify({data:{dollarRates:A,inflation:I,riesgoPais:T},timestamp:Date.now()}))}catch(N){console.error("Error loading economic data:",N),R("No se pudieron cargar los indicadores")}finally{b(!1)}},U=async N=>{if(!(N===s||r)){n(!0),S(!1);try{const A=await Me(N);j(N),g(A.tipoCambio),v&&await v()}catch(A){console.error("Error updating exchange rate type:",A)}finally{n(!1)}}},x=async()=>{sessionStorage.removeItem(ue),await B()};i.useMemo(()=>m?m.find(N=>N.casa===s):null,[m,s]);const t=i.useMemo(()=>m?m.filter(N=>ne[N.casa]):[],[m]),a=i.useMemo(()=>{if(!m)return null;const N=m.find(T=>T.casa==="oficial"),A=m.find(T=>T.casa==="blue");return!(N!=null&&N.venta)||!(A!=null&&A.venta)?null:{valor:(A.venta-N.venta)/N.venta*100,oficialVenta:N.venta,blueVenta:A.venta}},[m]);return C?e.jsxs("div",{className:"p-4 sm:p-5 rounded-xl sm:rounded-2xl animate-pulse",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"h-5 w-24 rounded",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-5 w-5 rounded",style:{backgroundColor:"var(--bg-tertiary)"}})]}),e.jsxs("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 gap-3",children:[e.jsx("div",{className:"h-32 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-32 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"}})]}),e.jsx("div",{className:"h-12 rounded-xl mt-3",style:{backgroundColor:"var(--bg-tertiary)"}})]}):E&&!m&&!o?e.jsx("div",{className:"p-4 sm:p-5 rounded-xl sm:rounded-2xl",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-subtle)"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:E}),e.jsx("button",{onClick:x,className:"px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},children:"Reintentar"})]})}):e.jsxs("div",{className:"p-4 sm:p-5 rounded-xl sm:rounded-2xl overflow-hidden",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-base",children:"üìä"}),e.jsx("h3",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:"Econom√≠a"})]}),e.jsx("button",{onClick:()=>h("/configuracion"),className:"p-1.5 rounded-lg transition-colors hover:bg-[var(--bg-tertiary)]",title:"Ir a configuraci√≥n",children:e.jsxs("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{className:"p-3 sm:p-4 rounded-xl flex flex-col",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsxs("div",{className:"mb-3 pb-3",style:{borderBottom:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-[10px] sm:text-[11px] uppercase tracking-wide font-semibold mb-2.5",style:{color:"var(--text-muted)"},children:"Inflaci√≥n"}),o?e.jsxs("div",{className:"space-y-2.5",children:[e.jsx(le,{title:"Inflaci√≥n Mensual",description:"Variaci√≥n de precios respecto al mes anterior. Mide cu√°nto aumentaron los precios en un solo mes.",details:`Dato de ${be((k=o.mensual)==null?void 0:k.fecha)}`,children:e.jsxs("div",{className:"flex items-center justify-between cursor-help py-0.5",children:[e.jsxs("span",{className:"text-xs sm:text-sm flex items-center gap-1.5",style:{color:"var(--text-secondary)"},children:["Mensual",e.jsx("svg",{className:"w-3.5 h-3.5 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("span",{className:"text-sm sm:text-base font-semibold",style:{color:"var(--text-primary)"},children:[(V=($=o.mensual)==null?void 0:$.valor)==null?void 0:V.toFixed(1),"%"]}),o.mensualAnterior!==null&&e.jsx("span",{className:"text-xs flex items-center",style:{color:((_=o.mensual)==null?void 0:_.valor)<o.mensualAnterior?"var(--accent-green)":"var(--accent-red)"},children:((F=o.mensual)==null?void 0:F.valor)<o.mensualAnterior?"‚Üì":"‚Üë"})]})]})}),e.jsx(le,{title:"Inflaci√≥n Interanual",description:"Variaci√≥n de precios respecto al mismo mes del a√±o anterior. Muestra cu√°nto aumentaron los precios en los √∫ltimos 12 meses.",details:`Comparando ${be((K=o.interanual)==null?void 0:K.fecha)} con el mismo mes del a√±o anterior`,children:e.jsxs("div",{className:"flex items-center justify-between cursor-help py-0.5",children:[e.jsxs("span",{className:"text-xs sm:text-sm flex items-center gap-1.5",style:{color:"var(--text-secondary)"},children:["Interanual",e.jsx("svg",{className:"w-3.5 h-3.5 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),e.jsxs("span",{className:"text-sm sm:text-base font-semibold",style:{color:"var(--text-primary)"},children:[(Q=(X=o.interanual)==null?void 0:X.valor)==null?void 0:Q.toFixed(1),"%"]})]})})]}):e.jsx("p",{className:"text-xs sm:text-sm",style:{color:"var(--text-muted)"},children:"No disponible"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] sm:text-[11px] uppercase tracking-wide font-semibold mb-2.5",style:{color:"var(--text-muted)"},children:"Indicadores"}),e.jsxs("div",{className:"space-y-2.5",children:[e.jsx(le,{title:"Riesgo Pa√≠s",description:"Mide la diferencia de tasa que paga Argentina para endeudarse respecto a los bonos del Tesoro de EE.UU. A menor valor, mejor percepci√≥n de los mercados.",details:d!=null&&d.fecha?`Dato del ${Ke(d.fecha)}`:null,children:e.jsxs("div",{className:"flex items-center justify-between cursor-help py-0.5",children:[e.jsxs("span",{className:"text-xs sm:text-sm flex items-center gap-1.5",style:{color:"var(--text-secondary)"},children:["Riesgo Pa√≠s",e.jsx("svg",{className:"w-3.5 h-3.5 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),d!=null&&d.valor?e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsxs("span",{className:"text-sm sm:text-base font-semibold",style:{color:"var(--text-primary)"},children:[d.valor," pts"]}),d.valorAnterior&&d.valor!==d.valorAnterior&&e.jsx("span",{className:"text-xs flex items-center",style:{color:d.valor<d.valorAnterior?"var(--accent-green)":"var(--accent-red)"},children:d.valor<d.valorAnterior?"‚Üì":"‚Üë"})]}):e.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"-"})]})}),e.jsx(le,{title:"Brecha Cambiaria",description:"Diferencia porcentual entre el d√≥lar blue y el oficial. Indica la distorsi√≥n del mercado cambiario.",details:a?`Blue $${q(a.blueVenta)} vs Oficial $${q(a.oficialVenta)}`:null,children:e.jsxs("div",{className:"flex items-center justify-between cursor-help py-0.5",children:[e.jsxs("span",{className:"text-xs sm:text-sm flex items-center gap-1.5",style:{color:"var(--text-secondary)"},children:["Brecha",e.jsx("svg",{className:"w-3.5 h-3.5 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})]}),a?e.jsxs("span",{className:"text-sm sm:text-base font-semibold",style:{color:a.valor>50?"var(--accent-red)":a.valor>20?"var(--accent-yellow)":"var(--accent-green)"},children:[a.valor.toFixed(1),"%"]}):e.jsx("span",{className:"text-sm",style:{color:"var(--text-muted)"},children:"-"})]})})]})]})]}),e.jsxs("div",{className:"p-3 sm:p-4 rounded-xl flex flex-col",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("p",{className:"text-[10px] sm:text-[11px] uppercase tracking-wide font-semibold mb-2.5",style:{color:"var(--text-muted)"},children:"D√≥lar"}),t.length>0?e.jsx("div",{className:"flex-1 flex flex-col justify-between",children:t.slice(0,4).map(N=>{var I;const A=N.casa===s;return e.jsxs("div",{className:"flex items-center justify-between py-1.5 sm:py-2 px-2 -mx-2 rounded-lg transition-colors",style:{backgroundColor:A?"var(--accent-primary-dim)":"transparent"},children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium",style:{color:A?"var(--accent-primary)":"var(--text-secondary)"},children:((I=ne[N.casa])==null?void 0:I.nombre)||N.nombre}),e.jsxs("span",{className:"text-xs sm:text-sm tabular-nums font-medium truncate",style:{color:"var(--text-primary)"},children:["$",q(N.compra)," / $",q(N.venta)]})]},N.casa)})}):e.jsx("p",{className:"text-xs sm:text-sm",style:{color:"var(--text-muted)"},children:"No disponible"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>S(!l),disabled:r,className:"w-full flex items-center justify-between gap-2 px-3 py-2.5 rounded-xl transition-colors overflow-hidden",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:"text-xs flex-shrink-0",style:{color:"var(--text-muted)"},children:"Usando:"}),e.jsx("span",{className:"text-sm font-medium truncate",style:{color:"var(--accent-primary)"},children:((H=ne[s])==null?void 0:H.nombre)||s}),y&&e.jsxs("span",{className:"text-xs flex-shrink-0",style:{color:"var(--text-secondary)"},children:["$",q(y),"/USD"]})]}),e.jsx("div",{className:"flex items-center gap-1",children:r?e.jsx("div",{className:"w-4 h-4 border-2 border-[var(--accent-primary)]/30 border-t-[var(--accent-primary)] rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx("span",{role:"button",tabIndex:0,onClick:N=>{N.stopPropagation(),x()},onKeyDown:N=>{(N.key==="Enter"||N.key===" ")&&(N.stopPropagation(),x())},className:"p-1 rounded hover:bg-[var(--bg-secondary)] transition-colors cursor-pointer",title:"Actualizar cotizaciones",children:e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-muted)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("svg",{className:`w-4 h-4 transition-transform ${l?"rotate-180":""}`,style:{color:"var(--text-muted)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]}),l&&e.jsx("div",{className:"absolute bottom-full left-0 right-0 mb-1 p-2 rounded-xl shadow-lg z-10 animate-scale-in overflow-hidden",style:{backgroundColor:"var(--bg-elevated)",border:"1px solid var(--border-subtle)"},children:Object.entries(ne).map(([N,{nombre:A,descripcion:I}])=>{const T=m==null?void 0:m.find(W=>W.casa===N),J=N===s;return e.jsxs("button",{onClick:()=>U(N),className:"w-full flex items-center justify-between p-2 rounded-lg transition-colors hover:bg-[var(--bg-tertiary)]",style:{backgroundColor:J?"var(--accent-primary-dim)":"transparent"},children:[e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-medium",style:{color:J?"var(--accent-primary)":"var(--text-primary)"},children:A}),e.jsx("p",{className:"text-[10px]",style:{color:"var(--text-muted)"},children:I})]}),T&&e.jsxs("span",{className:"text-xs tabular-nums",style:{color:"var(--text-secondary)"},children:["$",q(T.venta)]})]},N)})})]})]})}function rs(){const v=ie(),{showError:h}=Ee(),[m,u]=i.useState("ARS"),[o,f]=i.useState(()=>{try{const c=localStorage.getItem("cashe_balance_account_filters");if(c)return JSON.parse(c)}catch(c){console.warn("Error loading balance account filters:",c)}return[]});i.useEffect(()=>{try{localStorage.setItem("cashe_balance_account_filters",JSON.stringify(o))}catch(c){console.warn("Error saving balance account filters:",c)}},[o]);const[d,M]=i.useState({from:me(new Date),to:de(new Date)}),[s,j]=i.useState(()=>{try{const c=localStorage.getItem("cashe_home_movement_dates");if(c){const w=JSON.parse(c);return{from:w.from?new Date(w.from):me(new Date),to:w.to?new Date(w.to):de(new Date)}}}catch(c){console.warn("Error loading saved date range:",c)}return{from:me(new Date),to:de(new Date)}});i.useEffect(()=>{var c,w;try{localStorage.setItem("cashe_home_movement_dates",JSON.stringify({from:((c=s.from)==null?void 0:c.toISOString())||null,to:((w=s.to)==null?void 0:w.toISOString())||null}))}catch(P){console.warn("Error saving date range:",P)}},[s]);const[y,g]=i.useState(()=>{try{const c=localStorage.getItem("cashe_home_filters");if(c){const w=JSON.parse(c);return{tipos:w.tipos||[],cuentas:w.cuentas||[],categorias:w.categorias||[]}}}catch(c){console.warn("Error loading saved filters:",c)}return{tipos:[],cuentas:[],categorias:[]}});i.useEffect(()=>{try{localStorage.setItem("cashe_home_filters",JSON.stringify(y))}catch(c){console.warn("Error saving filters:",c)}},[y]);const[C,b]=i.useState(null),[E,R]=i.useState([]),[r,n]=i.useState([]),[l,S]=i.useState([]),[B,U]=i.useState({ingresos:[],gastos:[]}),[x,t]=i.useState(!0),[a,k]=i.useState(!0),[$,V]=i.useState(!0),[_,F]=i.useState(!0),[K,X]=i.useState(null),[Q,H]=i.useState(null),[N,A]=i.useState(!1),[I,T]=i.useState(null),[J,W]=i.useState(!1),[se,ee]=i.useState(!1);i.useEffect(()=>{async function c(){try{const[w,P]=await Promise.all([ye(),Pe()]);S(w.accounts||[]),U(P.categorias||{ingresos:[],gastos:[]})}catch(w){console.error("Error fetching initial data:",w)}finally{F(!1)}}c()},[]),i.useEffect(()=>{if(l.length>0&&!se){const c=y.cuentas||[],w=l.map(Z=>Z.nombre),P=c.filter(Z=>w.includes(Z));if(P.length===0){const Z=l.filter(re=>!re.ocultaDelBalance).map(re=>re.nombre);g(re=>({...re,cuentas:Z}))}else P.length!==c.length&&g(Z=>({...Z,cuentas:P}));ee(!0)}},[l,se,y.cuentas]);const O=i.useCallback(async()=>{try{t(!0);const c=await Ae({fromDate:d.from?Y(d.from,"yyyy-MM-dd"):null,toDate:d.to?Y(d.to,"yyyy-MM-dd"):null});b(c.dashboard),X(null)}catch(c){X(c.message),console.error("Error fetching dashboard:",c)}finally{t(!1)}},[d]);i.useEffect(()=>{O()},[O]);const z=i.useCallback(async()=>{try{k(!0);const c=await fe({fromDate:s.from?Y(s.from,"yyyy-MM-dd"):null,toDate:s.to?Y(s.to,"yyyy-MM-dd"):null,tipos:y.tipos,cuentas:y.cuentas,categorias:y.categorias});R(c.movements||[])}catch(c){console.error("Error fetching movements:",c)}finally{k(!1)}},[s,y]);i.useEffect(()=>{z()},[z]);const p=i.useCallback(async()=>{try{V(!0);const c=Le(new Date,{weekStartsOn:1}),w=Re(new Date,{weekStartsOn:1}),P=await fe({fromDate:Y(c,"yyyy-MM-dd"),toDate:Y(w,"yyyy-MM-dd"),tipos:[],cuentas:[],categorias:[]});n(P.movements||[])}catch(c){console.error("Error fetching weekly movements:",c)}finally{V(!1)}},[]);i.useEffect(()=>{p()},[p]);const D=i.useCallback(async()=>{await Promise.all([O(),z(),p()])},[O,z,p]);Be(G.ALL_DATA_CHANGED,D);const te=async c=>{try{A(!0),await Te(c),H(null);const w=c.tipo==="ingreso"?G.INCOMES_CHANGED:c.tipo==="gasto"?G.EXPENSES_CHANGED:G.TRANSFERS_CHANGED;ae(w),ae(G.ACCOUNTS_CHANGED),await Promise.all([O(),z(),p()])}catch(w){console.error("Error updating movement:",w),h("No se pudo guardar el movimiento",w.message)}finally{A(!1)}},ce=async c=>{try{W(!0),await We(c),T(null),ae(G.ACCOUNTS_CHANGED);const w=await ye();S(w.accounts||[]),await O()}catch(w){console.error("Error updating account:",w),h("No se pudo guardar la cuenta",w.message)}finally{W(!1)}},oe=async c=>{H(null),R(w=>w.filter(P=>!(P.tipo===c.tipo&&P.rowIndex===c.rowIndex))),n(w=>w.filter(P=>!(P.tipo===c.tipo&&P.rowIndex===c.rowIndex)));try{await $e(c);const w=c.tipo==="ingreso"?G.INCOMES_CHANGED:c.tipo==="gasto"?G.EXPENSES_CHANGED:G.TRANSFERS_CHANGED;ae(w),ae(G.ACCOUNTS_CHANGED),await Promise.all([O(),z(),p()])}catch(w){console.error("Error deleting movement:",w),h("No se pudo eliminar el movimiento",w.message),await Promise.all([z(),p()])}},we=c=>{H(null),v("/nuevo",{state:{prefill:c}})};return _&&x?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(xe,{size:"lg"})}):K&&!C?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] gap-4",children:[e.jsxs("p",{style:{color:"var(--accent-red)"},children:["Error: ",K]}),e.jsx("button",{onClick:O,className:"px-4 py-2 rounded-lg font-medium",style:{backgroundColor:"var(--accent-primary)",color:"white"},children:"Reintentar"})]}):e.jsx(Oe,{onRefresh:D,disabled:x&&a,children:e.jsxs("div",{className:"space-y-3 sm:space-y-6 w-full max-w-full overflow-x-hidden",children:[e.jsx("h1",{className:"text-base sm:text-lg font-medium",style:{color:"var(--text-primary)"},children:"Dashboard"}),e.jsx(qe,{accounts:l}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 sm:gap-4",children:[x?e.jsx("div",{className:"rounded-xl p-12 flex items-center justify-center",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-subtle)"},children:e.jsx(xe,{})}):e.jsx(_e,{accounts:l,dashboard:C,currency:m,onCurrencyChange:u,accountFilters:o,onAccountFiltersChange:f}),x?e.jsx("div",{className:"rounded-xl p-12 flex items-center justify-center",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-subtle)"},children:e.jsx(xe,{})}):e.jsx(He,{accounts:l,dashboard:C,currency:m,dateRange:d,onDateRangeChange:M,accountFilters:o})]}),e.jsx(Xe,{onExchangeRateChange:async()=>{await O()}}),e.jsx(ze,{accounts:l,loading:_,onAccountClick:c=>{T(c)}}),e.jsx(Ge,{movements:r,accounts:l,categories:B,loading:$}),e.jsx(Ye,{movements:E,dateRange:s,onDateRangeChange:j,filters:y,onFilterChange:g,accounts:l,categories:B,onMovementClick:H,onMovementDelete:oe,loading:a,currency:m}),Q&&e.jsx(Ie,{movement:Q,accounts:l,categories:B,onSave:te,onDelete:oe,onDuplicate:we,onClose:()=>H(null),onConvertedToRecurring:D,loading:N}),I&&e.jsx(Ve,{account:I,onSave:ce,onClose:()=>T(null),loading:J})]})})}export{rs as default};
