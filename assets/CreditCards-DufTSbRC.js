import{r as l,j as e,a7 as Q,ai as ye,a6 as Ce,g as Se,n as Me,_ as De,aj as Le,ak as Ae,b as F,h as Pe,L as Re,i as Be,a as Ue,f as p,a8 as Ee,c as K,A as ze,y as We,al as Fe,am as Ie}from"./index-CKWgcbuo.js";function $e({isOpen:S,onClose:D,statement:T,attachments:m,onSave:X,onRemove:L,saving:A}){const[k,P]=l.useState(null),[r,R]=l.useState(null),d=l.useRef(null),y=l.useRef(null);if(!S||!T)return null;const V=c=>I=>{var w;const N=(w=I.target.files)==null?void 0:w[0];if(N){if(N.size>5*1024*1024){alert("El archivo es demasiado grande. Maximo 5MB.");return}c(N)}},B=async()=>{!k&&!r||(await X({statementFile:k,receiptFile:r}),P(null),R(null),d.current&&(d.current.value=""),y.current&&(y.current.value=""))},H=async c=>{await L(c)},U=m==null?void 0:m.statementUrl,i=m==null?void 0:m.receiptUrl,E=k||r;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:D}),e.jsxs("div",{className:"relative w-full max-w-md rounded-2xl p-6 animate-scale-in max-h-[90vh] overflow-y-auto",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:"Adjuntos del Resumen"}),e.jsx("p",{className:"text-sm capitalize",style:{color:"var(--text-secondary)"},children:T.monthName})]}),e.jsx("button",{onClick:D,className:"w-8 h-8 rounded-lg flex items-center justify-center transition-colors",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",style:{color:"var(--text-primary)"},children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Resumen del banco (PDF)"]})}),e.jsx("input",{ref:d,type:"file",className:"hidden",onChange:V(P)}),U&&!k?e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:"var(--bg-secondary)"},children:e.jsx("svg",{className:"w-5 h-5",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("button",{type:"button",onClick:()=>Q(m.statementUrl,m.statementName),className:"flex-1 text-sm font-medium truncate text-left hover:underline",style:{color:"var(--accent-primary)"},children:m.statementName}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{type:"button",onClick:()=>{var c;return(c=d.current)==null?void 0:c.click()},className:"w-8 h-8 rounded-lg flex items-center justify-center transition-colors hover:bg-white/10",style:{color:"var(--text-secondary)"},title:"Reemplazar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})}),e.jsx("button",{type:"button",onClick:()=>H("statement"),disabled:A,className:"w-8 h-8 rounded-lg flex items-center justify-center transition-colors hover:bg-red-500/20 disabled:opacity-50",style:{color:"var(--accent-red)"},title:"Eliminar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}):k?e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:"var(--bg-secondary)"},children:e.jsx("svg",{className:"w-5 h-5",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:k.name}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:ye(k.size)})]}),e.jsx("button",{type:"button",onClick:()=>{P(null),d.current&&(d.current.value="")},className:"w-8 h-8 rounded-lg flex items-center justify-center transition-colors hover:bg-red-500/20",style:{color:"var(--accent-red)"},children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):e.jsxs("button",{type:"button",onClick:()=>{var c;return(c=d.current)==null?void 0:c.click()},className:"w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 border-dashed transition-colors hover:border-[var(--accent-primary)]",style:{borderColor:"var(--border-subtle)",backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Adjuntar resumen PDF"]})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",style:{color:"var(--text-primary)"},children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-green)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Comprobante de pago"]})}),e.jsx("input",{ref:y,type:"file",className:"hidden",onChange:V(R)}),i&&!r?e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:"var(--bg-secondary)"},children:Ce(m.receiptName)?e.jsx("img",{src:m.receiptUrl,alt:"Receipt",className:"w-10 h-10 rounded-lg object-cover"}):e.jsx("svg",{className:"w-5 h-5",style:{color:"var(--accent-green)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("button",{type:"button",onClick:()=>Q(m.receiptUrl,m.receiptName),className:"flex-1 text-sm font-medium truncate text-left hover:underline",style:{color:"var(--accent-primary)"},children:m.receiptName}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{type:"button",onClick:()=>{var c;return(c=y.current)==null?void 0:c.click()},className:"w-8 h-8 rounded-lg flex items-center justify-center transition-colors hover:bg-white/10",style:{color:"var(--text-secondary)"},title:"Reemplazar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})})}),e.jsx("button",{type:"button",onClick:()=>H("receipt"),disabled:A,className:"w-8 h-8 rounded-lg flex items-center justify-center transition-colors hover:bg-red-500/20 disabled:opacity-50",style:{color:"var(--accent-red)"},title:"Eliminar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}):r?e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:"var(--bg-secondary)"},children:e.jsx("svg",{className:"w-5 h-5",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:r.name}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:ye(r.size)})]}),e.jsx("button",{type:"button",onClick:()=>{R(null),y.current&&(y.current.value="")},className:"w-8 h-8 rounded-lg flex items-center justify-center transition-colors hover:bg-red-500/20",style:{color:"var(--accent-red)"},children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):e.jsxs("button",{type:"button",onClick:()=>{var c;return(c=y.current)==null?void 0:c.click()},className:"w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 border-dashed transition-colors hover:border-[var(--accent-primary)]",style:{borderColor:"var(--border-subtle)",backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),"Adjuntar comprobante"]})]}),e.jsx("p",{className:"text-xs mb-4",style:{color:"var(--text-muted)"},children:"Maximo 5MB por archivo - Cualquier tipo de archivo"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:D,className:"flex-1 py-3 rounded-xl font-medium transition-colors hover:opacity-80",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},children:"Cerrar"}),E&&e.jsx("button",{onClick:B,disabled:A,className:"flex-1 py-3 rounded-xl font-medium text-white transition-colors hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"var(--accent-primary)"},children:A?"Guardando...":"Guardar"})]})]})]})}function Ve(){const{showError:S}=Se(),[D,T]=l.useState([]),[m,X]=l.useState([]),[L,A]=l.useState([]),[k,P]=l.useState(!0),[r,R]=l.useState(null),[d,y]=l.useState("ARS"),[V,B]=l.useState(!1),[H,U]=l.useState(!1),[i,E]=l.useState(null),[c,I]=l.useState(""),[N,w]=l.useState(""),[v,Z]=l.useState("ARS"),[O,G]=l.useState(!1),[o,q]=l.useState(null),[g,Y]=l.useState({}),[ve,ae]=l.useState(!1),[M,oe]=l.useState(null),[ge,_]=l.useState(!1);l.useEffect(()=>{ee()},[]);const ee=async()=>{try{P(!0);const[t,a]=await Promise.all([Me(),De()]),s=t.accounts||[],x=a.expenses||[],n=s.filter(C=>C.esTarjetaCredito);T(n),A(s),X(x),n.length>0&&!r&&R(n[0])}catch(t){console.error("Error fetching data:",t)}finally{P(!1)}};l.useEffect(()=>{r!=null&&r.id?Le(r.id).then(Y).catch(t=>console.error("Error loading statement attachments:",t)):Y({})},[r==null?void 0:r.id]);const fe=l.useMemo(()=>L.filter(t=>!t.esTarjetaCredito&&t.moneda==="Peso"),[L]),je=l.useMemo(()=>L.filter(t=>!t.esTarjetaCredito&&t.moneda!=="Peso"),[L]),le=l.useMemo(()=>{if(!r)return[];const t=r.diaCierre||1,a=m.filter(u=>u.cuenta===r.nombre);if(a.length===0)return[];const s=a.map(u=>new Date(u.fecha));new Date(Math.min(...s)),new Date(Math.max(...s));const x=u=>{const h=new Date(u),$=h.getDate();let W=h.getFullYear(),f=h.getMonth();return $>=t&&(f+=1,f>11&&(f=0,W+=1)),`${W}-${String(f+1).padStart(2,"0")}`},n={};a.forEach(u=>{const h=x(u.fecha);n[h]||(n[h]=[]),n[h].push(u)});const C=[],z=new Date;return Object.entries(n).forEach(([u,h])=>{const[$,W]=u.split("-").map(Number),f=new Date($,W-1,Math.min(t,new Date($,W,0).getDate()));let de=0,me=0;const te=[],re=[];h.forEach(j=>{let b=j.montoDolares;typeof b=="string"?b=parseFloat(b.replace(/[^\d,.-]/g,"").replace(",","."))||0:b=parseFloat(b)||0;const se=parseFloat(j.montoPesos)||0,ue=parseFloat(j.monto)||0,he=b>0&&se===0,pe={...j,isInstallment:!!j.cuota,monedaOriginal:he?"USD":"ARS",montoPesosNum:se||ue,montoDolaresNum:b};he?(me+=b,re.push(pe)):(de+=se||ue,te.push(pe))});const xe=[...te,...re].sort((j,b)=>new Date(j.fecha)-new Date(b.fecha)),J=h.find(j=>j.categoria&&j.categoria.includes("Impuesto de sellos"));C.push({id:u,year:$,month:W-1,monthName:F(f,"MMMM yyyy",{locale:K}),closeDate:f,totalPesos:de,totalDolares:me,items:xe,itemsPesos:te,itemsDolares:re,itemCount:xe.length,hasTax:!!J,taxAmount:J&&(J.montoPesos||J.monto)||0,isPast:f<z,isCurrent:Ae(f,z),isFuture:f>Pe(z)})}),C.sort((u,h)=>u.closeDate-h.closeDate)},[r,m]),be=async()=>{if(!(!i||!c||!r))try{G(!0);const t=F(i.closeDate,"yyyy-MM-dd");await ze({fecha:t,monto:parseFloat(c),cuenta:r.nombre,categoria:"猬锔 Impuesto de sellos",nota:`Impuesto de sellos - Resumen ${i.monthName}`}),B(!1),I(""),E(null),ee()}catch(t){console.error("Error adding tax:",t),S("No se pudo agregar el impuesto de sellos",t.message)}finally{G(!1)}},ke=async()=>{if(!i||!N||!r)return;const t=v==="ARS"?i.totalPesos:i.totalDolares;if(t<=0){S("No se puede realizar el pago",`No hay monto en ${v==="ARS"?"pesos":"d贸lares"} para pagar`);return}try{G(!0);const a=F(new Date,"yyyy-MM-dd"),s=v==="ARS"?"(Pesos)":"(D贸lares)";await We({fecha:a,cuentaSaliente:N,cuentaEntrante:r.nombre,montoSaliente:t,montoEntrante:t,nota:`Pago resumen ${i.monthName} ${s}`}),U(!1),w(""),E(null),ee()}catch(a){console.error("Error paying statement:",a),S("No se pudo registrar el pago del resumen",a.message)}finally{G(!1)}},ne=t=>{E(t),I(""),B(!0)},ce=t=>{E(t),w(""),Z(t.totalPesos>0?"ARS":"USD"),U(!0)},ie=t=>{oe(t),ae(!0)},Ne=async({statementFile:t,receiptFile:a})=>{if(!(!M||!r))try{_(!0);const s=M.id,x=g[s]||null,n=await Ie({accountId:r.id,period:s,statementFile:t,receiptFile:a,existing:x});Y(C=>({...C,[s]:n}))}catch(s){console.error("Error saving statement attachments:",s),S("No se pudieron guardar los adjuntos",s.message)}finally{_(!1)}},we=async t=>{if(!(!M||!r))try{_(!0);const a=M.id;await Fe({accountId:r.id,period:a,field:t}),Y(s=>{const x={...s};if(x[a]){const n={...x[a]};t==="statement"?(n.statementUrl=null,n.statementName=null):(n.receiptUrl=null,n.receiptName=null),!n.statementUrl&&!n.receiptUrl?delete x[a]:x[a]=n}return x})}catch(a){console.error("Error removing attachment:",a),S("No se pudo eliminar el adjunto",a.message)}finally{_(!1)}};return k?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(Re,{})}):D.length===0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:"Tarjetas de Cr茅dito"}),e.jsxs("div",{className:"rounded-2xl p-8 text-center",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-2xl flex items-center justify-center",style:{backgroundColor:"rgba(20, 184, 166, 0.15)"},children:e.jsx("svg",{className:"w-10 h-10",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Sin tarjetas de cr茅dito"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-secondary)"},children:'Agrega una cuenta con tipo "Tarjeta de cr茅dito" para ver los res煤menes'})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--text-primary)"},children:"Tarjetas de Cr茅dito"}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"inline-flex rounded-xl p-1",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsxs("button",{onClick:()=>y("ARS"),className:"px-3.5 py-1.5 rounded-lg text-xs font-semibold transition-all duration-300 active:scale-95 flex items-center gap-1.5",style:{backgroundColor:d==="ARS"?"var(--accent-primary)":"transparent",color:d==="ARS"?"white":"var(--text-secondary)",boxShadow:d==="ARS"?"0 4px 12px var(--accent-primary-glow)":"none"},children:[e.jsx("img",{src:"/icons/catalog/ARS.svg",alt:"ARS",className:"w-4 h-4 rounded-sm"}),"ARS"]}),e.jsxs("button",{onClick:()=>y("USD"),className:"px-3.5 py-1.5 rounded-lg text-xs font-semibold transition-all duration-300 active:scale-95 flex items-center gap-1.5",style:{backgroundColor:d==="USD"?"var(--accent-green)":"transparent",color:d==="USD"?"white":"var(--text-secondary)",boxShadow:d==="USD"?"0 4px 12px rgba(0, 217, 154, 0.3)":"none"},children:[e.jsx("img",{src:"/icons/catalog/USD.svg",alt:"USD",className:"w-4 h-4 rounded-sm"}),"USD"]})]})})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:D.map(t=>{const a=!!t.icon,s=a&&Be(t.icon);return e.jsx("button",{onClick:()=>R(t),className:`px-4 py-3 rounded-xl text-sm font-medium whitespace-nowrap transition-all duration-200 ${(r==null?void 0:r.nombre)===t.nombre?"scale-[1.02]":"opacity-70"}`,style:{backgroundColor:(r==null?void 0:r.nombre)===t.nombre?"var(--accent-primary)":"var(--bg-secondary)",color:(r==null?void 0:r.nombre)===t.nombre?"white":"var(--text-primary)"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[a?s?e.jsx("span",{className:"text-base",children:t.icon}):e.jsx("img",{src:Ue(t.icon),alt:t.nombre,className:"w-5 h-5 rounded object-cover"}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),t.nombre]})},t.nombre)})}),r&&e.jsx("div",{className:"rounded-2xl p-4",style:{backgroundColor:"var(--bg-secondary)"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide mb-1",style:{color:"var(--text-secondary)"},children:"D铆a de cierre"}),e.jsx("p",{className:"text-xl font-bold",style:{color:"var(--accent-primary)"},children:r.diaCierre||"No configurado"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide mb-1",style:{color:"var(--text-secondary)"},children:"Balance actual"}),e.jsx("p",{className:"text-xl font-bold",style:{color:"var(--accent-red)"},children:p(Math.abs(r.balanceActual||0),r.moneda==="Peso"?"ARS":"USD")})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",style:{color:"var(--text-primary)"},children:"Res煤menes"}),le.length===0?e.jsxs("div",{className:"text-center py-8",style:{color:"var(--text-secondary)"},children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("p",{className:"text-sm",children:"No hay res煤menes con gastos"})]}):le.map(t=>{var s,x;const a=t.totalPesos>0&&t.totalDolares>0;return e.jsxs("div",{className:"rounded-2xl overflow-hidden cursor-pointer active:scale-[0.98] transition-transform",style:{backgroundColor:"var(--bg-secondary)"},onClick:()=>q(t),children:[e.jsxs("div",{className:"p-4 flex items-center justify-between",style:{backgroundColor:t.isCurrent?"rgba(20, 184, 166, 0.15)":t.isFuture?"rgba(96, 165, 250, 0.1)":"transparent"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{backgroundColor:t.isCurrent?"var(--accent-primary)":t.isFuture?"var(--accent-blue)":"var(--bg-tertiary)"},children:e.jsx("svg",{className:"w-5 h-5",style:{color:t.isCurrent||t.isFuture?"white":"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold capitalize",style:{color:"var(--text-primary)"},children:[t.monthName,t.isCurrent&&e.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs",style:{backgroundColor:"var(--accent-primary)",color:"white"},children:"Actual"}),t.isFuture&&e.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs",style:{backgroundColor:"var(--accent-blue)",color:"white"},children:"Futuro"})]}),e.jsxs("div",{className:"flex items-center gap-1 mt-0.5 flex-wrap",children:[e.jsxs("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:[t.itemCount," movimiento",t.itemCount!==1?"s":""," 路 Cierra ",F(t.closeDate,"d MMM",{locale:K})]}),((s=g[t.id])==null?void 0:s.statementUrl)&&e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium",style:{backgroundColor:"rgba(239, 68, 68, 0.15)",color:"var(--accent-red)"},children:"PDF"}),((x=g[t.id])==null?void 0:x.receiptUrl)&&e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium",style:{backgroundColor:"rgba(34, 197, 94, 0.15)",color:"var(--accent-green)"},children:"Pagado"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-right",children:[a?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--accent-red)"},children:p(t.totalPesos,"ARS")}),e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--accent-green)"},children:p(t.totalDolares,"USD")})]}):e.jsx("p",{className:"text-lg font-bold",style:{color:t.totalPesos>0||t.totalDolares>0?"var(--accent-red)":"var(--text-secondary)"},children:t.totalPesos>0?p(t.totalPesos,"ARS"):p(t.totalDolares,"USD")}),t.hasTax&&e.jsx("p",{className:"text-xs",style:{color:"var(--accent-yellow)"},children:"Inc. imp. sellos"})]}),e.jsx("svg",{className:"w-5 h-5",style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),e.jsxs("div",{className:"px-4 py-3 flex gap-2",style:{borderTop:"1px solid var(--border-subtle)"},onClick:n=>n.stopPropagation(),children:[!t.hasTax&&e.jsxs("button",{onClick:()=>ne(t),className:"flex-1 py-2.5 rounded-xl text-xs font-medium transition-all duration-200 flex items-center justify-center gap-1.5",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--accent-yellow)"},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Imp. Sellos"]}),e.jsx("button",{onClick:()=>ie(t),className:"py-2.5 px-3 rounded-xl text-xs font-medium transition-all duration-200 flex items-center justify-center gap-1.5",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--accent-primary)"},title:"Adjuntos",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})}),e.jsxs("button",{onClick:()=>ce(t),className:"flex-1 py-2.5 rounded-xl text-xs font-medium text-white transition-all duration-200 flex items-center justify-center gap-1.5",style:{backgroundColor:"var(--accent-green)"},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),"Pagar Resumen"]})]})]},t.id)})]}),V&&i&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>B(!1)}),e.jsxs("div",{className:"relative w-full max-w-sm rounded-2xl p-6 animate-scale-in",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Agregar Impuesto de Sellos"}),e.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-secondary)"},children:["Resumen de ",e.jsx("span",{className:"font-medium capitalize",children:i.monthName})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Monto del impuesto"}),e.jsx("input",{type:"number",value:c,onChange:t=>I(t.target.value),placeholder:"0.00",className:"w-full px-4 py-3 rounded-xl text-lg",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"}})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>B(!1),className:"flex-1 py-3 rounded-xl font-medium transition-colors hover:opacity-80",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},children:"Cancelar"}),e.jsx("button",{onClick:be,disabled:O||!c,className:"flex-1 py-3 rounded-xl font-medium text-white transition-colors hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"var(--accent-yellow)"},children:O?"Guardando...":"Agregar"})]})]})]}),H&&i&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>U(!1)}),e.jsxs("div",{className:"relative w-full max-w-sm rounded-2xl p-6 animate-scale-in",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",style:{color:"var(--text-primary)"},children:"Pagar Resumen"}),e.jsxs("p",{className:"text-sm mb-4",style:{color:"var(--text-secondary)"},children:["Resumen de ",e.jsx("span",{className:"font-medium capitalize",children:i.monthName})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Seleccionar porci贸n a pagar"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{Z("ARS"),w("")},disabled:i.totalPesos<=0,className:`flex-1 p-3 rounded-xl text-left transition-all ${v==="ARS"?"ring-2":""} ${i.totalPesos<=0?"opacity-40 cursor-not-allowed":""}`,style:{backgroundColor:v==="ARS"?"rgba(20, 184, 166, 0.15)":"var(--bg-tertiary)",borderColor:"var(--accent-primary)","--tw-ring-color":"var(--accent-primary)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Pesos"}),e.jsx("p",{className:"text-lg font-bold",style:{color:v==="ARS"?"var(--accent-primary)":"var(--text-primary)"},children:p(i.totalPesos,"ARS")})]}),e.jsxs("button",{onClick:()=>{Z("USD"),w("")},disabled:i.totalDolares<=0,className:`flex-1 p-3 rounded-xl text-left transition-all ${v==="USD"?"ring-2":""} ${i.totalDolares<=0?"opacity-40 cursor-not-allowed":""}`,style:{backgroundColor:v==="USD"?"rgba(34, 197, 94, 0.15)":"var(--bg-tertiary)",borderColor:"var(--accent-green)","--tw-ring-color":"var(--accent-green)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"D贸lares"}),e.jsx("p",{className:"text-lg font-bold",style:{color:v==="USD"?"var(--accent-green)":"var(--text-primary)"},children:p(i.totalDolares,"USD")})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:["Pagar desde cuenta en ",v==="ARS"?"pesos":"d贸lares"]}),e.jsx(Ee,{value:N,onChange:w,options:(v==="ARS"?fe:je).map(t=>({value:t.nombre,label:t.nombre})),placeholder:"Seleccionar cuenta..."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>U(!1),className:"flex-1 py-3 rounded-xl font-medium transition-colors hover:opacity-80",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},children:"Cancelar"}),e.jsx("button",{onClick:ke,disabled:O||!N,className:"flex-1 py-3 rounded-xl font-medium text-white transition-colors hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"var(--accent-green)"},children:O?"Procesando...":"Pagar"})]})]})]}),o&&e.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col",style:{backgroundColor:"var(--bg-primary)"},children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 safe-area-top",style:{backgroundColor:"var(--bg-secondary)",borderBottom:"1px solid var(--border-subtle)"},children:[e.jsx("button",{onClick:()=>q(null),className:"w-10 h-10 rounded-xl flex items-center justify-center transition-colors",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("svg",{className:"w-5 h-5",style:{color:"var(--text-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"font-semibold capitalize",style:{color:"var(--text-primary)"},children:o.monthName}),e.jsxs("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:[r==null?void 0:r.nombre," 路 Cierra ",F(o.closeDate,"d MMM yyyy",{locale:K})]})]}),e.jsx("div",{className:"px-3 py-1.5 rounded-xl text-sm font-bold",style:{backgroundColor:"rgba(239, 68, 68, 0.15)",color:"var(--accent-red)"},children:o.totalPesos>0&&o.totalDolares>0?e.jsxs("div",{className:"flex flex-col items-end gap-0.5",children:[e.jsx("span",{children:p(o.totalPesos,"ARS")}),e.jsx("span",{style:{color:"var(--accent-green)"},children:p(o.totalDolares,"USD")})]}):o.totalPesos>0?p(o.totalPesos,"ARS"):p(o.totalDolares,"USD")})]}),g[o.id]&&e.jsxs("div",{className:"px-4 py-3 flex gap-2 flex-wrap",style:{borderBottom:"1px solid var(--border-subtle)"},children:[g[o.id].statementUrl&&e.jsxs("button",{onClick:()=>Q(g[o.id].statementUrl,g[o.id].statementName),className:"flex items-center gap-2 px-3 py-2 rounded-xl text-xs font-medium transition-colors hover:opacity-80",style:{backgroundColor:"rgba(239, 68, 68, 0.15)",color:"var(--accent-red)"},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Resumen PDF"]}),g[o.id].receiptUrl&&e.jsxs("button",{onClick:()=>Q(g[o.id].receiptUrl,g[o.id].receiptName),className:"flex items-center gap-2 px-3 py-2 rounded-xl text-xs font-medium transition-colors hover:opacity-80",style:{backgroundColor:"rgba(34, 197, 94, 0.15)",color:"var(--accent-green)"},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Comprobante"]})]}),o.totalPesos>0&&o.totalDolares>0&&e.jsx("div",{className:"px-4 py-3",style:{borderBottom:"1px solid var(--border-subtle)"},children:e.jsx("div",{className:"flex gap-2",children:["ARS","USD"].map(t=>{var a,s;return e.jsxs("button",{onClick:()=>y(t),className:`flex-1 py-2 rounded-xl text-sm font-medium transition-all flex items-center justify-center gap-2 ${d===t?"text-white":""}`,style:{backgroundColor:d===t?"var(--accent-primary)":"var(--bg-tertiary)",color:d===t?"white":"var(--text-secondary)"},children:[e.jsx("img",{src:`/icons/catalog/${t}.svg`,alt:t,className:"w-5 h-5 rounded-sm"}),t==="ARS"?`Pesos (${((a=o.itemsPesos)==null?void 0:a.length)||0})`:`D贸lares (${((s=o.itemsDolares)==null?void 0:s.length)||0})`]},t)})})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-4 space-y-2",children:(()=>{const a=o.totalPesos>0&&o.totalDolares>0?d==="ARS"?o.itemsPesos:o.itemsDolares:o.items;return a==null?void 0:a.map((s,x)=>{var z,u;const n=s.monedaOriginal||"ARS",C=n==="USD"?s.montoDolaresNum||s.montoDolares||0:s.montoPesosNum||s.montoPesos||s.monto||0;return e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("span",{className:"text-lg",children:((z=s.categoria)==null?void 0:z.split(" ")[0])||""})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium truncate",style:{color:"var(--text-primary)"},children:[((u=s.categoria)==null?void 0:u.replace(/^[^\s]+\s*/,""))||s.categoria||"Sin categor铆a",s.isInstallment&&e.jsx("span",{className:"ml-2 px-1.5 py-0.5 rounded text-xs",style:{backgroundColor:"rgba(20, 184, 166, 0.2)",color:"var(--accent-primary)"},children:s.cuota}),n==="USD"&&e.jsx("span",{className:"ml-2 px-1.5 py-0.5 rounded text-xs",style:{backgroundColor:"rgba(34, 197, 94, 0.2)",color:"var(--accent-green)"},children:"USD"})]}),s.nota&&e.jsx("p",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},children:s.nota}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:F(new Date(s.fecha),"d 'de' MMMM",{locale:K})})]}),e.jsx("div",{className:"text-right flex-shrink-0",children:e.jsx("p",{className:"text-sm font-bold",style:{color:n==="USD"?"var(--accent-green)":"var(--accent-red)"},children:p(C,n)})})]},x)})})()}),e.jsxs("div",{className:"px-4 py-4 safe-area-bottom flex gap-3",style:{backgroundColor:"var(--bg-secondary)",borderTop:"1px solid var(--border-subtle)"},children:[!o.hasTax&&e.jsxs("button",{onClick:()=>{ne(o),q(null)},className:"flex-1 py-3 rounded-xl font-medium transition-all duration-200 flex items-center justify-center gap-2",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--accent-yellow)"},children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Imp. Sellos"]}),e.jsx("button",{onClick:()=>{ie(o)},className:"py-3 px-4 rounded-xl font-medium transition-all duration-200 flex items-center justify-center gap-2",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--accent-primary)"},children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})}),e.jsxs("button",{onClick:()=>{ce(o),q(null)},className:"flex-1 py-3 rounded-xl font-medium text-white transition-all duration-200 flex items-center justify-center gap-2",style:{backgroundColor:"var(--accent-green)"},children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),"Pagar Resumen"]})]})]}),e.jsx($e,{isOpen:ve,onClose:()=>{ae(!1),oe(null)},statement:M,attachments:M?g[M.id]:null,onSave:Ne,onRemove:we,saving:ge})]})}export{Ve as default};
