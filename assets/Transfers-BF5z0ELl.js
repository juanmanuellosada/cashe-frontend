import{g as D,r as a,a3 as j,n as A,j as r,E as T,$ as I,a4 as p,a5 as k}from"./index-CKWgcbuo.js";import{M as C}from"./MovementsList-BhyvU6zd.js";import"./DateRangePicker-581Jnx40.js";import"./SortDropdown-8-fXskt5.js";function O(){const{showError:c}=D(),[w,l]=a.useState([]),[i,h]=a.useState([]),[v,d]=a.useState(!0),[u,o]=a.useState(null),[x,f]=a.useState(!1),[M,m]=a.useState(!1);a.useEffect(()=>{n()},[]);const n=async()=>{try{d(!0);const[e,t]=await Promise.all([j(),A()]);l(e.transfers||[]),h(t.accounts||[])}catch(e){console.error("Error fetching data:",e)}finally{d(!1)}},y=async e=>{try{f(!0),await k(e),o(null),await n()}catch(t){console.error("Error updating:",t),c("No se pudo guardar la transferencia",t.message)}finally{f(!1)}},g=async e=>{o(null),l(t=>t.filter(s=>s.rowIndex!==e.rowIndex));try{await p(e)}catch(t){console.error("Error deleting:",t),c("No se pudo eliminar la transferencia",t.message),n()}},E=async e=>{const t=new Set(e.map(s=>s.rowIndex));l(s=>s.filter(S=>!t.has(S.rowIndex)));for(const s of e)await p(s);n()};return r.jsxs(r.Fragment,{children:[r.jsx(C,{title:"Transferencias",movements:w,accounts:i,categories:[],loading:v,onMovementClick:o,onMovementDelete:g,onBulkDelete:E,onAddClick:()=>m(!0),type:"transferencia"}),u&&r.jsx(T,{movement:u,accounts:i,categories:{ingresos:[],gastos:[]},onSave:y,onDelete:g,onClose:()=>o(null),loading:x}),r.jsx(I,{isOpen:M,onClose:()=>{m(!1),n()},defaultType:"transfer"})]})}export{O as default};
