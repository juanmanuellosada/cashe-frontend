import{t as se,j as e,f as R,r as d,u as ce,i as re,a as oe,s as K,e as Q,b as $,c as ue,d as pe,g as he,h as ge,k as ve,l as ye,m as le,n as fe,L as ne,E as be,o as je,p as we,q as ke,D as _,v as X,w as Ne}from"./index-_HA-Y8BE.js";import{D as ie}from"./DateRangePicker-CSsnwuY8.js";import{P as Ce}from"./PullToRefresh-DD0O3L-B.js";import"./subMonths-C38azGfi.js";function Se(y,k,n){const b=+se(y,n==null?void 0:n.in),[p,S]=[+se(k.start,n==null?void 0:n.in),+se(k.end,n==null?void 0:n.in)].sort((m,r)=>m-r);return b>=p&&b<=S}function De({totalPesos:y,totalDolares:k,totalGeneralPesos:n,totalGeneralDolares:b,tipoCambio:p,currency:S="ARS",ingresosMes:m=0,gastosMes:r=0,ingresosMesDolares:h=0,gastosMesDolares:M=0}){const v=S==="ARS"?n:b,x=S==="ARS"?m:h,c=S==="ARS"?r:M,L=x-Math.abs(c);return e.jsxs("div",{className:"p-3 sm:p-4 rounded-xl",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[e.jsx("span",{className:"text-[11px] sm:text-xs",style:{color:"var(--text-muted)"},children:"Balance total"}),e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 rounded text-[9px] sm:text-[10px] font-medium",style:{backgroundColor:S==="ARS"?"var(--accent-primary-dim)":"var(--accent-green-dim)",color:S==="ARS"?"var(--accent-primary)":"var(--accent-green)"},children:S})]}),e.jsx("h2",{className:"text-xl sm:text-2xl font-medium tracking-tight mb-3 sm:mb-4",style:{color:"var(--text-primary)"},children:R(v,S)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3 mb-2 sm:mb-3",children:[e.jsxs("div",{className:"p-2 sm:p-3 rounded-lg",style:{backgroundColor:"var(--accent-green-dim)"},children:[e.jsx("p",{className:"text-[9px] sm:text-[10px] uppercase tracking-wide mb-0.5 sm:mb-1",style:{color:"var(--text-muted)"},children:"Ingresos"}),e.jsxs("p",{className:"text-xs sm:text-sm font-medium truncate",style:{color:"var(--accent-green)"},children:["+",R(Math.abs(x),S)]})]}),e.jsxs("div",{className:"p-2 sm:p-3 rounded-lg",style:{backgroundColor:"var(--accent-red-dim)"},children:[e.jsx("p",{className:"text-[9px] sm:text-[10px] uppercase tracking-wide mb-0.5 sm:mb-1",style:{color:"var(--text-muted)"},children:"Gastos"}),e.jsxs("p",{className:"text-xs sm:text-sm font-medium truncate",style:{color:"var(--accent-red)"},children:["-",R(Math.abs(c),S)]})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-1.5 sm:py-2",children:[e.jsx("span",{className:"text-[11px] sm:text-xs",style:{color:"var(--text-muted)"},children:"Flujo neto"}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium",style:{color:L>=0?"var(--accent-green)":"var(--accent-red)"},children:[L>=0?"+":"",R(L,S)]})]}),p&&e.jsxs("div",{className:"flex items-center justify-between pt-1.5 sm:pt-2 mt-1.5 sm:mt-2",style:{borderTop:"1px solid var(--border-subtle)"},children:[e.jsx("span",{className:"text-[11px] sm:text-xs",style:{color:"var(--text-muted)"},children:"Tipo de cambio"}),e.jsxs("span",{className:"text-[11px] sm:text-xs font-medium",style:{color:"var(--text-secondary)"},children:[R(p)," / USD"]})]})]})}function Me({accounts:y,loading:k,onAccountClick:n}){const[b,p]=d.useState(!0),S=ce();if(k)return e.jsx("div",{className:"card-glass overflow-hidden",children:e.jsxs("div",{className:"p-4 flex items-center justify-between",children:[e.jsx("div",{className:"h-4 w-24 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-4 w-16 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}})]})});if(!y||y.length===0)return null;const m=r=>{n&&n(r)};return e.jsxs("div",{className:"card-glass overflow-hidden transition-all duration-300",children:[e.jsxs("button",{onClick:()=>p(!b),className:"w-full px-3 py-3 sm:p-4 flex items-center justify-between text-left transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.99]",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-9 sm:h-9 rounded-lg sm:rounded-xl flex items-center justify-center",style:{backgroundColor:"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-4 h-4 sm:w-4.5 sm:h-4.5",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm sm:text-[15px]",style:{color:"var(--text-primary)"},children:"Cuentas"}),e.jsx("span",{className:"ml-1.5 sm:ml-2 text-[9px] sm:text-[10px] px-1.5 sm:px-2 py-0.5 rounded-full font-medium",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:y.length})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("span",{className:"text-[11px] sm:text-xs font-medium hidden sm:inline",style:{color:"var(--text-secondary)"},children:b?"Ocultar":"Ver todas"}),e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-md sm:rounded-lg flex items-center justify-center transition-colors",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("svg",{className:`w-3.5 h-3.5 sm:w-4 sm:h-4 transition-transform duration-300 ${b?"rotate-180":""}`,style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),b&&e.jsxs("div",{className:"animate-scale-in",style:{borderTop:"1px solid var(--border-subtle)"},children:[e.jsx("div",{className:"hidden lg:grid lg:grid-cols-2 xl:grid-cols-3 gap-px",style:{backgroundColor:"var(--border-subtle)"},children:y.map((r,h)=>{const M=r.moneda==="Peso",v=M?"#75AADB":"#3CB371",x=!!r.icon,c=x&&re(r.icon);return e.jsxs("button",{onClick:()=>m(r),className:"p-4 flex items-center gap-3 text-left transition-all duration-200 hover:bg-[var(--bg-tertiary)] group",style:{backgroundColor:"var(--bg-secondary)",animationDelay:`${h*50}ms`},children:[e.jsx("div",{className:"w-11 h-11 rounded-xl flex items-center justify-center flex-shrink-0 transition-transform duration-200 group-hover:scale-110 overflow-hidden",style:{backgroundColor:x&&!c?"transparent":`${v}15`,boxShadow:`0 0 20px ${v}10`},children:x?c?e.jsx("span",{className:"text-xl",children:r.icon}):e.jsx("img",{src:oe(r.icon),alt:r.nombre,className:"w-full h-full object-cover rounded-xl"}):e.jsx("span",{className:"text-sm font-bold",style:{color:v},children:M?"$":"US$"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold truncate text-[15px]",style:{color:"var(--text-primary)"},children:r.nombre}),e.jsxs("p",{className:"text-[11px] mt-0.5",style:{color:"var(--text-secondary)"},children:[M?"Pesos":"DÃ³lares",r.tipo&&` Â· ${r.tipo}`]})]}),e.jsx("div",{className:"text-right flex-shrink-0",children:e.jsx("p",{className:"font-bold text-[15px]",style:{color:v},children:R(r.balanceActual,M?"ARS":"USD")})})]},r.nombre)})}),e.jsx("div",{className:"lg:hidden overflow-hidden",children:y.map((r,h)=>{const M=r.moneda==="Peso",v=M?"#75AADB":"#3CB371",x=!!r.icon,c=x&&re(r.icon);return e.jsxs("button",{onClick:()=>m(r),className:"w-full px-3 py-2.5 flex items-start gap-2 text-left transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.99] group",style:{borderBottom:h<y.length-1?"1px solid var(--border-subtle)":"none"},children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5 overflow-hidden",style:{backgroundColor:x&&!c?"transparent":`${v}15`},children:x?c?e.jsx("span",{className:"text-lg",children:r.icon}):e.jsx("img",{src:oe(r.icon),alt:r.nombre,className:"w-full h-full object-cover rounded-lg"}):e.jsx("span",{className:"text-[11px] font-bold",style:{color:v},children:M?"$":"US$"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-[13px] leading-tight break-words",style:{color:"var(--text-primary)",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:r.nombre}),e.jsxs("p",{className:"text-[10px] mt-0.5",style:{color:"var(--text-secondary)"},children:[M?"Pesos":"DÃ³lares",r.tipo&&` Â· ${r.tipo}`]})]}),e.jsx("div",{className:"text-right flex-shrink-0",children:e.jsx("p",{className:"font-bold text-[13px]",style:{color:v},children:R(r.balanceActual,M?"ARS":"USD")})})]},r.nombre)})}),e.jsx("button",{onClick:()=>S("/cuentas"),className:"w-full py-2.5 sm:p-3.5 text-center text-xs sm:text-sm font-semibold transition-all duration-200 hover:bg-[var(--accent-primary-dim)] active:scale-[0.99]",style:{color:"var(--accent-primary)",borderTop:"1px solid var(--border-subtle)"},children:"Ver detalles de cuentas â†’"})]})]})}function Ee({movements:y,accounts:k=[],categories:n={ingresos:[],gastos:[]},loading:b}){var i,t,g,N,W,U;const[p,S]=d.useState("ARS"),[m,r]=d.useState(!1),[h,M]=d.useState(()=>{try{const l=localStorage.getItem("cashe_weekly_filters");if(l)return JSON.parse(l)}catch(l){console.warn("Error loading weekly filters:",l)}return{cuentas:[],categorias:[]}});d.useEffect(()=>{try{localStorage.setItem("cashe_weekly_filters",JSON.stringify(h))}catch(l){console.warn("Error saving weekly filters:",l)}},[h]);const v=n.gastos||[],x=[((i=h.cuentas)==null?void 0:i.length)>0,((t=h.categorias)==null?void 0:t.length)>0].filter(Boolean).length,c=d.useMemo(()=>{var P,I;if(!y||y.length===0)return null;const l=new Date,f=K(l,{weekStartsOn:1}),D=Q(l,{weekStartsOn:1});let j=y.filter(u=>{if(u.tipo!=="gasto")return!1;const C=new Date(u.fecha);return Se(C,{start:f,end:D})});if(((P=h.cuentas)==null?void 0:P.length)>0&&(j=j.filter(u=>h.cuentas.includes(u.cuenta))),((I=h.categorias)==null?void 0:I.length)>0&&(j=j.filter(u=>h.categorias.includes(u.categoria))),j.length===0)return{avgDaily:0,avgDailyDolares:0,maxDay:null,topCategory:null,totalWeek:0,totalWeekDolares:0,daysWithExpenses:0};const V=j.reduce((u,C)=>u+(C.montoPesos||C.monto||0),0),G=j.reduce((u,C)=>u+(C.montoDolares||0),0),z=new Set(j.map(u=>$(new Date(u.fecha),"yyyy-MM-dd"))).size,F=V/7,Y=G/7,H={};j.forEach(u=>{const C=$(new Date(u.fecha),"yyyy-MM-dd"),ee=$(new Date(u.fecha),"EEEE",{locale:ue});H[C]||(H[C]={name:ee,amount:0,amountDolares:0,date:C}),H[C].amount+=u.montoPesos||u.monto||0,H[C].amountDolares+=u.montoDolares||0});const J=Object.values(H).sort((u,C)=>C.amount-u.amount)[0]||null,B={};j.forEach(u=>{const C=u.categoria||"Sin categorÃ­a";B[C]||(B[C]={name:C,amount:0,amountDolares:0}),B[C].amount+=u.montoPesos||u.monto||0,B[C].amountDolares+=u.montoDolares||0});const q=Object.values(B).sort((u,C)=>C.amount-u.amount)[0]||null;return{avgDaily:F,avgDailyDolares:Y,maxDay:J,topCategory:q,totalWeek:V,totalWeekDolares:G,daysWithExpenses:z}},[y,h]),L=(l,f)=>{const D=h[l]||[];let j;D.includes(f)?j=D.filter(V=>V!==f):j=[...D,f],M(V=>({...V,[l]:j}))},A=(l,f)=>(h[l]||[]).includes(f),T=()=>{M({cuentas:[],categorias:[]})};if(b)return e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-md sm:rounded-lg skeleton-shimmer",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-4 w-24 sm:w-28 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}})]}),e.jsx("div",{className:"card-glass p-3 sm:p-4",children:e.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:[1,2,3].map(l=>e.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[e.jsx("div",{className:"h-2.5 sm:h-3 w-12 sm:w-16 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-4 sm:h-5 w-16 sm:w-20 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}})]},l))})})]});const o=l=>{const f=l==null?void 0:l.match(/^[\p{Emoji}\u200d]+/u);return f?f[0]:"ðŸ“Š"};return e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-md sm:rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("h3",{className:"text-sm sm:text-[15px] font-semibold",style:{color:"var(--text-primary)"},children:"Esta semana"})]}),e.jsxs("div",{className:"inline-flex rounded-lg sm:rounded-xl p-0.5 sm:p-1",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsxs("button",{onClick:()=>S("ARS"),className:"px-2 sm:px-3.5 py-1 sm:py-1.5 rounded-md sm:rounded-lg text-[11px] sm:text-xs font-semibold transition-all duration-300 active:scale-95 flex items-center gap-1 sm:gap-1.5",style:{backgroundColor:p==="ARS"?"var(--accent-primary)":"transparent",color:p==="ARS"?"white":"var(--text-secondary)",boxShadow:p==="ARS"?"0 4px 12px var(--accent-primary-glow)":"none"},children:[e.jsx("img",{src:"/icons/catalog/ARS.svg",alt:"ARS",className:"w-3.5 h-3.5 sm:w-4 sm:h-4 rounded-sm"}),"ARS"]}),e.jsxs("button",{onClick:()=>S("USD"),className:"px-2 sm:px-3.5 py-1 sm:py-1.5 rounded-md sm:rounded-lg text-[11px] sm:text-xs font-semibold transition-all duration-300 active:scale-95 flex items-center gap-1 sm:gap-1.5",style:{backgroundColor:p==="USD"?"var(--accent-green)":"transparent",color:p==="USD"?"white":"var(--text-secondary)",boxShadow:p==="USD"?"0 4px 12px rgba(0, 217, 154, 0.3)":"none"},children:[e.jsx("img",{src:"/icons/catalog/USD.svg",alt:"USD",className:"w-3.5 h-3.5 sm:w-4 sm:h-4 rounded-sm"}),"USD"]})]})]}),e.jsxs("button",{onClick:()=>r(!m),className:"flex items-center gap-2 px-3.5 py-2.5 rounded-xl text-sm transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.98]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),e.jsx("span",{className:"font-medium",children:"Filtros"}),x>0&&e.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold",style:{backgroundColor:"var(--accent-primary)",color:"white",boxShadow:"0 2px 8px var(--accent-primary-glow)"},children:x}),e.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${m?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),m&&e.jsxs("div",{className:"p-4 rounded-2xl space-y-4 animate-scale-in card-glass",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"Cuentas"}),e.jsx("button",{onClick:()=>{const l=k.map(D=>D.nombre),f=l.length>0&&l.every(D=>{var j;return(j=h.cuentas)==null?void 0:j.includes(D)});M(D=>({...D,cuentas:f?[]:l}))},className:"text-[10px] font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:k.length>0&&k.every(l=>{var f;return(f=h.cuentas)==null?void 0:f.includes(l.nombre)})?"Deseleccionar todos":"Seleccionar todos"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-28 overflow-y-auto custom-scrollbar",children:k.map(l=>{const f=A("cuentas",l.nombre);return e.jsx("button",{onClick:()=>L("cuentas",l.nombre),className:"px-3.5 py-2 rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:f?"var(--accent-primary)":"var(--bg-secondary)",color:f?"white":"var(--text-secondary)",boxShadow:f?"0 4px 16px var(--accent-primary-glow)":"none"},children:l.nombre},l.nombre)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"CategorÃ­as"}),(()=>{const l=v.map(D=>typeof D=="string"?D:D.value),f=l.length>0&&l.every(D=>{var j;return(j=h.categorias)==null?void 0:j.includes(D)});return e.jsx("button",{onClick:()=>{M(D=>({...D,categorias:f?[]:l}))},className:"text-[10px] font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:f?"Deseleccionar todos":"Seleccionar todos"})})()]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-28 overflow-y-auto custom-scrollbar",children:v.map(l=>{const f=typeof l=="string"?l:l.value,D=typeof l=="string"?l:l.label,j=A("categorias",f);return e.jsx("button",{onClick:()=>L("categorias",f),className:"px-3.5 py-2 rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:j?"var(--accent-red)":"var(--bg-secondary)",color:j?"white":"var(--text-secondary)",boxShadow:j?"0 4px 16px rgba(255, 92, 114, 0.3)":"none"},children:D},f)})})]}),x>0&&e.jsx("div",{className:"pt-3",style:{borderTop:"1px solid var(--border-subtle)"},children:e.jsxs("button",{onClick:T,className:"text-xs font-semibold flex items-center gap-1.5 transition-all duration-200 hover:opacity-80 active:scale-95",style:{color:"var(--accent-primary)"},children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Limpiar filtros"]})})]}),!c||c.totalWeek===0?e.jsxs("div",{className:"card-glass p-4 sm:p-6 text-center",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-2 sm:mb-3 rounded-lg sm:rounded-xl flex items-center justify-center",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("p",{className:"text-xs sm:text-sm font-medium",style:{color:"var(--text-secondary)"},children:x>0?"Sin gastos con estos filtros":"Sin gastos esta semana"})]}):e.jsx("div",{className:"card-glass p-3 sm:p-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:[e.jsxs("div",{className:"group p-2 sm:p-3 rounded-xl transition-all duration-200 hover:bg-[var(--bg-tertiary)]",children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 mb-1.5 sm:mb-2",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-md sm:rounded-lg flex items-center justify-center",style:{backgroundColor:"rgba(59, 130, 246, 0.15)"},children:e.jsx("svg",{className:"w-2.5 h-2.5 sm:w-3 sm:h-3",style:{color:"var(--accent-blue)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("span",{className:"text-[9px] sm:text-[10px] uppercase tracking-wider font-medium",style:{color:"var(--text-secondary)"},children:"Prom/dÃ­a"})]}),e.jsx("p",{className:"text-xs sm:text-base font-bold truncate",style:{color:"var(--accent-blue)"},children:R(p==="ARS"?c.avgDaily:c.avgDailyDolares,p)})]}),e.jsxs("div",{className:"group p-2 sm:p-3 rounded-xl transition-all duration-200 hover:bg-[var(--bg-tertiary)]",children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 mb-1.5 sm:mb-2",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-md sm:rounded-lg flex items-center justify-center",style:{backgroundColor:"rgba(255, 92, 114, 0.15)"},children:e.jsx("svg",{className:"w-2.5 h-2.5 sm:w-3 sm:h-3",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("span",{className:"text-[9px] sm:text-[10px] uppercase tracking-wider font-medium",style:{color:"var(--text-secondary)"},children:"DÃ­a pico"})]}),e.jsx("p",{className:"text-xs sm:text-sm font-bold capitalize truncate",style:{color:"var(--accent-red)"},children:((g=c.maxDay)==null?void 0:g.name)||"-"}),e.jsx("p",{className:"text-[10px] sm:text-[11px] mt-0.5 truncate",style:{color:"var(--text-secondary)"},children:c.maxDay?R(p==="ARS"?c.maxDay.amount:c.maxDay.amountDolares,p):"-"})]}),e.jsxs("div",{className:"group p-2 sm:p-3 rounded-xl transition-all duration-200 hover:bg-[var(--bg-tertiary)]",children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 mb-1.5 sm:mb-2",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-md sm:rounded-lg flex items-center justify-center text-[10px] sm:text-xs",style:{backgroundColor:"rgba(20, 184, 166, 0.15)"},children:o((N=c.topCategory)==null?void 0:N.name)}),e.jsx("span",{className:"text-[9px] sm:text-[10px] uppercase tracking-wider font-medium",style:{color:"var(--text-secondary)"},children:"Top"})]}),e.jsx("p",{className:"text-xs sm:text-sm font-bold truncate",style:{color:"var(--accent-primary)"},children:((U=(W=c.topCategory)==null?void 0:W.name)==null?void 0:U.replace(/^[\p{Emoji}\u200d]+\s*/u,"").trim())||"-"}),e.jsx("p",{className:"text-[10px] sm:text-[11px] mt-0.5 truncate",style:{color:"var(--text-secondary)"},children:c.topCategory?R(p==="ARS"?c.topCategory.amount:c.topCategory.amountDolares,p):"-"})]})]})})]})}function Ae({accounts:y=[],categories:k={ingresos:[],gastos:[]},filters:n,onFilterChange:b}){var v,x,c,L,A,T;const[p,S]=d.useState(!1);[...k.ingresos||[],...k.gastos||[]];const m=(o,i)=>{const t=n[o]||[];let g;t.includes(i)?g=t.filter(N=>N!==i):g=[...t,i],b==null||b({...n,[o]:g})},r=(o,i)=>(n[o]||[]).includes(i),h=[((v=n.tipos)==null?void 0:v.length)>0&&((x=n.tipos)==null?void 0:x.length)<3,((c=n.cuentas)==null?void 0:c.length)>0,((L=n.categorias)==null?void 0:L.length)>0].filter(Boolean).length,M=()=>{b==null||b({tipos:[],cuentas:[],categorias:[]})};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>S(!p),className:"flex items-center gap-2 px-3.5 py-2.5 rounded-xl text-sm transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.98]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),e.jsx("span",{className:"font-medium",children:"Filtros"}),h>0&&e.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold",style:{backgroundColor:"var(--accent-primary)",color:"white",boxShadow:"0 2px 8px var(--accent-primary-glow)"},children:h}),e.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${p?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p&&e.jsxs("div",{className:"p-4 rounded-2xl space-y-4 animate-scale-in card-glass",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[11px] font-semibold uppercase tracking-wider mb-2.5",style:{color:"var(--text-secondary)"},children:"Tipo de movimiento"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"ingreso",label:"Ingresos",color:"var(--accent-green)",glow:"rgba(0, 217, 154, 0.3)"},{value:"gasto",label:"Gastos",color:"var(--accent-red)",glow:"rgba(255, 92, 114, 0.3)"},{value:"transferencia",label:"Transferencias",color:"var(--accent-blue)",glow:"rgba(59, 130, 246, 0.3)"}].map(o=>{const i=r("tipos",o.value);return e.jsx("button",{onClick:()=>m("tipos",o.value),className:"px-3.5 py-2 rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:i?o.color:"var(--bg-secondary)",color:i?"white":"var(--text-secondary)",boxShadow:i?`0 4px 16px ${o.glow}`:"none"},children:o.label},o.value)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"Cuentas"}),e.jsx("button",{onClick:()=>{const o=y.map(t=>t.nombre),i=o.every(t=>{var g;return(g=n.cuentas)==null?void 0:g.includes(t)});b==null||b({...n,cuentas:i?[]:o})},className:"text-[10px] font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:y.length>0&&y.every(o=>{var i;return(i=n.cuentas)==null?void 0:i.includes(o.nombre)})?"Deseleccionar todos":"Seleccionar todos"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-28 overflow-y-auto custom-scrollbar",children:y.map(o=>{const i=r("cuentas",o.nombre);return e.jsx("button",{onClick:()=>m("cuentas",o.nombre),className:"px-3.5 py-2 rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:i?"var(--accent-primary)":"var(--bg-secondary)",color:i?"white":"var(--text-secondary)",boxShadow:i?"0 4px 16px var(--accent-primary-glow)":"none"},children:o.nombre},o.nombre)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2.5",children:[e.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"CategorÃ­as"}),(()=>{const o=[...(k.ingresos||[]).map(t=>typeof t=="string"?t:t.value),...(k.gastos||[]).map(t=>typeof t=="string"?t:t.value)],i=o.length>0&&o.every(t=>{var g;return(g=n.categorias)==null?void 0:g.includes(t)});return e.jsx("button",{onClick:()=>{b==null||b({...n,categorias:i?[]:o})},className:"text-[10px] font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:i?"Deseleccionar todos":"Seleccionar todos"})})()]}),e.jsxs("div",{className:"flex flex-wrap gap-2 max-h-36 overflow-y-auto custom-scrollbar",children:[((A=k.ingresos)==null?void 0:A.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-full text-[10px] font-semibold uppercase tracking-wider",style:{color:"var(--accent-green)"},children:"Ingresos:"}),k.ingresos.map(o=>{const i=typeof o=="string"?o:o.value,t=typeof o=="string"?o:o.label,g=r("categorias",i);return e.jsx("button",{onClick:()=>m("categorias",i),className:"px-3.5 py-2 rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:g?"var(--accent-green)":"var(--bg-secondary)",color:g?"white":"var(--text-secondary)",boxShadow:g?"0 4px 16px rgba(0, 217, 154, 0.3)":"none"},children:t},i)})]}),((T=k.gastos)==null?void 0:T.length)>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"w-full text-[10px] font-semibold uppercase tracking-wider mt-2",style:{color:"var(--accent-red)"},children:"Gastos:"}),k.gastos.map(o=>{const i=typeof o=="string"?o:o.value,t=typeof o=="string"?o:o.label,g=r("categorias",i);return e.jsx("button",{onClick:()=>m("categorias",i),className:"px-3.5 py-2 rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:g?"var(--accent-red)":"var(--bg-secondary)",color:g?"white":"var(--text-secondary)",boxShadow:g?"0 4px 16px rgba(255, 92, 114, 0.3)":"none"},children:t},i)})]})]})]}),h>0&&e.jsx("div",{className:"pt-3",style:{borderTop:"1px solid var(--border-subtle)"},children:e.jsxs("button",{onClick:M,className:"text-xs font-semibold flex items-center gap-1.5 transition-all duration-200 hover:opacity-80 active:scale-95",style:{color:"var(--accent-primary)"},children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Limpiar filtros"]})})]})]})}function Le({movements:y,dateRange:k,onDateRangeChange:n,filters:b,onFilterChange:p,accounts:S,categories:m,onMovementClick:r,onMovementDelete:h,loading:M=!1,currency:v="ARS"}){const[x,c]=d.useState(null),L=t=>{switch(t){case"ingreso":return{color:"var(--accent-green)",bgColor:"rgba(0, 217, 154, 0.12)",glowColor:"rgba(0, 217, 154, 0.3)",prefix:"+",icon:"up"};case"gasto":return{color:"var(--accent-red)",bgColor:"rgba(255, 92, 114, 0.12)",glowColor:"rgba(255, 92, 114, 0.3)",prefix:"-",icon:"down"};case"transferencia":return{color:"var(--accent-blue)",bgColor:"rgba(59, 130, 246, 0.12)",glowColor:"rgba(59, 130, 246, 0.3)",prefix:"",icon:"transfer"};default:return{color:"var(--accent-blue)",bgColor:"rgba(59, 130, 246, 0.12)",glowColor:"rgba(59, 130, 246, 0.3)",prefix:"",icon:"down"}}},A=(t,g)=>{t.stopPropagation(),c(g)},T=()=>{x&&(h==null||h(x),c(null))},o=(t,g)=>{const N="w-4 h-4 sm:w-5 sm:h-5";return t==="transferencia"?e.jsx("svg",{className:N,style:{color:g},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}):t==="ingreso"?e.jsx("svg",{className:N,style:{color:g},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})}):e.jsx("svg",{className:N,style:{color:g},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})},i=()=>e.jsx("div",{className:"card-glass overflow-hidden",children:[1,2,3].map(t=>e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 px-3 py-2.5 sm:p-4",style:{borderBottom:t<3?"1px solid var(--border-subtle)":"none"},children:[e.jsx("div",{className:"w-9 h-9 sm:w-11 sm:h-11 rounded-lg sm:rounded-xl skeleton-shimmer",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsxs("div",{className:"flex-1 space-y-2 sm:space-y-2.5",children:[e.jsx("div",{className:"h-3.5 sm:h-4 w-20 sm:w-28 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-2.5 sm:h-3 w-24 sm:w-36 skeleton-shimmer rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"}})]}),e.jsxs("div",{className:"text-right space-y-2 sm:space-y-2.5",children:[e.jsx("div",{className:"h-4 sm:h-5 w-16 sm:w-24 skeleton-shimmer rounded-lg ml-auto",style:{backgroundColor:"var(--bg-tertiary)"}}),e.jsx("div",{className:"h-2.5 sm:h-3 w-12 sm:w-16 skeleton-shimmer rounded-lg ml-auto",style:{backgroundColor:"var(--bg-tertiary)"}})]})]},t))});return e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 sm:gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-md sm:rounded-lg flex items-center justify-center",style:{backgroundColor:"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsx("h3",{className:"text-sm sm:text-[15px] font-semibold",style:{color:"var(--text-primary)"},children:"Movimientos"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{value:k,onChange:n,defaultPreset:"Esta semana"}),(k.from||k.to)&&e.jsx("button",{onClick:()=>n({from:null,to:null}),className:"p-1.5 rounded-lg transition-colors hover:opacity-80",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-muted)"},title:"Limpiar fechas",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsx(Ae,{accounts:S,categories:m,filters:b,onFilterChange:p}),M?i():!y||y.length===0?e.jsxs("div",{className:"card-glass p-6 sm:p-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 rounded-xl sm:rounded-2xl flex items-center justify-center",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("svg",{className:"w-6 h-6 sm:w-8 sm:h-8",style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsx("p",{className:"font-semibold text-sm sm:text-base mb-0.5 sm:mb-1",style:{color:"var(--text-primary)"},children:"Sin movimientos"}),e.jsx("p",{className:"text-xs sm:text-sm",style:{color:"var(--text-secondary)"},children:"No hay movimientos en este periodo"})]}):e.jsx("div",{className:"card-glass overflow-hidden",children:y.map((t,g)=>{const N=L(t.tipo);return e.jsxs("div",{className:`group flex items-center gap-2 sm:gap-3 px-3 py-2.5 sm:p-4 transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.995] ${g!==y.length-1?"border-b":""}`,style:{borderColor:"var(--border-subtle)"},children:[e.jsxs("button",{onClick:()=>r==null?void 0:r(t),className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0 text-left transition-transform duration-200",style:{backgroundColor:"transparent"},children:[e.jsx("div",{className:"w-9 h-9 sm:w-11 sm:h-11 rounded-lg sm:rounded-xl flex items-center justify-center flex-shrink-0 transition-all duration-200 group-hover:scale-110",style:{backgroundColor:N.bgColor,boxShadow:`0 0 0 ${N.glowColor}`},onMouseEnter:W=>W.currentTarget.style.boxShadow=`0 0 20px ${N.glowColor}`,onMouseLeave:W=>W.currentTarget.style.boxShadow=`0 0 0 ${N.glowColor}`,children:o(t.tipo,N.color)}),e.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("p",{className:"font-semibold truncate text-sm sm:text-[15px]",style:{color:"var(--text-primary)"},children:t.tipo==="transferencia"?"Transferencia":t.categoria||""}),t.cuota&&e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 rounded-md sm:rounded-lg text-[9px] sm:text-[10px] font-semibold flex-shrink-0",style:{backgroundColor:"rgba(20, 184, 166, 0.12)",color:"var(--accent-primary)"},children:t.cuota})]}),e.jsx("p",{className:"text-[11px] sm:text-xs truncate mt-0.5",style:{color:"var(--text-secondary)"},children:t.tipo==="transferencia"?`${t.cuentaSaliente} â†’ ${t.cuentaEntrante}`:t.cuenta})]}),e.jsxs("div",{className:"text-right flex-shrink-0 pl-1",children:[e.jsx("p",{className:"font-bold text-sm sm:text-lg",style:{color:N.color},children:t.tipo==="transferencia"?R(v==="ARS"?t.montoSaliente:t.montoSalienteDolares||0,v):`${N.prefix}${R(v==="ARS"?t.montoPesos||t.monto:t.montoDolares||0,v)}`}),e.jsx("p",{className:"text-[10px] sm:text-[11px] mt-0.5",style:{color:"var(--text-secondary)"},children:pe(t.fecha,"short")})]})]}),e.jsx("button",{onClick:W=>A(W,t),className:"p-2 sm:p-2.5 rounded-lg sm:rounded-xl flex-shrink-0 transition-all duration-200 hover:bg-red-500/15 active:scale-95",style:{color:"var(--text-muted)"},title:"Eliminar",children:e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-colors hover:text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},t.rowIndex||g)})}),y&&y.length>0&&e.jsxs("p",{className:"text-[10px] sm:text-[11px] text-center font-medium",style:{color:"var(--text-secondary)"},children:["Mostrando ",y.length," movimiento",y.length!==1?"s":""]}),x&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-md animate-fade-in",onClick:()=>c(null)}),e.jsx("div",{className:"relative w-full max-w-sm rounded-2xl p-6 animate-scale-in card-elevated",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center",style:{backgroundColor:"rgba(255, 92, 114, 0.12)",boxShadow:"0 0 30px rgba(255, 92, 114, 0.2)"},children:e.jsx("svg",{className:"w-8 h-8",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("h3",{className:"text-lg font-bold font-display mb-2",style:{color:"var(--text-primary)"},children:"Eliminar movimiento"}),e.jsxs("p",{className:"text-sm mb-5",style:{color:"var(--text-secondary)"},children:["Â¿EstÃ¡s seguro de que quieres eliminar ",x.tipo==="transferencia"?"esta":"este"," ",x.tipo,"?",e.jsx("br",{}),e.jsx("span",{className:"font-bold text-base mt-1 inline-block",style:{color:L(x.tipo).color},children:x.tipo==="transferencia"?R(x.montoSaliente):R(x.montoPesos||x.monto)})," - ",x.tipo==="transferencia"?`${x.cuentaSaliente} â†’ ${x.cuentaEntrante}`:x.categoria]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>c(null),className:"flex-1 py-3.5 rounded-xl font-semibold transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.98]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},children:"Cancelar"}),e.jsx("button",{onClick:T,className:"flex-1 py-3.5 rounded-xl font-semibold text-white transition-all duration-200 hover:opacity-90 active:scale-[0.98]",style:{backgroundColor:"var(--accent-red)",boxShadow:"0 4px 20px rgba(255, 92, 114, 0.3)"},children:"Eliminar"})]})]})})]})]})}function Ie(){const y=ce(),{showError:k}=he(),[n,b]=d.useState("ARS"),[p,S]=d.useState({from:ve(new Date),to:ge(new Date)}),[m,r]=d.useState(()=>{try{const s=localStorage.getItem("cashe_home_balance_accounts");if(s)return JSON.parse(s)}catch(s){console.warn("Error loading balance account filters:",s)}return[]});d.useEffect(()=>{try{localStorage.setItem("cashe_home_balance_accounts",JSON.stringify(m))}catch(s){console.warn("Error saving balance account filters:",s)}},[m]);const[h,M]=d.useState(!1),[v,x]=d.useState(()=>{try{const s=localStorage.getItem("cashe_home_movement_dates");if(s){const a=JSON.parse(s);return{from:a.from?new Date(a.from):K(new Date,{weekStartsOn:1}),to:a.to?new Date(a.to):Q(new Date,{weekStartsOn:1})}}}catch(s){console.warn("Error loading saved date range:",s)}return{from:K(new Date,{weekStartsOn:1}),to:Q(new Date,{weekStartsOn:1})}});d.useEffect(()=>{var s,a;try{localStorage.setItem("cashe_home_movement_dates",JSON.stringify({from:((s=v.from)==null?void 0:s.toISOString())||null,to:((a=v.to)==null?void 0:a.toISOString())||null}))}catch(E){console.warn("Error saving date range:",E)}},[v]);const[c,L]=d.useState(()=>{try{const s=localStorage.getItem("cashe_home_filters");if(s){const a=JSON.parse(s);return{tipos:a.tipos||[],cuentas:a.cuentas||[],categorias:a.categorias||[]}}}catch(s){console.warn("Error loading saved filters:",s)}return{tipos:[],cuentas:[],categorias:[]}});d.useEffect(()=>{try{localStorage.setItem("cashe_home_filters",JSON.stringify(c))}catch(s){console.warn("Error saving filters:",s)}},[c]);const[A,T]=d.useState(null),[o,i]=d.useState([]),[t,g]=d.useState([]),[N,W]=d.useState([]),[U,l]=d.useState({ingresos:[],gastos:[]}),[f,D]=d.useState(!0),[j,V]=d.useState(!0),[G,z]=d.useState(!0),[F,Y]=d.useState(!0),[H,Z]=d.useState(null),[J,B]=d.useState(null),[te,q]=d.useState(!1);d.useEffect(()=>{async function s(){try{const[a,E]=await Promise.all([je(),we()]);W(a.accounts||[]),l(E.categorias||{ingresos:[],gastos:[]})}catch(a){console.error("Error fetching initial data:",a)}finally{Y(!1)}}s()},[]);const P=d.useCallback(async()=>{try{D(!0);const s=await ye({fromDate:p.from?$(p.from,"yyyy-MM-dd"):null,toDate:p.to?$(p.to,"yyyy-MM-dd"):null});T(s.dashboard),Z(null)}catch(s){Z(s.message),console.error("Error fetching dashboard:",s)}finally{D(!1)}},[p]);d.useEffect(()=>{P()},[P]);const I=d.useCallback(async()=>{try{V(!0);const s=await le({fromDate:v.from?$(v.from,"yyyy-MM-dd"):null,toDate:v.to?$(v.to,"yyyy-MM-dd"):null,tipos:c.tipos,cuentas:c.cuentas,categorias:c.categorias});i(s.movements||[])}catch(s){console.error("Error fetching movements:",s)}finally{V(!1)}},[v,c]);d.useEffect(()=>{I()},[I]);const u=d.useCallback(async()=>{try{z(!0);const s=K(new Date,{weekStartsOn:1}),a=Q(new Date,{weekStartsOn:1}),E=await le({fromDate:$(s,"yyyy-MM-dd"),toDate:$(a,"yyyy-MM-dd"),tipos:[],cuentas:[],categorias:[]});g(E.movements||[])}catch(s){console.error("Error fetching weekly movements:",s)}finally{z(!1)}},[]);d.useEffect(()=>{u()},[u]);const C=d.useCallback(async()=>{await Promise.all([P(),I(),u()])},[P,I,u]);fe(_.ALL_DATA_CHANGED,C);const ee=async s=>{try{q(!0),await Ne(s),B(null);const a=s.tipo==="ingreso"?_.INCOMES_CHANGED:s.tipo==="gasto"?_.EXPENSES_CHANGED:_.TRANSFERS_CHANGED;X(a),X(_.ACCOUNTS_CHANGED),await Promise.all([P(),I(),u()])}catch(a){console.error("Error updating movement:",a),k("No se pudo guardar el movimiento",a.message)}finally{q(!1)}},ae=async s=>{B(null),i(a=>a.filter(E=>!(E.tipo===s.tipo&&E.rowIndex===s.rowIndex))),g(a=>a.filter(E=>!(E.tipo===s.tipo&&E.rowIndex===s.rowIndex)));try{await ke(s);const a=s.tipo==="ingreso"?_.INCOMES_CHANGED:s.tipo==="gasto"?_.EXPENSES_CHANGED:_.TRANSFERS_CHANGED;X(a),X(_.ACCOUNTS_CHANGED),await Promise.all([P(),I(),u()])}catch(a){console.error("Error deleting movement:",a),k("No se pudo eliminar el movimiento",a.message),await Promise.all([I(),u()])}},de=s=>{B(null),y("/nuevo",{state:{prefill:s}})},O=m.length>0?N.filter(s=>m.includes(s.nombre)):N,me={totalPesos:O.filter(s=>s.moneda==="Peso").reduce((s,a)=>s+(a.balanceActual||0),0),totalDolares:O.filter(s=>s.moneda==="DÃ³lar").reduce((s,a)=>s+(a.balanceActual||0),0),totalGeneralPesos:O.filter(s=>s.moneda==="Peso").reduce((s,a)=>s+(a.balanceActual||0),0)+O.filter(s=>s.moneda==="DÃ³lar").reduce((s,a)=>s+(a.balanceActual||0),0)*((A==null?void 0:A.tipoCambio)||1e3),totalGeneralDolares:O.filter(s=>s.moneda==="DÃ³lar").reduce((s,a)=>s+(a.balanceActual||0),0)+O.filter(s=>s.moneda==="Peso").reduce((s,a)=>s+(a.balanceActual||0),0)/((A==null?void 0:A.tipoCambio)||1e3),ingresosMes:O.reduce((s,a)=>s+(a.totalIngresos||0),0),gastosMes:O.reduce((s,a)=>s+(a.totalGastos||0),0)},w=m.length>0?{...A,...me}:A;return F&&f?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(ne,{size:"lg"})}):H&&!A?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] gap-4",children:[e.jsxs("p",{style:{color:"var(--accent-red)"},children:["Error: ",H]}),e.jsx("button",{onClick:P,className:"px-4 py-2 rounded-lg font-medium",style:{backgroundColor:"var(--accent-primary)",color:"white"},children:"Reintentar"})]}):e.jsx(Ce,{onRefresh:C,disabled:f&&j,children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2 sm:gap-3",children:[e.jsx("h1",{className:"text-base sm:text-lg font-medium",style:{color:"var(--text-primary)"},children:"Dashboard"}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsxs("div",{className:"inline-flex p-0.5 sm:p-1 rounded-md sm:rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsxs("button",{onClick:()=>b("ARS"),className:"px-2 sm:px-3 py-1 sm:py-1.5 rounded-md text-[11px] sm:text-xs font-medium transition-colors duration-150 flex items-center gap-1 sm:gap-1.5",style:{backgroundColor:n==="ARS"?"var(--bg-elevated)":"transparent",color:n==="ARS"?"var(--text-primary)":"var(--text-muted)"},children:[e.jsx("img",{src:"/icons/catalog/ARS.svg",alt:"ARS",className:"w-3.5 h-3.5 sm:w-4 sm:h-4 rounded-sm"}),"ARS"]}),e.jsxs("button",{onClick:()=>b("USD"),className:"px-2 sm:px-3 py-1 sm:py-1.5 rounded-md text-[11px] sm:text-xs font-medium transition-colors duration-150 flex items-center gap-1 sm:gap-1.5",style:{backgroundColor:n==="USD"?"var(--bg-elevated)":"transparent",color:n==="USD"?"var(--text-primary)":"var(--text-muted)"},children:[e.jsx("img",{src:"/icons/catalog/USD.svg",alt:"USD",className:"w-3.5 h-3.5 sm:w-4 sm:h-4 rounded-sm"}),"USD"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{value:p,onChange:S,defaultPreset:"Este mes"}),(p.from||p.to)&&e.jsx("button",{onClick:()=>S({from:null,to:null}),className:"p-1.5 rounded-lg transition-colors hover:opacity-80",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-muted)"},title:"Limpiar fechas",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),f?e.jsx("div",{className:"rounded-xl p-12 flex items-center justify-center",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-subtle)"},children:e.jsx(ne,{})}):e.jsxs("div",{className:"space-y-3",children:[e.jsx(De,{totalPesos:w==null?void 0:w.totalPesos,totalDolares:w==null?void 0:w.totalDolares,totalGeneralPesos:w==null?void 0:w.totalGeneralPesos,totalGeneralDolares:w==null?void 0:w.totalGeneralDolares,tipoCambio:w==null?void 0:w.tipoCambio,currency:n,ingresosMes:w==null?void 0:w.ingresosMes,gastosMes:w==null?void 0:w.gastosMes,ingresosMesDolares:w==null?void 0:w.ingresosMesDolares,gastosMesDolares:w==null?void 0:w.gastosMesDolares}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>M(!h),className:"flex items-center gap-2 px-3.5 py-2.5 rounded-xl text-sm transition-all duration-200 hover:bg-[var(--bg-tertiary)] active:scale-[0.98]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.75,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),e.jsx("span",{className:"font-medium",children:"Filtrar cuentas"}),m.length>0&&e.jsx("span",{className:"px-2 py-0.5 rounded-lg text-[10px] font-bold",style:{backgroundColor:"var(--accent-primary)",color:"white",boxShadow:"0 2px 8px var(--accent-primary-glow)"},children:m.length}),e.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${h?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),h&&e.jsxs("div",{className:"p-4 rounded-2xl space-y-3 animate-scale-in card-glass",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-[11px] font-semibold uppercase tracking-wider",style:{color:"var(--text-secondary)"},children:"Cuentas incluidas en el balance"}),e.jsx("button",{onClick:()=>{const s=N.map(E=>E.nombre),a=s.length>0&&s.every(E=>m.includes(E));r(a?[]:s)},className:"text-[10px] font-semibold transition-colors hover:opacity-80",style:{color:"var(--accent-primary)"},children:N.length>0&&N.every(s=>m.includes(s.nombre))?"Deseleccionar todos":"Seleccionar todos"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-32 overflow-y-auto custom-scrollbar",children:N.map(s=>{const a=m.length===0||m.includes(s.nombre);return e.jsx("button",{onClick:()=>{if(m.length===0)r([s.nombre]);else if(m.includes(s.nombre)){const E=m.filter(xe=>xe!==s.nombre);r(E.length===0?[]:E)}else r([...m,s.nombre])},className:"px-3.5 py-2 rounded-xl text-xs font-semibold transition-all duration-200 active:scale-95",style:{backgroundColor:a?"var(--accent-primary)":"var(--bg-secondary)",color:a?"white":"var(--text-secondary)",boxShadow:a?"0 4px 16px var(--accent-primary-glow)":"none",opacity:m.length===0?.7:1},children:s.nombre},s.nombre)})}),m.length>0&&e.jsx("div",{className:"pt-2",style:{borderTop:"1px solid var(--border-subtle)"},children:e.jsxs("button",{onClick:()=>r([]),className:"text-xs font-semibold flex items-center gap-1.5 transition-all duration-200 hover:opacity-80 active:scale-95",style:{color:"var(--accent-primary)"},children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Mostrar todas las cuentas"]})})]})]})]}),e.jsx(Me,{accounts:O,loading:F,onAccountClick:s=>{L(a=>({...a,cuentas:[s.nombre]}))}}),e.jsx(Ee,{movements:t,accounts:N,categories:U,loading:G}),e.jsx(Le,{movements:o,dateRange:v,onDateRangeChange:x,filters:c,onFilterChange:L,accounts:N,categories:U,onMovementClick:B,onMovementDelete:ae,loading:j,currency:n}),J&&e.jsx(be,{movement:J,accounts:N,categories:U,onSave:ee,onDelete:ae,onDuplicate:de,onClose:()=>B(null),onConvertedToRecurring:C,loading:te})]})})}export{Ie as default};
