import{n as ue,F as pe,r as l,w as he,O as ve,x as ge,j as e,a as Y,P as Z,i as ee,f as u,C as ye,Q as fe,R as be,S as je,D as M}from"./index-Bs2UX6zf.js";import{S as Ne}from"./SortDropdown-Btclsvrh.js";import{A as se}from"./AccountModal-DwAZtxQt.js";import"./IconPicker-C--J0SDq.js";function De(){const{showError:t}=ue(),T=pe(),[m,O]=l.useState([]),[C,w]=l.useState(!0),[k,f]=l.useState(null),[E,j]=l.useState(!1),[v,p]=l.useState(!1),[N,V]=l.useState({}),[g,L]=l.useState("original"),[n,h]=l.useState(null),[y,J]=l.useState(!1),[x,S]=l.useState(new Set),[re,$]=l.useState(!1),I="cashe-sort-accounts",[A,Q]=l.useState({sortBy:"balance",sortOrder:"desc"}),ae=[{id:"balance",label:"Saldo",defaultOrder:"desc"},{id:"name",label:"Nombre",defaultOrder:"asc"},{id:"type",label:"Tipo",defaultOrder:"asc"},{id:"currency",label:"Moneda",defaultOrder:"asc"}];l.useEffect(()=>{const s=localStorage.getItem(I);if(s)try{const r=JSON.parse(s);r.sortBy&&r.sortOrder&&Q(r)}catch(r){console.error("Error parsing sort preference:",r)}},[]),l.useEffect(()=>{localStorage.setItem(I,JSON.stringify(A))},[A]),l.useEffect(()=>{b(!0)},[T.key]),l.useEffect(()=>{const s=()=>{document.visibilityState==="visible"&&b(!0)},r=a=>{a.persisted&&b(!0)};return document.addEventListener("visibilitychange",s),window.addEventListener("pageshow",r),()=>{document.removeEventListener("visibilitychange",s),window.removeEventListener("pageshow",r)}},[]);const te=l.useCallback(()=>{b(!0)},[]);he([M.ACCOUNTS_CHANGED,M.EXPENSES_CHANGED,M.INCOMES_CHANGED,M.TRANSFERS_CHANGED],te);const b=async(s=!1)=>{try{w(!0),s&&ve();const r=await ge();O(r.accounts||[])}catch(r){console.error("Error fetching accounts:",r)}finally{w(!1)}},X=l.useMemo(()=>m.filter(s=>!s.esTarjetaCredito).reduce((s,r)=>{const a=r.balanceActual||0,o=r.tipoCambio||1e3;return g==="original"||g==="ARS"?r.moneda==="Peso"?s+a:s+a*o:r.moneda==="Peso"?s+a/o:s+a},0),[m,g]),U=l.useMemo(()=>{const s=[...m],{sortBy:r,sortOrder:a}=A,o=a==="asc"?1:-1;return s.sort((i,c)=>{let d=0;switch(r){case"balance":const D=i.balanceActual||0,B=c.balanceActual||0,G=i.tipoCambio||1e3,_=c.tipoCambio||1e3,K=i.moneda==="Peso"?D:D*G,q=c.moneda==="Peso"?B:B*_;d=K-q;break;case"name":d=(i.nombre||"").localeCompare(c.nombre||"");break;case"type":d=(i.tipo||"").localeCompare(c.tipo||"");break;case"currency":d=(i.moneda||"").localeCompare(c.moneda||"");break;default:d=0}return d*o}),s},[m,A]),P=s=>{const r=s.balanceActual||0,a=s.tipoCambio||1e3,o=s.moneda==="Peso";return g==="original"?{value:r,currency:o?"ARS":"USD"}:g==="ARS"?{value:o?r:r*a,currency:"ARS"}:{value:o?r/a:r,currency:"USD"}},le=async s=>{try{p(!0),await fe(s),j(!1),await b()}catch(r){console.error("Error adding account:",r),t("No se pudo crear la cuenta",r.message)}finally{p(!1)}},R=async s=>{try{p(!0),await ye(s),f(null),await b()}catch(r){console.error("Error updating account:",r),t("No se pudo guardar la cuenta",r.message)}finally{p(!1)}},ne=async s=>{h(s)},oe=async()=>{if(n)try{p(!0),await be(n.id),h(null),f(null),await b()}catch(s){console.error("Error deleting account:",s),t("No se pudo eliminar la cuenta",s.message)}finally{p(!1)}},ie=()=>{J(!y),S(new Set)},z=s=>{S(r=>{const a=new Set(r);return a.has(s)?a.delete(s):a.add(s),a})},ce=()=>{x.size===m.length?S(new Set):S(new Set(m.map(s=>s.id)))},de=async()=>{m.filter(r=>x.has(r.id)).length!==0&&$(!0)},me=async()=>{try{p(!0);const s=m.filter(r=>x.has(r.id));await je(s),$(!1),S(new Set),J(!1),await b()}catch(s){console.error("Error bulk deleting accounts:",s),t("No se pudieron eliminar las cuentas",s.message)}finally{p(!1)}},H=s=>{V(r=>!!r[s]?{}:{[s]:!0})},W=s=>{if(X===0)return 0;const{value:r}=P(s);return Math.min(100,Math.max(0,r/X*100))},xe=()=>e.jsx("div",{className:"space-y-3",children:[1,2,3].map(s=>e.jsx("div",{className:"rounded-2xl p-4",style:{backgroundColor:"var(--bg-secondary)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl skeleton"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-32 skeleton"}),e.jsx("div",{className:"h-3 w-24 skeleton"})]}),e.jsxs("div",{className:"text-right space-y-2",children:[e.jsx("div",{className:"h-5 w-28 skeleton ml-auto"}),e.jsx("div",{className:"h-3 w-20 skeleton ml-auto"})]})]})},s))});if(C)return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-6 w-24 skeleton"}),e.jsx("div",{className:"h-10 w-24 skeleton"})]}),xe()]});return e.jsxs("div",{className:"space-y-4 overflow-x-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("h2",{className:"text-base font-medium",style:{color:"var(--text-primary)"},children:"Cuentas"}),e.jsxs("div",{className:"flex items-center gap-2",children:[m.length>0&&e.jsx(Ne,{options:ae,value:A,onChange:Q,storageKey:I}),m.length>0&&e.jsx("button",{onClick:ie,className:"p-2 rounded-lg transition-colors duration-150",style:{backgroundColor:y?"var(--accent-primary-dim)":"var(--bg-tertiary)",color:y?"var(--accent-primary)":"var(--text-muted)"},title:y?"Cancelar selección":"Seleccionar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5h7M4 12h7m-7 7h7m5-14v14m0-14l3 3m-3-3l-3 3m3 11l3-3m-3 3l-3-3"})})}),e.jsxs("button",{onClick:()=>j(!0),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors duration-150 flex items-center gap-1.5",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-medium)"},children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Nueva"]})]})]}),e.jsx("div",{className:"flex w-full p-1 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[{id:"original",label:"Original",icon:null},{id:"ARS",label:"ARS",icon:"/icons/catalog/ARS.svg"},{id:"USD",label:"USD",icon:"/icons/catalog/USD.svg"}].map(s=>e.jsxs("button",{onClick:()=>L(s.id),className:"flex-1 py-2 rounded-md text-xs font-medium transition-colors duration-150 flex items-center justify-center gap-1.5",style:{backgroundColor:g===s.id?"var(--bg-elevated)":"transparent",color:g===s.id?"var(--text-primary)":"var(--text-muted)"},children:[s.icon&&e.jsx("img",{src:Y(s.icon),alt:s.label,className:"w-4 h-4 rounded-sm"}),s.label]},s.id))}),y&&x.size>0&&e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-2xl animate-scale-in",style:{backgroundColor:"var(--accent-primary-dim)",border:"1px solid var(--accent-primary)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:ce,className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-all",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},children:x.size===m.length?"Deseleccionar todo":"Seleccionar todo"}),e.jsxs("span",{className:"text-sm font-medium",style:{color:"var(--accent-primary)"},children:[x.size," ",x.size===1?"cuenta seleccionada":"cuentas seleccionadas"]})]}),e.jsxs("button",{onClick:de,className:"px-4 py-2 rounded-xl text-sm font-medium transition-all hover:opacity-80 flex items-center gap-2",style:{backgroundColor:"var(--accent-red)",color:"white"},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Eliminar"]})]}),m.length===0?e.jsxs("div",{className:"rounded-2xl p-8 text-center",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-2xl flex items-center justify-center",style:{backgroundColor:"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-10 h-10",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Sin cuentas"}),e.jsx("p",{className:"text-sm mb-6",style:{color:"var(--text-secondary)"},children:"Agrega tu primera cuenta para comenzar"}),e.jsx("button",{onClick:()=>j(!0),className:"px-6 py-3 rounded-xl font-medium text-white transition-all duration-200 hover:opacity-90",style:{backgroundColor:"var(--accent-primary)"},children:"Agregar cuenta"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3 lg:hidden",children:U.map(s=>{const r=s.id??s.rowIndex??s.nombre,a=W(s),o=N[r],i=P(s),c=x.has(s.id);return e.jsx(F,{account:s,expansionKey:r,percentage:a,isExpanded:o,displayBalance:i,isSelected:c,selectionMode:y,toggleAccountSelection:z,toggleDetails:H,setEditingAccount:f,handleSave:R,saving:v},s.id||s.rowIndex||s.nombre)})}),e.jsx("div",{className:"hidden lg:flex xl:hidden gap-4",children:[0,1].map(s=>e.jsx("div",{className:"flex-1 space-y-4",children:U.filter((r,a)=>a%2===s).map(r=>{const a=r.id??r.rowIndex??r.nombre,o=W(r),i=N[a],c=P(r),d=x.has(r.id);return e.jsx(F,{account:r,expansionKey:a,percentage:o,isExpanded:i,displayBalance:c,isSelected:d,selectionMode:y,toggleAccountSelection:z,toggleDetails:H,setEditingAccount:f,handleSave:R,saving:v},r.id||r.rowIndex||r.nombre)})},s))}),e.jsx("div",{className:"hidden xl:flex gap-4",children:[0,1,2].map(s=>e.jsx("div",{className:"flex-1 space-y-4",children:U.filter((r,a)=>a%3===s).map(r=>{const a=r.id??r.rowIndex??r.nombre,o=W(r),i=N[a],c=P(r),d=x.has(r.id);return e.jsx(F,{account:r,expansionKey:a,percentage:o,isExpanded:i,displayBalance:c,isSelected:d,selectionMode:y,toggleAccountSelection:z,toggleDetails:H,setEditingAccount:f,handleSave:R,saving:v},r.id||r.rowIndex||r.nombre)})},s))})]}),E&&e.jsx(se,{onSave:le,onClose:()=>j(!1),loading:v}),k&&e.jsx(se,{account:k,onSave:R,onDelete:()=>ne(k),onClose:()=>f(null),loading:v}),e.jsx(Z,{isOpen:!!n,onClose:()=>h(null),onConfirm:oe,title:"Eliminar cuenta",message:e.jsxs(e.Fragment,{children:["¿Estás seguro de que quieres eliminar la cuenta"," ",e.jsx("span",{className:"font-semibold",style:{color:"var(--text-primary)"},children:n==null?void 0:n.nombre}),"?",e.jsx("br",{}),e.jsx("span",{className:"text-xs mt-1 block",children:"Los movimientos asociados no se eliminarán."})]}),confirmText:"Eliminar",loading:v,icon:e.jsx("svg",{className:"w-7 h-7",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),e.jsx(Z,{isOpen:re,onClose:()=>$(!1),onConfirm:me,title:"Eliminar cuentas",message:e.jsxs(e.Fragment,{children:["¿Estás seguro de que quieres eliminar"," ",e.jsxs("span",{className:"font-semibold",style:{color:"var(--accent-red)"},children:[x.size," ",x.size===1?"cuenta":"cuentas"]}),"?",e.jsx("br",{}),e.jsx("span",{className:"text-xs mt-1 block",children:"Esta acción no se puede deshacer. Los movimientos asociados no se eliminarán."})]}),confirmText:`Eliminar ${x.size}`,loading:v,icon:e.jsx("svg",{className:"w-7 h-7",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]});function F({account:s,expansionKey:r,percentage:a,isExpanded:o,displayBalance:i,isSelected:c,selectionMode:d,toggleAccountSelection:D,toggleDetails:B,setEditingAccount:G,handleSave:_,saving:K}){return e.jsxs("div",{className:`rounded-2xl overflow-hidden transition-all duration-200 ${c?"ring-2":""}`,style:{backgroundColor:"var(--bg-secondary)",ringColor:"var(--accent-primary)"},children:[e.jsxs("div",{className:"flex items-center",children:[d&&e.jsx("button",{onClick:()=>D(s.id),className:"pl-4 pr-2 py-4 flex items-center",children:e.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center transition-all duration-200 ${c?"":"border-2"}`,style:{backgroundColor:c?"var(--accent-primary)":"transparent",borderColor:"var(--text-secondary)"},children:c&&e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})}),e.jsx("button",{onClick:()=>d?D(s.id):B(r),className:`flex-1 min-w-0 p-2.5 sm:p-4 ${d?"pl-0":""} text-left transition-colors hover:bg-[var(--bg-tertiary)] overflow-hidden`,children:e.jsxs("div",{className:"flex items-start gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 sm:w-12 sm:h-12 rounded-lg sm:rounded-xl flex items-center justify-center overflow-hidden flex-shrink-0",style:{backgroundColor:s.icon?ee(s.icon)?"var(--bg-tertiary)":"transparent":s.moneda==="Peso"?"rgba(117, 170, 219, 0.15)":"rgba(60, 179, 113, 0.15)"},children:s.icon?ee(s.icon)?e.jsx("span",{className:"text-lg sm:text-2xl",children:s.icon}):e.jsx("img",{src:Y(s.icon),alt:s.nombre,className:"w-full h-full object-cover rounded-lg sm:rounded-xl"}):e.jsx("span",{className:"text-sm sm:text-lg font-bold",style:{color:s.moneda==="Peso"?"#75AADB":"#3CB371"},children:s.moneda==="Peso"?"$":"US$"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("p",{className:"font-semibold text-sm leading-tight truncate flex-1",style:{color:"var(--text-primary)"},title:s.nombre,children:s.nombre}),s.ocultaDelBalance&&e.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded flex items-center justify-center",style:{backgroundColor:"var(--bg-tertiary)"},title:"Oculta del balance",children:e.jsx("svg",{className:"w-3 h-3",style:{color:"var(--text-muted)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})}),e.jsx("svg",{className:`w-4 h-4 flex-shrink-0 transition-transform duration-300 ${o?"rotate-180":""}`,style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsxs("div",{className:"flex items-baseline justify-between gap-2 mt-1",children:[e.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:s.esTarjetaCredito?"Próximo resumen":e.jsxs(e.Fragment,{children:[s.moneda==="Peso"?"ARS":"USD"," ",s.tipo&&`· ${s.tipo}`]})}),s.esTarjetaCredito?e.jsxs("div",{className:"flex items-center gap-2",children:[s.proximoResumenPesos>0&&e.jsxs("p",{className:"text-sm font-bold",style:{color:"var(--accent-red)"},children:["-",u(s.proximoResumenPesos,"ARS")]}),s.proximoResumenDolares>0&&e.jsxs("p",{className:"text-sm font-bold",style:{color:"var(--accent-green)"},children:["-",u(s.proximoResumenDolares,"USD")]}),s.proximoResumenPesos===0&&s.proximoResumenDolares===0&&e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--text-muted)"},children:"$0"})]}):e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--accent-primary)"},children:u(i.value,i.currency)})]}),!s.esTarjetaCredito&&e.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[e.jsx("div",{className:"flex-1 h-1 rounded-full overflow-hidden",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${a}%`,backgroundColor:"var(--accent-primary)"}})}),e.jsxs("span",{className:"text-[10px] tabular-nums",style:{color:"var(--text-muted)"},children:[a.toFixed(0),"%"]})]})]})]})})]}),o&&!d&&e.jsxs("div",{className:"px-4 pb-4 pt-2 animate-scale-in",style:{borderTop:"1px solid var(--border-subtle)"},children:[s.esTarjetaCredito?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm mb-4",children:[e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(239, 68, 68, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Próximo resumen $"}),e.jsx("p",{className:"font-medium",style:{color:"var(--accent-red)"},children:s.proximoResumenPesos>0?`-${u(s.proximoResumenPesos,"ARS")}`:"$0"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(34, 197, 94, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Próximo resumen US$"}),e.jsx("p",{className:"font-medium",style:{color:"var(--accent-green)"},children:s.proximoResumenDolares>0?`-${u(s.proximoResumenDolares,"USD")}`:"US$0"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(239, 68, 68, 0.05)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Total gastado"}),e.jsxs("p",{className:"font-medium",style:{color:"var(--accent-red)"},children:["-",u(s.totalGastos||0,"ARS")]})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(59, 130, 246, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Promedio mensual"}),e.jsx("p",{className:"font-medium",style:{color:"var(--accent-blue)"},children:u(s.promedioMensual||0,"ARS")})]})]}),e.jsx(Ce,{account:s,onSave:_,loading:K})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm mb-4",children:[e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Balance Inicial"}),e.jsx("p",{className:"font-medium",style:{color:"var(--text-primary)"},children:u(s.balanceInicial,s.moneda==="Peso"?"ARS":"USD")})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Numero de Cuenta"}),e.jsx("p",{className:"font-medium truncate",style:{color:"var(--text-primary)"},children:s.numeroCuenta||"-"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(34, 197, 94, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Total Ingresos"}),e.jsxs("p",{className:"font-medium",style:{color:"var(--accent-green)"},children:["+",u(s.totalIngresos,s.moneda==="Peso"?"ARS":"USD")]})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(239, 68, 68, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Total Gastos"}),e.jsxs("p",{className:"font-medium",style:{color:"var(--accent-red)"},children:["-",u(s.totalGastos,s.moneda==="Peso"?"ARS":"USD")]})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(59, 130, 246, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Transf. Entrantes"}),e.jsxs("p",{className:"font-medium",style:{color:"var(--accent-blue)"},children:["+",u(s.totalTransfEntrantes,s.moneda==="Peso"?"ARS":"USD")]})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(59, 130, 246, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Transf. Salientes"}),e.jsxs("p",{className:"font-medium",style:{color:"var(--accent-blue)"},children:["-",u(s.totalTransfSalientes,s.moneda==="Peso"?"ARS":"USD")]})]})]}),e.jsxs("button",{onClick:q=>{q.stopPropagation(),G(s)},className:"w-full py-3 rounded-xl text-sm font-medium transition-all duration-200 hover:opacity-80 flex items-center justify-center gap-2",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--accent-primary)"},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Editar cuenta"]})]})]})}}function Ce({account:t,onSave:T,loading:m}){var g,L;const[O,C]=l.useState(!1),[w,k]=l.useState(((g=t.diaCierre)==null?void 0:g.toString())||"1"),[f,E]=l.useState(((L=t.diaVencimiento)==null?void 0:L.toString())||""),[j,v]=l.useState(!1),[p,N]=l.useState(""),V=async()=>{const n=parseInt(w)||1,h=parseInt(f)||null;if(h&&n===h){N("El día de cierre y vencimiento no pueden ser iguales");return}if(n===t.diaCierre&&h===t.diaVencimiento){C(!1);return}v(!0),N("");try{await T({id:t.id,rowIndex:t.rowIndex,nombre:t.nombre,balanceInicial:t.balanceInicial,moneda:t.moneda,numeroCuenta:t.numeroCuenta,tipo:t.tipo,esTarjetaCredito:t.esTarjetaCredito,diaCierre:n,diaVencimiento:h,icon:t.icon,ocultaDelBalance:t.ocultaDelBalance}),C(!1)}catch(y){console.error("Error updating card dates:",y)}finally{v(!1)}};return O?e.jsxs("div",{className:"p-4 rounded-xl mb-4",style:{backgroundColor:"rgba(20, 184, 166, 0.1)"},onClick:n=>n.stopPropagation(),children:[e.jsx("p",{className:"text-sm font-medium mb-3",style:{color:"var(--text-primary)"},children:"Fechas de la tarjeta"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-secondary)"},children:"Día de cierre"}),e.jsx("input",{type:"number",value:w,onChange:n=>k(n.target.value),min:"1",max:"31",className:"w-full px-3 py-2 rounded-lg text-center font-semibold transition-all duration-200 border-2 border-transparent focus:border-[var(--accent-purple)]",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)"},autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-secondary)"},children:"Día de vencimiento"}),e.jsx("input",{type:"number",value:f,onChange:n=>E(n.target.value),min:"1",max:"31",placeholder:"—",className:"w-full px-3 py-2 rounded-lg text-center font-semibold transition-all duration-200 border-2 border-transparent focus:border-[var(--accent-purple)]",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)"}})]})]}),p&&e.jsx("p",{className:"text-xs mt-2",style:{color:"var(--accent-red)"},children:p}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{onClick:()=>{var n,h;k(((n=t.diaCierre)==null?void 0:n.toString())||"1"),E(((h=t.diaVencimiento)==null?void 0:h.toString())||""),N(""),C(!1)},className:"flex-1 py-2 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"Cancelar"}),e.jsx("button",{onClick:V,disabled:j,className:"flex-1 py-2 rounded-lg text-sm font-medium text-white transition-colors disabled:opacity-50",style:{backgroundColor:"var(--accent-purple)"},children:j?"Guardando...":"Guardar"})]})]}):e.jsxs("button",{onClick:n=>{n.stopPropagation(),C(!0)},className:"w-full p-3 rounded-xl mb-4 flex items-center justify-between transition-colors hover:opacity-80",style:{backgroundColor:"rgba(20, 184, 166, 0.1)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{backgroundColor:"var(--accent-purple)"},children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("div",{className:"text-left",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Cierre"}),e.jsxs("p",{className:"text-sm font-semibold",style:{color:"var(--accent-purple)"},children:["Día ",t.diaCierre||1]})]}),e.jsx("div",{className:"w-px h-6",style:{backgroundColor:"var(--border-subtle)"}}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wide",style:{color:"var(--text-muted)"},children:"Vencimiento"}),e.jsx("p",{className:"text-sm font-semibold",style:{color:t.diaVencimiento?"var(--accent-purple)":"var(--text-muted)"},children:t.diaVencimiento?`Día ${t.diaVencimiento}`:"Sin definir"})]})]})})]}),e.jsx("svg",{className:"w-5 h-5",style:{color:"var(--accent-purple)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]})}export{De as default};
