import{g as me,v as xe,r as l,C as ue,n as pe,j as e,a as Z,D as re,i as F,f as g,F as he,G as ve,H as ye,I as be}from"./index-Dv-ULL4h.js";import{S as ge}from"./SortDropdown-BRfzETxI.js";import{I as fe}from"./IconPicker-B4wyerfc.js";function we(){const{showError:a}=me(),B=xe(),[x,D]=l.useState([]),[f,N]=l.useState(!0),[t,u]=l.useState(null),[E,C]=l.useState(!1),[p,i]=l.useState(!1),[k,R]=l.useState({}),[j,H]=l.useState("original"),[w,T]=l.useState(null),[b,$]=l.useState(!1),[h,S]=l.useState(new Set),[U,P]=l.useState(!1),n="cashe-sort-accounts",[v,A]=l.useState({sortBy:"balance",sortOrder:"desc"}),M=[{id:"balance",label:"Saldo",defaultOrder:"desc"},{id:"name",label:"Nombre",defaultOrder:"asc"},{id:"type",label:"Tipo",defaultOrder:"asc"},{id:"currency",label:"Moneda",defaultOrder:"asc"}];l.useEffect(()=>{const r=localStorage.getItem(n);if(r)try{const s=JSON.parse(r);s.sortBy&&s.sortOrder&&A(s)}catch(s){console.error("Error parsing sort preference:",s)}},[]),l.useEffect(()=>{localStorage.setItem(n,JSON.stringify(v))},[v]),l.useEffect(()=>{L(!0)},[B.key]),l.useEffect(()=>{const r=()=>{document.visibilityState==="visible"&&L(!0)},s=o=>{o.persisted&&L(!0)};return document.addEventListener("visibilitychange",r),window.addEventListener("pageshow",s),()=>{document.removeEventListener("visibilitychange",r),window.removeEventListener("pageshow",s)}},[]);const L=async(r=!1)=>{try{N(!0),r&&ue();const s=await pe();D(s.accounts||[])}catch(s){console.error("Error fetching accounts:",s)}finally{N(!1)}},ee=l.useMemo(()=>x.filter(r=>!r.esTarjetaCredito).reduce((r,s)=>{const o=s.balanceActual||0,d=s.tipoCambio||1e3;return j==="original"||j==="ARS"?s.moneda==="Peso"?r+o:r+o*d:s.moneda==="Peso"?r+o/d:r+o},0),[x,j]),V=l.useMemo(()=>{const r=[...x],{sortBy:s,sortOrder:o}=v,d=o==="asc"?1:-1;return r.sort((c,m)=>{let y=0;switch(s){case"balance":const I=c.balanceActual||0,W=m.balanceActual||0,J=c.tipoCambio||1e3,_=m.tipoCambio||1e3,Q=c.moneda==="Peso"?I:I*J,X=m.moneda==="Peso"?W:W*_;y=Q-X;break;case"name":y=(c.nombre||"").localeCompare(m.nombre||"");break;case"type":y=(c.tipo||"").localeCompare(m.tipo||"");break;case"currency":y=(c.moneda||"").localeCompare(m.moneda||"");break;default:y=0}return y*d}),r},[x,v]),z=r=>{const s=r.balanceActual||0,o=r.tipoCambio||1e3,d=r.moneda==="Peso";return j==="original"?{value:s,currency:d?"ARS":"USD"}:j==="ARS"?{value:d?s:s*o,currency:"ARS"}:{value:d?s/o:s,currency:"USD"}},ae=async r=>{try{i(!0),await ve(r),C(!1),await L()}catch(s){console.error("Error adding account:",s),a("No se pudo crear la cuenta",s.message)}finally{i(!1)}},O=async r=>{try{i(!0),await he(r),u(null),await L()}catch(s){console.error("Error updating account:",s),a("No se pudo guardar la cuenta",s.message)}finally{i(!1)}},te=async r=>{T(r)},oe=async()=>{if(w)try{i(!0),await ye(w.id),T(null),u(null),await L()}catch(r){console.error("Error deleting account:",r),a("No se pudo eliminar la cuenta",r.message)}finally{i(!1)}},le=()=>{$(!b),S(new Set)},G=r=>{S(s=>{const o=new Set(s);return o.has(r)?o.delete(r):o.add(r),o})},ne=()=>{h.size===x.length?S(new Set):S(new Set(x.map(r=>r.id)))},ie=async()=>{x.filter(s=>h.has(s.id)).length!==0&&P(!0)},de=async()=>{try{i(!0);const r=x.filter(s=>h.has(s.id));await be(r),P(!1),S(new Set),$(!1),await L()}catch(r){console.error("Error bulk deleting accounts:",r),a("No se pudieron eliminar las cuentas",r.message)}finally{i(!1)}},Y=r=>{R(s=>!!s[r]?{}:{[r]:!0})},q=r=>{if(ee===0)return 0;const{value:s}=z(r);return Math.min(100,Math.max(0,s/ee*100))},ce=()=>e.jsx("div",{className:"space-y-3",children:[1,2,3].map(r=>e.jsx("div",{className:"rounded-2xl p-4",style:{backgroundColor:"var(--bg-secondary)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl skeleton"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 w-32 skeleton"}),e.jsx("div",{className:"h-3 w-24 skeleton"})]}),e.jsxs("div",{className:"text-right space-y-2",children:[e.jsx("div",{className:"h-5 w-28 skeleton ml-auto"}),e.jsx("div",{className:"h-3 w-20 skeleton ml-auto"})]})]})},r))});if(f)return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-6 w-24 skeleton"}),e.jsx("div",{className:"h-10 w-24 skeleton"})]}),ce()]});return e.jsxs("div",{className:"space-y-4 overflow-x-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("h2",{className:"text-base font-medium",style:{color:"var(--text-primary)"},children:"Cuentas"}),e.jsxs("div",{className:"flex items-center gap-2",children:[x.length>0&&e.jsx(ge,{options:M,value:v,onChange:A,storageKey:n}),x.length>0&&e.jsx("button",{onClick:le,className:"p-2 rounded-lg transition-colors duration-150",style:{backgroundColor:b?"var(--accent-primary-dim)":"var(--bg-tertiary)",color:b?"var(--accent-primary)":"var(--text-muted)"},title:b?"Cancelar selecci贸n":"Seleccionar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5h7M4 12h7m-7 7h7m5-14v14m0-14l3 3m-3-3l-3 3m3 11l3-3m-3 3l-3-3"})})}),e.jsxs("button",{onClick:()=>C(!0),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors duration-150 flex items-center gap-1.5",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)",border:"1px solid var(--border-medium)"},children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Nueva"]})]})]}),e.jsx("div",{className:"flex w-full p-1 rounded-lg",style:{backgroundColor:"var(--bg-tertiary)"},children:[{id:"original",label:"Original",icon:null},{id:"ARS",label:"ARS",icon:"/icons/catalog/ARS.svg"},{id:"USD",label:"USD",icon:"/icons/catalog/USD.svg"}].map(r=>e.jsxs("button",{onClick:()=>H(r.id),className:"flex-1 py-2 rounded-md text-xs font-medium transition-colors duration-150 flex items-center justify-center gap-1.5",style:{backgroundColor:j===r.id?"var(--bg-elevated)":"transparent",color:j===r.id?"var(--text-primary)":"var(--text-muted)"},children:[r.icon&&e.jsx("img",{src:Z(r.icon),alt:r.label,className:"w-4 h-4 rounded-sm"}),r.label]},r.id))}),b&&h.size>0&&e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-2xl animate-scale-in",style:{backgroundColor:"var(--accent-primary-dim)",border:"1px solid var(--accent-primary)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:ne,className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-all",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},children:h.size===x.length?"Deseleccionar todo":"Seleccionar todo"}),e.jsxs("span",{className:"text-sm font-medium",style:{color:"var(--accent-primary)"},children:[h.size," ",h.size===1?"cuenta seleccionada":"cuentas seleccionadas"]})]}),e.jsxs("button",{onClick:ie,className:"px-4 py-2 rounded-xl text-sm font-medium transition-all hover:opacity-80 flex items-center gap-2",style:{backgroundColor:"var(--accent-red)",color:"white"},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Eliminar"]})]}),x.length===0?e.jsxs("div",{className:"rounded-2xl p-8 text-center",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 rounded-2xl flex items-center justify-center",style:{backgroundColor:"var(--accent-primary-dim)"},children:e.jsx("svg",{className:"w-10 h-10",style:{color:"var(--accent-primary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Sin cuentas"}),e.jsx("p",{className:"text-sm mb-6",style:{color:"var(--text-secondary)"},children:"Agrega tu primera cuenta para comenzar"}),e.jsx("button",{onClick:()=>C(!0),className:"px-6 py-3 rounded-xl font-medium text-white transition-all duration-200 hover:opacity-90",style:{backgroundColor:"var(--accent-primary)"},children:"Agregar cuenta"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3 lg:hidden",children:V.map(r=>{const s=r.id??r.rowIndex??r.nombre,o=q(r),d=k[s],c=z(r),m=h.has(r.id);return e.jsx(K,{account:r,expansionKey:s,percentage:o,isExpanded:d,displayBalance:c,isSelected:m,selectionMode:b,toggleAccountSelection:G,toggleDetails:Y,setEditingAccount:u,handleSave:O,saving:p},r.id||r.rowIndex||r.nombre)})}),e.jsx("div",{className:"hidden lg:flex xl:hidden gap-4",children:[0,1].map(r=>e.jsx("div",{className:"flex-1 space-y-4",children:V.filter((s,o)=>o%2===r).map(s=>{const o=s.id??s.rowIndex??s.nombre,d=q(s),c=k[o],m=z(s),y=h.has(s.id);return e.jsx(K,{account:s,expansionKey:o,percentage:d,isExpanded:c,displayBalance:m,isSelected:y,selectionMode:b,toggleAccountSelection:G,toggleDetails:Y,setEditingAccount:u,handleSave:O,saving:p},s.id||s.rowIndex||s.nombre)})},r))}),e.jsx("div",{className:"hidden xl:flex gap-4",children:[0,1,2].map(r=>e.jsx("div",{className:"flex-1 space-y-4",children:V.filter((s,o)=>o%3===r).map(s=>{const o=s.id??s.rowIndex??s.nombre,d=q(s),c=k[o],m=z(s),y=h.has(s.id);return e.jsx(K,{account:s,expansionKey:o,percentage:d,isExpanded:c,displayBalance:m,isSelected:y,selectionMode:b,toggleAccountSelection:G,toggleDetails:Y,setEditingAccount:u,handleSave:O,saving:p},s.id||s.rowIndex||s.nombre)})},r))})]}),E&&e.jsx(se,{onSave:ae,onClose:()=>C(!1),loading:p}),t&&e.jsx(se,{account:t,onSave:O,onDelete:()=>te(t),onClose:()=>u(null),loading:p}),e.jsx(re,{isOpen:!!w,onClose:()=>T(null),onConfirm:oe,title:"Eliminar cuenta",message:e.jsxs(e.Fragment,{children:["驴Est谩s seguro de que quieres eliminar la cuenta"," ",e.jsx("span",{className:"font-semibold",style:{color:"var(--text-primary)"},children:w==null?void 0:w.nombre}),"?",e.jsx("br",{}),e.jsx("span",{className:"text-xs mt-1 block",children:"Los movimientos asociados no se eliminar谩n."})]}),confirmText:"Eliminar",loading:p,icon:e.jsx("svg",{className:"w-7 h-7",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),e.jsx(re,{isOpen:U,onClose:()=>P(!1),onConfirm:de,title:"Eliminar cuentas",message:e.jsxs(e.Fragment,{children:["驴Est谩s seguro de que quieres eliminar"," ",e.jsxs("span",{className:"font-semibold",style:{color:"var(--accent-red)"},children:[h.size," ",h.size===1?"cuenta":"cuentas"]}),"?",e.jsx("br",{}),e.jsx("span",{className:"text-xs mt-1 block",children:"Esta acci贸n no se puede deshacer. Los movimientos asociados no se eliminar谩n."})]}),confirmText:`Eliminar ${h.size}`,loading:p,icon:e.jsx("svg",{className:"w-7 h-7",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]});function K({account:r,expansionKey:s,percentage:o,isExpanded:d,displayBalance:c,isSelected:m,selectionMode:y,toggleAccountSelection:I,toggleDetails:W,setEditingAccount:J,handleSave:_,saving:Q}){return e.jsxs("div",{className:`rounded-2xl overflow-hidden transition-all duration-200 ${m?"ring-2":""}`,style:{backgroundColor:"var(--bg-secondary)",ringColor:"var(--accent-primary)"},children:[e.jsxs("div",{className:"flex items-center",children:[y&&e.jsx("button",{onClick:()=>I(r.id),className:"pl-4 pr-2 py-4 flex items-center",children:e.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center transition-all duration-200 ${m?"":"border-2"}`,style:{backgroundColor:m?"var(--accent-primary)":"transparent",borderColor:"var(--text-secondary)"},children:m&&e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})}),e.jsx("button",{onClick:()=>y?I(r.id):W(s),className:`flex-1 min-w-0 p-2.5 sm:p-4 ${y?"pl-0":""} text-left transition-colors hover:bg-[var(--bg-tertiary)] overflow-hidden`,children:e.jsxs("div",{className:"flex items-start gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 sm:w-12 sm:h-12 rounded-lg sm:rounded-xl flex items-center justify-center overflow-hidden flex-shrink-0",style:{backgroundColor:r.icon?F(r.icon)?"var(--bg-tertiary)":"transparent":r.moneda==="Peso"?"rgba(117, 170, 219, 0.15)":"rgba(60, 179, 113, 0.15)"},children:r.icon?F(r.icon)?e.jsx("span",{className:"text-lg sm:text-2xl",children:r.icon}):e.jsx("img",{src:Z(r.icon),alt:r.nombre,className:"w-full h-full object-cover rounded-lg sm:rounded-xl"}):e.jsx("span",{className:"text-sm sm:text-lg font-bold",style:{color:r.moneda==="Peso"?"#75AADB":"#3CB371"},children:r.moneda==="Peso"?"$":"US$"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("p",{className:"font-semibold text-sm leading-tight truncate flex-1",style:{color:"var(--text-primary)"},title:r.nombre,children:r.nombre}),e.jsx("svg",{className:`w-4 h-4 flex-shrink-0 transition-transform duration-300 ${d?"rotate-180":""}`,style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsxs("div",{className:"flex items-baseline justify-between gap-2 mt-1",children:[e.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:r.esTarjetaCredito?"Pr贸ximo resumen":e.jsxs(e.Fragment,{children:[r.moneda==="Peso"?"ARS":"USD"," ",r.tipo&&`路 ${r.tipo}`]})}),r.esTarjetaCredito?e.jsxs("div",{className:"flex items-center gap-2",children:[r.proximoResumenPesos>0&&e.jsxs("p",{className:"text-sm font-bold",style:{color:"var(--accent-red)"},children:["-",g(r.proximoResumenPesos,"ARS")]}),r.proximoResumenDolares>0&&e.jsxs("p",{className:"text-sm font-bold",style:{color:"var(--accent-green)"},children:["-",g(r.proximoResumenDolares,"USD")]}),r.proximoResumenPesos===0&&r.proximoResumenDolares===0&&e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--text-muted)"},children:"$0"})]}):e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--accent-primary)"},children:g(c.value,c.currency)})]}),!r.esTarjetaCredito&&e.jsxs("div",{className:"flex items-center gap-2 mt-1.5",children:[e.jsx("div",{className:"flex-1 h-1 rounded-full overflow-hidden",style:{backgroundColor:"var(--bg-tertiary)"},children:e.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${o}%`,backgroundColor:"var(--accent-primary)"}})}),e.jsxs("span",{className:"text-[10px] tabular-nums",style:{color:"var(--text-muted)"},children:[o.toFixed(0),"%"]})]})]})]})})]}),d&&!y&&e.jsxs("div",{className:"px-4 pb-4 pt-2 animate-scale-in",style:{borderTop:"1px solid var(--border-subtle)"},children:[r.esTarjetaCredito?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm mb-4",children:[e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(239, 68, 68, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Pr贸ximo resumen $"}),e.jsx("p",{className:"font-medium",style:{color:"var(--accent-red)"},children:r.proximoResumenPesos>0?`-${g(r.proximoResumenPesos,"ARS")}`:"$0"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(34, 197, 94, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Pr贸ximo resumen US$"}),e.jsx("p",{className:"font-medium",style:{color:"var(--accent-green)"},children:r.proximoResumenDolares>0?`-${g(r.proximoResumenDolares,"USD")}`:"US$0"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(239, 68, 68, 0.05)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Total gastado"}),e.jsxs("p",{className:"font-medium",style:{color:"var(--accent-red)"},children:["-",g(r.totalGastos||0,"ARS")]})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(59, 130, 246, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Promedio mensual"}),e.jsx("p",{className:"font-medium",style:{color:"var(--accent-blue)"},children:g(r.promedioMensual||0,"ARS")})]})]}),e.jsx(je,{account:r,onSave:_,loading:Q})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm mb-4",children:[e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Balance Inicial"}),e.jsx("p",{className:"font-medium",style:{color:"var(--text-primary)"},children:g(r.balanceInicial,r.moneda==="Peso"?"ARS":"USD")})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"var(--bg-tertiary)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Numero de Cuenta"}),e.jsx("p",{className:"font-medium truncate",style:{color:"var(--text-primary)"},children:r.numeroCuenta||"-"})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(34, 197, 94, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Total Ingresos"}),e.jsxs("p",{className:"font-medium",style:{color:"var(--accent-green)"},children:["+",g(r.totalIngresos,r.moneda==="Peso"?"ARS":"USD")]})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(239, 68, 68, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Total Gastos"}),e.jsxs("p",{className:"font-medium",style:{color:"var(--accent-red)"},children:["-",g(r.totalGastos,r.moneda==="Peso"?"ARS":"USD")]})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(59, 130, 246, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Transf. Entrantes"}),e.jsxs("p",{className:"font-medium",style:{color:"var(--accent-blue)"},children:["+",g(r.totalTransfEntrantes,r.moneda==="Peso"?"ARS":"USD")]})]}),e.jsxs("div",{className:"p-3 rounded-xl",style:{backgroundColor:"rgba(59, 130, 246, 0.1)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-secondary)"},children:"Transf. Salientes"}),e.jsxs("p",{className:"font-medium",style:{color:"var(--accent-blue)"},children:["-",g(r.totalTransfSalientes,r.moneda==="Peso"?"ARS":"USD")]})]})]}),e.jsxs("button",{onClick:X=>{X.stopPropagation(),J(r)},className:"w-full py-3 rounded-xl text-sm font-medium transition-all duration-200 hover:opacity-80 flex items-center justify-center gap-2",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--accent-primary)"},children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),"Editar cuenta"]})]})]})}}function se({account:a,onSave:B,onDelete:x,onClose:D,loading:f}){var U,P;const N=!!a,[t,u]=l.useState({id:a==null?void 0:a.id,rowIndex:a==null?void 0:a.rowIndex,nombre:(a==null?void 0:a.nombre)||"",balanceInicial:((U=a==null?void 0:a.balanceInicial)==null?void 0:U.toString())||"0",moneda:(a==null?void 0:a.moneda)||"Peso",numeroCuenta:(a==null?void 0:a.numeroCuenta)||"",tipo:(a==null?void 0:a.tipo)||"",esTarjetaCredito:(a==null?void 0:a.esTarjetaCredito)||!1,diaCierre:((P=a==null?void 0:a.diaCierre)==null?void 0:P.toString())||"1",icon:(a==null?void 0:a.icon)||null}),[E,C]=l.useState(!1),[p,i]=l.useState(0),[k,R]=l.useState(!1),j=l.useRef(0),H=n=>{n.target.closest("[data-drag-handle]")&&(j.current=n.touches[0].clientY,R(!0))},w=n=>{if(!k)return;const v=n.touches[0].clientY-j.current;v>0&&i(v)},T=()=>{k&&(p>100&&D(),i(0),R(!1))},b=n=>{const{name:v,value:A}=n.target;u(M=>({...M,[v]:A}))},$=n=>{n.preventDefault(),B({...t,balanceInicial:parseFloat(t.balanceInicial)||0,diaCierre:t.esTarjetaCredito?parseInt(t.diaCierre)||1:null,icon:t.icon})},h=n=>{u(v=>({...v,icon:n}))},S=p>100;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-start sm:items-center justify-center overflow-y-auto sm:py-6",children:[e.jsx("div",{className:"absolute inset-0 backdrop-blur-sm transition-opacity",style:{backgroundColor:`rgba(0, 0, 0, ${Math.max(.6-p/300,0)})`},onClick:D}),e.jsxs("div",{className:"relative w-full sm:max-w-lg sm:mx-4 rounded-b-2xl sm:rounded-2xl flex flex-col animate-slide-down max-h-[calc(100dvh-40px)] sm:max-h-[calc(100vh-48px)]",style:{backgroundColor:"var(--bg-secondary)",transform:`translateY(${p}px)`,transition:k?"none":"transform 0.3s ease-out",opacity:S?.5:1},onTouchStart:H,onTouchMove:w,onTouchEnd:T,children:[e.jsx("div",{className:"sm:hidden flex justify-center pt-2","data-drag-handle":!0,children:e.jsx("div",{className:"w-10 h-1 rounded-full transition-colors",style:{backgroundColor:S?"var(--accent-red)":"var(--border-medium)"}})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 sm:py-3 flex-shrink-0 border-b cursor-grab active:cursor-grabbing sm:cursor-default",style:{borderColor:"var(--border-subtle)"},"data-drag-handle":!0,children:[e.jsx("h2",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:N?"Editar Cuenta":"Nueva Cuenta"}),e.jsx("button",{onClick:D,className:"p-1.5 rounded-lg transition-colors hover:bg-[var(--bg-tertiary)]",style:{color:"var(--text-secondary)"},children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:$,className:"flex flex-col flex-1 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"space-y-3 overflow-y-auto px-4 py-3 flex-1",children:[e.jsxs("button",{type:"button",onClick:()=>C(!0),className:"w-full px-3 py-2.5 rounded-lg transition-all duration-200 border border-dashed hover:border-solid flex items-center gap-3",style:{backgroundColor:"var(--bg-tertiary)",borderColor:t.icon?"var(--accent-primary)":"var(--border-medium)"},children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center overflow-hidden flex-shrink-0",style:{backgroundColor:t.icon?F(t.icon)?"var(--bg-secondary)":"transparent":"var(--bg-secondary)"},children:t.icon?F(t.icon)?e.jsx("span",{className:"text-xl",children:t.icon}):e.jsx("img",{src:Z(t.icon),alt:"cono",className:"w-full h-full object-cover rounded-lg"}):e.jsx("svg",{className:"w-5 h-5",style:{color:"var(--text-muted)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("p",{className:"text-xs font-medium",style:{color:"var(--text-primary)"},children:t.icon?"Cambiar 铆cono":"Seleccionar 铆cono"})}),e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",style:{color:"var(--text-muted)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Nombre"}),e.jsx("input",{type:"text",name:"nombre",value:t.nombre,onChange:b,className:"w-full px-3 py-2 rounded-lg text-sm border border-transparent focus:border-[var(--accent-primary)]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"},required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Balance Inicial"}),e.jsx("input",{type:"number",name:"balanceInicial",value:t.balanceInicial,onChange:b,step:"0.01",className:"w-full px-3 py-2 rounded-lg text-sm border border-transparent focus:border-[var(--accent-primary)]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Moneda"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("button",{type:"button",onClick:()=>u(n=>({...n,moneda:"Peso"})),className:"flex-1 flex items-center justify-center gap-1.5 py-2 rounded-lg text-xs font-medium transition-all",style:{backgroundColor:t.moneda==="Peso"?"rgba(117, 170, 219, 0.2)":"var(--bg-tertiary)",color:t.moneda==="Peso"?"#75AADB":"var(--text-secondary)",border:t.moneda==="Peso"?"1px solid #75AADB":"1px solid transparent"},children:[e.jsx("img",{src:"/icons/catalog/ARS.svg",alt:"ARS",className:"w-4 h-4 rounded-sm"}),"ARS"]}),!t.esTarjetaCredito&&e.jsxs("button",{type:"button",onClick:()=>u(n=>({...n,moneda:"D贸lar"})),className:"flex-1 flex items-center justify-center gap-1.5 py-2 rounded-lg text-xs font-medium transition-all",style:{backgroundColor:t.moneda==="D贸lar"?"rgba(60, 179, 113, 0.2)":"var(--bg-tertiary)",color:t.moneda==="D贸lar"?"#3CB371":"var(--text-secondary)",border:t.moneda==="D贸lar"?"1px solid #3CB371":"1px solid transparent"},children:[e.jsx("img",{src:"/icons/catalog/USD.svg",alt:"USD",className:"w-4 h-4 rounded-sm"}),"USD"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Nro. Cuenta (opcional)"}),e.jsx("input",{type:"text",name:"numeroCuenta",value:t.numeroCuenta,onChange:b,className:"w-full px-3 py-2 rounded-lg text-sm border border-transparent focus:border-[var(--accent-primary)]",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-primary)"}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium mb-1",style:{color:"var(--text-secondary)"},children:"Tipo de cuenta"}),e.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:[{value:"Caja de ahorro",icon:"",label:"Ahorro"},{value:"Cuenta corriente",icon:"",label:"Corriente"},{value:"Tarjeta de cr茅dito",icon:"",label:"Cr茅dito"},{value:"Billetera virtual",icon:"",label:"Billetera"},{value:"Efectivo",icon:"",label:"Efectivo"},{value:"Inversiones",icon:"",label:"Inversi贸n"}].map(n=>{const v=t.tipo===n.value,A=n.value==="Tarjeta de cr茅dito";return e.jsxs("button",{type:"button",onClick:()=>u(M=>({...M,tipo:n.value,esTarjetaCredito:A,...A?{moneda:"Peso"}:{}})),className:"flex flex-col items-center gap-0.5 p-2 rounded-lg text-xs font-medium transition-all",style:{backgroundColor:v?A?"var(--accent-purple)":"var(--accent-primary)":"var(--bg-tertiary)",color:v?"white":"var(--text-secondary)"},children:[e.jsx("span",{className:"text-base",children:n.icon}),e.jsx("span",{className:"text-[10px] leading-tight",children:n.label})]},n.value)})})]}),t.esTarjetaCredito&&e.jsxs("div",{className:"flex items-center gap-2 p-2.5 rounded-lg",style:{backgroundColor:"var(--accent-purple-dim)"},children:[e.jsx("span",{className:"text-xs",style:{color:"var(--text-secondary)"},children:"Cierre d铆a"}),e.jsx("input",{type:"number",name:"diaCierre",value:t.diaCierre,onChange:b,min:"1",max:"31",className:"w-14 px-2 py-1 rounded-md text-sm text-center font-semibold border border-transparent focus:border-[var(--accent-purple)]",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)"}}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-secondary)"},children:"de cada mes"})]})]}),e.jsxs("div",{className:"flex gap-2 p-3 flex-shrink-0 border-t",style:{borderColor:"var(--border-subtle)",backgroundColor:"var(--bg-secondary)"},children:[N&&x&&e.jsx("button",{type:"button",onClick:x,disabled:f,className:"px-3 py-2.5 rounded-lg text-sm font-medium disabled:opacity-50 transition-all hover:opacity-80",style:{backgroundColor:"rgba(239, 68, 68, 0.15)",color:"var(--accent-red)"},children:"Eliminar"}),e.jsx("button",{type:"submit",disabled:f||!t.nombre,className:"flex-1 py-2.5 rounded-lg text-sm font-semibold text-white disabled:opacity-50 transition-all hover:opacity-90 flex items-center justify-center gap-2",style:{backgroundColor:"var(--accent-primary)"},children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Guardando..."]}):N?"Guardar":"Crear cuenta"})]})]}),e.jsx(fe,{isOpen:E,onClose:()=>C(!1),onSelect:h,currentValue:t.icon,showPredefined:!0,title:"cono de cuenta"})]})]})}function je({account:a,onSave:B,loading:x}){var p;const[D,f]=l.useState(!1),[N,t]=l.useState(((p=a.diaCierre)==null?void 0:p.toString())||"1"),[u,E]=l.useState(!1),C=async()=>{const i=parseInt(N)||1;if(i===a.diaCierre){f(!1);return}E(!0);try{await B({id:a.id,rowIndex:a.rowIndex,nombre:a.nombre,balanceInicial:a.balanceInicial,moneda:a.moneda,numeroCuenta:a.numeroCuenta,tipo:a.tipo,esTarjetaCredito:a.esTarjetaCredito,diaCierre:i}),f(!1)}catch(k){console.error("Error updating closing day:",k)}finally{E(!1)}};return D?e.jsxs("div",{className:"p-4 rounded-xl mb-4",style:{backgroundColor:"rgba(20, 184, 166, 0.1)"},onClick:i=>i.stopPropagation(),children:[e.jsx("p",{className:"text-sm font-medium mb-3",style:{color:"var(--text-primary)"},children:"D铆a de cierre del resumen"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",value:N,onChange:i=>t(i.target.value),min:"1",max:"31",className:"flex-1 px-3 py-2 rounded-lg text-center font-semibold transition-all duration-200 border-2 border-transparent focus:border-[var(--accent-purple)]",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)"},autoFocus:!0}),e.jsx("span",{className:"text-sm",style:{color:"var(--text-secondary)"},children:"de cada mes"})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{onClick:()=>{var i;t(((i=a.diaCierre)==null?void 0:i.toString())||"1"),f(!1)},className:"flex-1 py-2 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:"var(--bg-tertiary)",color:"var(--text-secondary)"},children:"Cancelar"}),e.jsx("button",{onClick:C,disabled:u,className:"flex-1 py-2 rounded-lg text-sm font-medium text-white transition-colors disabled:opacity-50",style:{backgroundColor:"var(--accent-purple)"},children:u?"Guardando...":"Guardar"})]})]}):e.jsxs("button",{onClick:i=>{i.stopPropagation(),f(!0)},className:"w-full p-3 rounded-xl mb-4 flex items-center justify-between transition-colors hover:opacity-80",style:{backgroundColor:"rgba(20, 184, 166, 0.1)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{backgroundColor:"var(--accent-purple)"},children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:"D铆a de cierre"}),e.jsxs("p",{className:"font-semibold",style:{color:"var(--accent-purple)"},children:[a.diaCierre||1," de cada mes"]})]})]}),e.jsx("svg",{className:"w-5 h-5",style:{color:"var(--accent-purple)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]})}export{we as default};
