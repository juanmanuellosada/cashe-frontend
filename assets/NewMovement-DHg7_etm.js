import{u as w,v as k,w as M,x as N,r,j as e,L as C,T as S,M as E,y as T,z as L,A as z,B as A}from"./index-BJnUdJhV.js";function B(){var l;const d=w(),u=k(),{accounts:x,loading:g}=M(),{categories:f,loading:p}=N(),a=((l=u.state)==null?void 0:l.prefill)||null,[v,i]=r.useState(!1),[o,n]=r.useState(null),[h,b]=r.useState(0),y=async({type:c,data:t})=>{i(!0);try{let s;switch(c){case"income":s=await A(t);break;case"expense":s=await z(t);break;case"expense_installments":s=await L(t);break;case"transfer":s=await T(t);break;default:throw new Error("Tipo de movimiento no vÃ¡lido")}let m=s.message||"Movimiento registrado correctamente";c==="expense_installments"&&s.filasCreadas&&(m=`Gasto en ${s.filasCreadas} cuotas registrado correctamente`),n({message:m,type:"success"}),a?setTimeout(()=>{d("/")},1500):b(j=>j+1)}catch(s){n({message:s.message||"Error al registrar el movimiento",type:"error"})}finally{i(!1)}};return g||p?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(C,{size:"lg"})}):e.jsxs("div",{className:"lg:max-w-2xl lg:mx-auto",children:[o&&e.jsx(S,{message:o.message,type:o.type,onClose:()=>n(null)}),e.jsx("h2",{className:"text-xl font-bold mb-6 lg:text-2xl lg:mb-8",style:{color:"var(--text-primary)"},children:a?"Duplicar Movimiento":"Nuevo Movimiento"}),a&&e.jsxs("div",{className:"mb-4 p-3 rounded-xl text-sm flex items-center gap-2",style:{backgroundColor:"var(--accent-blue-dim)",color:"var(--accent-blue)"},children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Duplicando movimiento con fecha de hoy. Modifica los datos si es necesario."]}),e.jsx("div",{className:"lg:rounded-2xl lg:p-6",style:{backgroundColor:"transparent"},children:e.jsx(E,{accounts:x,categories:f,onSubmit:y,loading:v,prefillData:a},h)})]})}export{B as default};
