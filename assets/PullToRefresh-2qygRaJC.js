import{r,a8 as C,j as n}from"./index-BpxMBPca.js";function N({children:T,onRefresh:d,disabled:a=!1,threshold:o=80,maxPull:E=120}){const[s,c]=r.useState(0),[t,w]=r.useState(!1),[k,h]=r.useState(!1),f=r.useRef(null),i=r.useRef(0),v=r.useRef(0),u=C(),m=r.useRef(!1),p=r.useCallback(e=>{if(a||t)return;const l=f.current;!l||l.scrollTop>0||(i.current=e.touches[0].clientY,v.current=i.current,m.current=!1)},[a,t]),x=r.useCallback(e=>{if(a||t||i.current===0)return;const l=f.current;if(!l||l.scrollTop>0){c(0),h(!1);return}v.current=e.touches[0].clientY;const j=v.current-i.current;if(j>0){const R=Math.min(j*.5,E);c(R),h(!0),R>=o&&!m.current&&(u.medium(),m.current=!0),j>10&&e.preventDefault()}},[a,t,o,E,u]),y=r.useCallback(async()=>{if(!(a||t))if(i.current=0,h(!1),s>=o&&d){w(!0),u.success();try{await d()}catch(e){console.error("Refresh failed:",e),u.error()}finally{w(!1),c(0)}}else c(0)},[a,t,s,o,d,u]);r.useEffect(()=>{const e=f.current;if(e)return e.addEventListener("touchstart",p,{passive:!0}),e.addEventListener("touchmove",x,{passive:!1}),e.addEventListener("touchend",y,{passive:!0}),()=>{e.removeEventListener("touchstart",p),e.removeEventListener("touchmove",x),e.removeEventListener("touchend",y)}},[p,x,y]),r.useEffect(()=>{t||c(0)},[t]);const g=Math.min(s/o,1),L=s>10||t;return n.jsxs("div",{ref:f,className:"relative overflow-y-auto",style:{height:"100%",touchAction:k?"none":"pan-y"},children:[n.jsx("div",{className:"absolute left-0 right-0 flex items-center justify-center transition-all duration-200 overflow-hidden pointer-events-none z-10",style:{top:0,height:L?Math.max(s,t?50:0):0,opacity:L?1:0},children:n.jsx("div",{className:"flex items-center justify-center",style:{transform:`translateY(${Math.max(0,(s||(t?50:0))-40)}px)`},children:t?n.jsx("div",{className:"w-6 h-6 rounded-full border-2 animate-spin",style:{borderColor:"var(--border-subtle)",borderTopColor:"var(--accent-primary)"}}):n.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center transition-all duration-200",style:{backgroundColor:g>=1?"var(--accent-primary)":"var(--bg-tertiary)",transform:`rotate(${g>=1?180:0}deg)`},children:n.jsx("svg",{className:"w-4 h-4 transition-colors duration-200",style:{color:g>=1?"white":"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})})}),n.jsx("div",{style:{transform:`translateY(${s}px)`,transition:k?"none":"transform 0.2s ease-out"},children:T})]})}export{N as P};
