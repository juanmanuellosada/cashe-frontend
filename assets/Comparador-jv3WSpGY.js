import{am as ee,r as x,al as se,s as re,p as te,b as ae,j as e,f as m,c as V,e as ne}from"./index-MY64-eYD.js";import{bv as oe,br as le,bs as ce,bt as ie,bu as q,bm as H,bn as U,bo as Y,bp as _}from"./PieChart-Xut2Dk2U.js";import{A as w,C,a as S,c as M,e as L,B as D,T as B,h as de,d as G,b as R,f as A,i as xe,g as F}from"./AnimatedChart-BCLUfbW0.js";import"./DateRangePicker-DmAyJk5W.js";const i=["#ef4444","#f97316","#eab308","#22c55e","#14b8a6","#3b82f6","#14b8a6","#ec4899","#6366f1","#84cc16"];function je(){const{filteredMovements:f,dateRange:v,currency:n,accounts:me,loading:X}=ee(),[p,I]=x.useState([]),[j,P]=x.useState([]),[k,J]=x.useState(!1),W=(s,r,t)=>{s.includes(t)?r(s.filter(a=>a!==t)):r([...s,t])},o=x.useMemo(()=>({gastos:f.filter(s=>s.tipo==="gasto"),ingresos:f.filter(s=>s.tipo==="ingreso")}),[f]),$=x.useMemo(()=>{const s=new Set,r=new Set;return f.forEach(t=>{t.tipo==="gasto"?s.add(t.categoria||"Sin categoria"):t.tipo==="ingreso"&&r.add(t.categoria||"Sin categoria")}),{gastos:[...s].sort(),ingresos:[...r].sort()}},[f]),z=x.useMemo(()=>p.length===0?o.gastos:o.gastos.filter(s=>p.includes(s.categoria)),[o.gastos,p]),E=x.useMemo(()=>j.length===0?o.ingresos:o.ingresos.filter(s=>j.includes(s.categoria)),[o.ingresos,j]),d=x.useMemo(()=>{const s=o.ingresos.reduce((l,c)=>l+(n==="ARS"?c.montoPesos||c.monto||0:c.montoDolares||0),0),r=o.gastos.reduce((l,c)=>l+(n==="ARS"?c.montoPesos||c.monto||0:c.montoDolares||0),0),t=s-r,a=s>0?r/s*100:0;return{totalIngresos:s,totalGastos:r,balance:t,ratio:a}},[o,n]),O=x.useMemo(()=>!v.from||!v.to?[]:se({start:v.from,end:v.to}).map(r=>{const t=re(r),a=te(r),l=ae(r,"MMM",{locale:ne});let c=0,K=0;return o.ingresos.forEach(u=>{const N=new Date(u.fecha);N>=t&&N<=a&&(c+=n==="ARS"?u.montoPesos||u.monto||0:u.montoDolares||0)}),o.gastos.forEach(u=>{const N=new Date(u.fecha);N>=t&&N<=a&&(K+=n==="ARS"?u.montoPesos||u.monto||0:u.montoDolares||0)}),{month:l.charAt(0).toUpperCase()+l.slice(1),ingresos:c,gastos:K}}),[v,o,n]),h=x.useMemo(()=>{const s={};let r=0;return o.gastos.forEach(t=>{const a=t.categoria||"Sin categoria",l=a.replace(/^[\p{Emoji}\u200d]+\s*/u,"").trim()||a,c=n==="ARS"?t.montoPesos||t.monto||0:t.montoDolares||0;r+=c,s[l]||(s[l]=0),s[l]+=c}),Object.entries(s).map(([t,a])=>({name:t,value:a,percentage:r>0?a/r*100:0})).sort((t,a)=>a.value-t.value).slice(0,8)},[o.gastos,n]),g=x.useMemo(()=>{const s={};let r=0;return o.ingresos.forEach(t=>{const a=t.categoria||"Sin categoria",l=a.replace(/^[\p{Emoji}\u200d]+\s*/u,"").trim()||a,c=n==="ARS"?t.montoPesos||t.monto||0:t.montoDolares||0;r+=c,s[l]||(s[l]=0),s[l]+=c}),Object.entries(s).map(([t,a])=>({name:t,value:a,percentage:r>0?a/r*100:0})).sort((t,a)=>a.value-t.value).slice(0,8)},[o.ingresos,n]),y=x.useMemo(()=>[...z].sort((s,r)=>new Date(r.fecha)-new Date(s.fecha)),[z]),b=x.useMemo(()=>[...E].sort((s,r)=>new Date(r.fecha)-new Date(s.fecha)),[E]),T=({active:s,payload:r})=>{var a;if(!s||!(r!=null&&r.length))return null;const t=r[0].payload;return e.jsxs("div",{className:"grid min-w-[8rem] items-start gap-1.5 rounded-lg border px-2.5 py-1.5 text-xs shadow-xl bg-[var(--bg-tertiary)] border-[var(--border-subtle)]",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:t.fill||r[0].payload.color}}),e.jsx("span",{className:"font-medium text-[var(--text-primary)]",children:t.name})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-[var(--text-secondary)]",children:"Monto"}),e.jsx("span",{className:"font-mono font-medium tabular-nums text-[var(--text-primary)]",children:m(t.value,n)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4 pt-0.5 border-t border-[var(--border-subtle)]",children:[e.jsx("span",{className:"text-[var(--text-secondary)]",children:"Porcentaje"}),e.jsxs("span",{className:"font-medium text-[var(--text-primary)]",children:[(a=t.percentage)==null?void 0:a.toFixed(1),"%"]})]})]})},Q=({active:s,payload:r,label:t})=>s&&r&&r.length?e.jsxs("div",{className:"px-3 py-2 rounded-lg shadow-xl text-xs",style:{backgroundColor:"var(--bg-tertiary)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"font-medium mb-1",style:{color:"var(--text-primary)"},children:t}),r.map((a,l)=>e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2 h-2 rounded-[2px]",style:{backgroundColor:a.color}}),e.jsx("span",{style:{color:"var(--text-secondary)"},children:a.name})]}),e.jsx("span",{className:"font-mono font-medium",style:{color:a.color},children:m(a.value,n)})]},l)),r.length===2&&e.jsxs("div",{className:"mt-1 pt-1 flex items-center justify-between gap-4",style:{borderTop:"1px solid var(--border-subtle)"},children:[e.jsx("span",{style:{color:"var(--text-secondary)"},children:"Balance"}),e.jsx("span",{className:"font-mono font-medium",style:{color:r[0].value-r[1].value>=0?"var(--accent-green)":"var(--accent-red)"},children:m(r[0].value-r[1].value,n)})]})]}):null,Z=s=>s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(0)}K`:s;return X?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-7 w-40 skeleton rounded"}),e.jsx("div",{className:"h-10 w-48 skeleton rounded-lg"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[1,2,3,4].map(s=>e.jsx("div",{className:"rounded-2xl p-4 h-24 skeleton"},s))}),e.jsx("div",{className:"h-64 skeleton rounded-2xl"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsx("h2",{className:"text-xl font-bold",style:{color:"var(--text-primary)"},children:"Comparador"}),e.jsx(oe,{})]}),e.jsxs("div",{className:"rounded-2xl overflow-hidden",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsxs("button",{onClick:()=>J(!k),className:"w-full p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),e.jsx("span",{className:"text-sm font-medium",style:{color:"var(--text-secondary)"},children:"Filtrar por categorias"}),p.length+j.length>0&&e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium",style:{backgroundColor:"var(--accent-primary)",color:"white"},children:p.length+j.length})]}),e.jsx("svg",{className:`w-4 h-4 transition-transform ${k?"rotate-180":""}`,style:{color:"var(--text-secondary)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),k&&e.jsxs("div",{className:"px-4 pb-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-medium mb-2 flex items-center gap-1.5",style:{color:"var(--accent-red)"},children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})}),"Categorias de gastos"]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-24 overflow-y-auto",children:$.gastos.map((s,r)=>{const t=p.includes(s);return e.jsx("button",{onClick:()=>W(p,I,s),className:"px-3 py-1.5 rounded-full text-xs font-medium transition-colors",style:{backgroundColor:t?"var(--accent-red)":"var(--bg-tertiary)",color:t?"white":"var(--text-secondary)"},children:s&&s.length>20?s.substring(0,20)+"...":s},s||`expense-cat-${r}`)})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-medium mb-2 flex items-center gap-1.5",style:{color:"var(--accent-green)"},children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})}),"Categorias de ingresos"]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-24 overflow-y-auto",children:$.ingresos.map((s,r)=>{const t=j.includes(s);return e.jsx("button",{onClick:()=>W(j,P,s),className:"px-3 py-1.5 rounded-full text-xs font-medium transition-colors",style:{backgroundColor:t?"var(--accent-green)":"var(--bg-tertiary)",color:t?"white":"var(--text-secondary)"},children:s&&s.length>20?s.substring(0,20)+"...":s},s||`income-cat-${r}`)})})]}),p.length+j.length>0&&e.jsx("button",{onClick:()=>{I([]),P([])},className:"text-xs font-medium",style:{color:"var(--accent-primary)"},children:"Limpiar filtros de categorias"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"rounded-2xl p-4 relative overflow-hidden",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, transparent 70%)"}}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:"rgba(34, 197, 94, 0.15)"},children:e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-green)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})})}),e.jsx("p",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-secondary)"},children:"Ingresos"})]}),e.jsx("p",{className:"text-xl font-bold",style:{color:"var(--accent-green)"},children:m(d.totalIngresos,n)})]})]}),e.jsxs("div",{className:"rounded-2xl p-4 relative overflow-hidden",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, transparent 70%)"}}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:"rgba(239, 68, 68, 0.15)"},children:e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})}),e.jsx("p",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-secondary)"},children:"Gastos"})]}),e.jsx("p",{className:"text-xl font-bold",style:{color:"var(--accent-red)"},children:m(d.totalGastos,n)})]})]}),e.jsxs("div",{className:"rounded-2xl p-4 relative overflow-hidden",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("div",{className:"absolute inset-0",style:{background:d.balance>=0?"linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, transparent 70%)":"linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, transparent 70%)"}}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:d.balance>=0?"rgba(34, 197, 94, 0.15)":"rgba(239, 68, 68, 0.15)"},children:d.balance>=0?e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-green)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("p",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-secondary)"},children:"Balance"})]}),e.jsxs("p",{className:"text-xl font-bold",style:{color:d.balance>=0?"var(--accent-green)":"var(--accent-red)"},children:[d.balance>=0?"+":"",m(d.balance,n)]})]})]}),e.jsxs("div",{className:"rounded-2xl p-4 relative overflow-hidden",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(135deg, rgba(20, 184, 166, 0.1) 0%, transparent 70%)"}}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center",style:{backgroundColor:"rgba(20, 184, 166, 0.15)"},children:e.jsx("svg",{className:"w-4 h-4",style:{color:"var(--accent-purple)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),e.jsx("p",{className:"text-xs uppercase tracking-wide",style:{color:"var(--text-secondary)"},children:"Ratio"})]}),e.jsxs("p",{className:"text-lg font-bold",style:{color:"var(--accent-purple)"},children:[d.ratio.toFixed(0),"%"]}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:"de tus ingresos"})]})]})]}),e.jsx(w,{delay:.1,children:e.jsxs(C,{children:[e.jsxs(S,{children:[e.jsxs(M,{className:"flex items-center gap-2",children:["Ingresos vs Gastos",e.jsx(L,{delay:.4,children:e.jsxs(D,{variant:"outline",className:`border-none ${d.balance>=0?"text-green-500 bg-green-500/10":"text-red-500 bg-red-500/10"}`,children:[d.balance>=0?e.jsx(B,{className:"h-3 w-3"}):e.jsx(de,{className:"h-3 w-3"}),e.jsxs("span",{children:[d.balance>=0?"+":"",m(d.balance,n)]})]})})]}),e.jsx(G,{children:"Comparación mensual del período"})]}),e.jsx(R,{children:O.length>0?e.jsxs(e.Fragment,{children:[e.jsx(A,{config:{ingresos:{label:"Ingresos",color:"var(--accent-green)"},gastos:{label:"Gastos",color:"var(--accent-red)"}},className:"h-60 w-full",children:e.jsxs(le,{data:O,margin:{left:-20,right:12,top:12,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"comp-ingresosGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--accent-green)",stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:"var(--accent-green)",stopOpacity:.6})]}),e.jsxs("linearGradient",{id:"comp-gastosGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--accent-red)",stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:"var(--accent-red)",stopOpacity:.6})]}),e.jsxs("filter",{id:"comp-bar-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[e.jsx("feGaussianBlur",{stdDeviation:"2",result:"blur"}),e.jsx("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]})]}),e.jsx(xe,{strokeDasharray:"3 3",stroke:"var(--text-secondary)",strokeOpacity:.2,vertical:!1}),e.jsx(ce,{dataKey:"month",tickLine:!1,axisLine:!1,tickMargin:8,tick:{fill:"var(--text-secondary)",fontSize:11}}),e.jsx(ie,{tickFormatter:Z,tickLine:!1,axisLine:!1,tick:{fill:"var(--text-secondary)",fontSize:11}}),e.jsx(F,{cursor:{fill:"var(--bg-tertiary)",opacity:.3},content:e.jsx(Q,{})}),e.jsx(q,{dataKey:"ingresos",name:"Ingresos",fill:"url(#comp-ingresosGrad)",radius:[6,6,0,0],maxBarSize:32,filter:"url(#comp-bar-glow)"}),e.jsx(q,{dataKey:"gastos",name:"Gastos",fill:"url(#comp-gastosGrad)",radius:[6,6,0,0],maxBarSize:32,filter:"url(#comp-bar-glow)"})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:"var(--accent-green)"}}),e.jsx("span",{className:"text-xs font-medium text-[var(--text-primary)]",children:"Ingresos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:"var(--accent-red)"}}),e.jsx("span",{className:"text-xs font-medium text-[var(--text-primary)]",children:"Gastos"})]})]})]}):e.jsx("div",{className:"h-60 flex items-center justify-center text-[var(--text-secondary)]",children:"No hay datos disponibles"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(w,{delay:.2,children:e.jsxs(C,{children:[e.jsxs(S,{className:"pb-0",children:[e.jsxs(M,{className:"flex items-center gap-2",children:["Gastos por Categoria",h[0]&&e.jsx(L,{delay:.5,children:e.jsxs(D,{variant:"outline",className:"text-red-500 bg-red-500/10 border-none",children:[e.jsx(B,{className:"h-3 w-3"}),e.jsxs("span",{children:[h[0].percentage.toFixed(0),"%"]})]})})]}),e.jsx(G,{children:h[0]?`Mayor gasto: ${h[0].name}`:"Distribución de gastos"})]}),e.jsx(R,{className:"pb-4",children:h.length>0?e.jsxs(e.Fragment,{children:[e.jsx(A,{config:h.reduce((s,r,t)=>(s[r.name]={label:r.name,color:i[t%i.length]},s),{}),className:"mx-auto aspect-square h-[240px]",children:e.jsxs(H,{children:[e.jsx("defs",{children:e.jsxs("filter",{id:"comp-pie-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[e.jsx("feGaussianBlur",{stdDeviation:"4",result:"blur"}),e.jsx("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]})}),e.jsx(F,{cursor:!1,content:e.jsx(T,{})}),e.jsxs(U,{data:h.map((s,r)=>({...s,fill:i[r%i.length]})),dataKey:"value",nameKey:"name",innerRadius:55,outerRadius:95,paddingAngle:3,cornerRadius:5,strokeWidth:2,children:[h.map((s,r)=>e.jsx(Y,{fill:i[r%i.length],stroke:"var(--bg-secondary)",filter:"url(#comp-pie-glow)"},`cell-${r}`)),e.jsx(_,{dataKey:"percentage",position:"inside",stroke:"none",fontSize:12,fontWeight:600,fill:"white",formatter:s=>s>=5?`${s.toFixed(0)}%`:""})]})]})}),e.jsx("div",{className:"flex flex-col gap-0.5",children:h.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-2.5 px-2.5 py-2 rounded-lg text-xs hover:bg-[var(--bg-tertiary)] transition-all duration-200",children:[e.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:i[r%i.length]}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"block truncate text-[var(--text-primary)]",children:s.name}),e.jsx("span",{className:"block text-[10px] text-[var(--text-secondary)] tabular-nums",children:m(s.value,n)})]}),e.jsxs("span",{className:"tabular-nums font-medium flex-shrink-0 text-[var(--text-secondary)]",children:[s.percentage.toFixed(1),"%"]})]},`legend-${r}`))})]}):e.jsx("div",{className:"h-[240px] flex items-center justify-center text-[var(--text-secondary)]",children:"No hay gastos en este periodo"})})]})}),e.jsx(w,{delay:.3,children:e.jsxs(C,{children:[e.jsxs(S,{className:"pb-0",children:[e.jsxs(M,{className:"flex items-center gap-2",children:["Ingresos por Categoria",g[0]&&e.jsx(L,{delay:.6,children:e.jsxs(D,{variant:"outline",className:"text-green-500 bg-green-500/10 border-none",children:[e.jsx(B,{className:"h-3 w-3"}),e.jsxs("span",{children:[g[0].percentage.toFixed(0),"%"]})]})})]}),e.jsx(G,{children:g[0]?`Mayor ingreso: ${g[0].name}`:"Distribución de ingresos"})]}),e.jsx(R,{className:"pb-4",children:g.length>0?e.jsxs(e.Fragment,{children:[e.jsx(A,{config:g.reduce((s,r,t)=>(s[r.name]={label:r.name,color:i[(t+3)%i.length]},s),{}),className:"mx-auto aspect-square h-[240px]",children:e.jsxs(H,{children:[e.jsx(F,{cursor:!1,content:e.jsx(T,{})}),e.jsxs(U,{data:g.map((s,r)=>({...s,fill:i[(r+3)%i.length]})),dataKey:"value",nameKey:"name",innerRadius:55,outerRadius:95,paddingAngle:3,cornerRadius:5,strokeWidth:2,children:[g.map((s,r)=>e.jsx(Y,{fill:i[(r+3)%i.length],stroke:"var(--bg-secondary)",filter:"url(#comp-pie-glow)"},`cell-income-${r}`)),e.jsx(_,{dataKey:"percentage",position:"inside",stroke:"none",fontSize:12,fontWeight:600,fill:"white",formatter:s=>s>=5?`${s.toFixed(0)}%`:""})]})]})}),e.jsx("div",{className:"flex flex-col gap-0.5",children:g.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-2.5 px-2.5 py-2 rounded-lg text-xs hover:bg-[var(--bg-tertiary)] transition-all duration-200",children:[e.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:i[(r+3)%i.length]}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"block truncate text-[var(--text-primary)]",children:s.name}),e.jsx("span",{className:"block text-[10px] text-[var(--text-secondary)] tabular-nums",children:m(s.value,n)})]}),e.jsxs("span",{className:"tabular-nums font-medium flex-shrink-0 text-[var(--text-secondary)]",children:[s.percentage.toFixed(1),"%"]})]},`income-legend-${r}`))})]}):e.jsx("div",{className:"h-[240px] flex items-center justify-center text-[var(--text-secondary)]",children:"No hay ingresos en este periodo"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-2xl p-4",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[e.jsx("div",{className:"w-6 h-6 rounded-lg flex items-center justify-center",style:{backgroundColor:"rgba(239, 68, 68, 0.15)"},children:e.jsx("svg",{className:"w-3 h-3",style:{color:"var(--accent-red)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})}),"Gastos",e.jsxs("span",{className:"text-sm font-normal",style:{color:"var(--text-secondary)"},children:["(",y.length,")"]})]})}),e.jsx("div",{className:"max-h-72 overflow-y-auto space-y-2 pr-1",children:y.length===0?e.jsx("p",{className:"text-center py-8 text-sm",style:{color:"var(--text-secondary)"},children:"Sin gastos en este periodo"}):y.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl transition-colors hover:bg-[var(--bg-tertiary)]",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",style:{color:"var(--text-primary)"},children:s.categoria||"Sin categoria"}),e.jsx("p",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},children:s.cuenta}),s.nota&&e.jsxs("p",{className:"text-xs truncate italic mt-0.5",style:{color:"var(--text-secondary)",opacity:.7},children:['"',s.nota,'"']})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("p",{className:"font-bold",style:{color:"var(--accent-red)"},children:["-",m(n==="ARS"?s.montoPesos||s.monto:s.montoDolares||0,n)]}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:V(s.fecha,"short")})]})]},s.rowIndex||r))}),y.length>0&&e.jsxs("div",{className:"mt-4 pt-4 flex items-center justify-between",style:{borderTop:"1px solid var(--border-subtle)"},children:[e.jsx("span",{className:"font-medium",style:{color:"var(--text-secondary)"},children:"Total"}),e.jsx("span",{className:"text-xl font-bold",style:{color:"var(--accent-red)"},children:m(y.reduce((s,r)=>s+(n==="ARS"?r.montoPesos||r.monto||0:r.montoDolares||0),0),n)})]})]}),e.jsxs("div",{className:"rounded-2xl p-4",style:{backgroundColor:"var(--bg-secondary)"},children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("h3",{className:"font-semibold flex items-center gap-2",style:{color:"var(--text-primary)"},children:[e.jsx("div",{className:"w-6 h-6 rounded-lg flex items-center justify-center",style:{backgroundColor:"rgba(34, 197, 94, 0.15)"},children:e.jsx("svg",{className:"w-3 h-3",style:{color:"var(--accent-green)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})})}),"Ingresos",e.jsxs("span",{className:"text-sm font-normal",style:{color:"var(--text-secondary)"},children:["(",b.length,")"]})]})}),e.jsx("div",{className:"max-h-72 overflow-y-auto space-y-2 pr-1",children:b.length===0?e.jsx("p",{className:"text-center py-8 text-sm",style:{color:"var(--text-secondary)"},children:"Sin ingresos en este periodo"}):b.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl transition-colors hover:bg-[var(--bg-tertiary)]",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-sm truncate",style:{color:"var(--text-primary)"},children:s.categoria||"Sin categoria"}),e.jsx("p",{className:"text-xs truncate",style:{color:"var(--text-secondary)"},children:s.cuenta}),s.nota&&e.jsxs("p",{className:"text-xs truncate italic mt-0.5",style:{color:"var(--text-secondary)",opacity:.7},children:['"',s.nota,'"']})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("p",{className:"font-bold",style:{color:"var(--accent-green)"},children:["+",m(n==="ARS"?s.montoPesos||s.monto:s.montoDolares||0,n)]}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:V(s.fecha,"short")})]})]},s.rowIndex||r))}),b.length>0&&e.jsxs("div",{className:"mt-4 pt-4 flex items-center justify-between",style:{borderTop:"1px solid var(--border-subtle)"},children:[e.jsx("span",{className:"font-medium",style:{color:"var(--text-secondary)"},children:"Total"}),e.jsx("span",{className:"text-xl font-bold",style:{color:"var(--accent-green)"},children:m(b.reduce((s,r)=>s+(n==="ARS"?r.montoPesos||r.monto||0:r.montoDolares||0),0),n)})]})]})]})]})}export{je as default};
